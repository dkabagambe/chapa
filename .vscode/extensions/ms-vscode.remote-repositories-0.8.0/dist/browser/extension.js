var Yw=Object.defineProperty;var u=(hc,Ma)=>Yw(hc,"name",{value:Ma,configurable:!0});(()=>{var hc={179:(Ce,J,f)=>{Ce=f.nmd(Ce);var cn=200,yn="__lodash_hash_undefined__",Xt=1,Bt=2,Jt=9007199254740991,Cn="[object Arguments]",rt="[object Array]",mt="[object AsyncFunction]",On="[object Boolean]",Fe="[object Date]",xe="[object Error]",N="[object Function]",dt="[object GeneratorFunction]",yt="[object Map]",tt="[object Number]",Na="[object Null]",xt="[object Object]",Dr="[object Promise]",Ti="[object Proxy]",Tr="[object RegExp]",Ar="[object Set]",ce="[object String]",$t="[object Symbol]",ye="[object Undefined]",Ai="[object WeakMap]",No="[object ArrayBuffer]",nr="[object DataView]",bn="[object Float32Array]",La="[object Float64Array]",D="[object Int8Array]",Ke="[object Int16Array]",Me="[object Int32Array]",ei="[object Uint8Array]",rr="[object Uint8ClampedArray]",Re="[object Uint16Array]",Ua="[object Uint32Array]",Oa=/[\\^$.*+?()[\]{}|]/g,Qe=/^\[object .+?Constructor\]$/,nt=/^(?:0|[1-9]\d*)$/,We={};We[bn]=We[La]=We[D]=We[Ke]=We[Me]=We[ei]=We[rr]=We[Re]=We[Ua]=!0,We[Cn]=We[rt]=We[No]=We[On]=We[nr]=We[Fe]=We[xe]=We[N]=We[yt]=We[tt]=We[xt]=We[Tr]=We[Ar]=We[ce]=We[Ai]=!1;var Pr=typeof f.g=="object"&&f.g&&f.g.Object===Object&&f.g,pe=typeof self=="object"&&self&&self.Object===Object&&self,ve=Pr||pe||Function("return this")(),Pi=J&&!J.nodeType&&J,Fr=Pi&&!0&&Ce&&!Ce.nodeType&&Ce,gc=Fr&&Fr.exports===Pi,Lo=gc&&Pr.process,Ha=function(){try{return Lo&&Lo.binding&&Lo.binding("util")}catch(b){}}(),Fi=Ha&&Ha.isTypedArray;function Wa(b,I){for(var k=-1,Y=b==null?0:b.length,Le=0,le=[];++k<Y;){var re=b[k];I(re,k,b)&&(le[Le++]=re)}return le}u(Wa,"arrayFilter");function Uo(b,I){for(var k=-1,Y=I.length,Le=b.length;++k<Y;)b[Le+k]=I[k];return b}u(Uo,"arrayPush");function de(b,I){for(var k=-1,Y=b==null?0:b.length;++k<Y;)if(I(b[k],k,b))return!0;return!1}u(de,"arraySome");function Pt(b,I){for(var k=-1,Y=Array(b);++k<b;)Y[k]=I(k);return Y}u(Pt,"baseTimes");function it(b){return function(I){return b(I)}}u(it,"baseUnary");function Ba(b,I){return b.has(I)}u(Ba,"cacheHas");function Mi(b,I){return b==null?void 0:b[I]}u(Mi,"getValue");function ir(b){var I=-1,k=Array(b.size);return b.forEach(function(Y,Le){k[++I]=[Le,Y]}),k}u(ir,"mapToArray");function U(b,I){return function(k){return b(I(k))}}u(U,"overArg");function pc(b){var I=-1,k=Array(b.size);return b.forEach(function(Y){k[++I]=Y}),k}u(pc,"setToArray");var vc=Array.prototype,ti=Function.prototype,ni=Object.prototype,ri=ve["__core-js_shared__"],Oo=ti.toString,Yt=ni.hasOwnProperty,Ho=function(){var b=/[^.]+$/.exec(ri&&ri.keys&&ri.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),mc=ni.toString,wc=RegExp("^"+Oo.call(Yt).replace(Oa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yc=gc?ve.Buffer:void 0,Ni=ve.Symbol,Sn=ve.Uint8Array,Li=ni.propertyIsEnumerable,Cc=vc.splice,or=Ni?Ni.toStringTag:void 0,ar=Object.getOwnPropertySymbols,$a=yc?yc.isBuffer:void 0,Mr=U(Object.keys,Object),Hn=un(ve,"DataView"),_n=un(ve,"Map"),ii=un(ve,"Promise"),Ui=un(ve,"Set"),Wo=un(ve,"WeakMap"),oi=un(Object,"create"),Va=En(Hn),Vt=En(_n),bc=En(ii),L=En(Ui),Sc=En(Wo),Oi=Ni?Ni.prototype:void 0,Hi=Oi?Oi.valueOf:void 0;function sr(b){var I=-1,k=b==null?0:b.length;for(this.clear();++I<k;){var Y=b[I];this.set(Y[0],Y[1])}}u(sr,"Hash");function Nr(){this.__data__=oi?oi(null):{},this.size=0}u(Nr,"hashClear");function ln(b){var I=this.has(b)&&delete this.__data__[b];return this.size-=I?1:0,I}u(ln,"hashDelete");function xn(b){var I=this.__data__;if(oi){var k=I[b];return k===yn?void 0:k}return Yt.call(I,b)?I[b]:void 0}u(xn,"hashGet");function Ft(b){var I=this.__data__;return oi?I[b]!==void 0:Yt.call(I,b)}u(Ft,"hashHas");function Wi(b,I){var k=this.__data__;return this.size+=this.has(b)?0:1,k[b]=oi&&I===void 0?yn:I,this}u(Wi,"hashSet"),sr.prototype.clear=Nr,sr.prototype.delete=ln,sr.prototype.get=xn,sr.prototype.has=Ft,sr.prototype.set=Wi;function ht(b){var I=-1,k=b==null?0:b.length;for(this.clear();++I<k;){var Y=b[I];this.set(Y[0],Y[1])}}u(ht,"ListCache");function Bi(){this.__data__=[],this.size=0}u(Bi,"listCacheClear");function $i(b){var I=this.__data__,k=Ur(I,b);if(k<0)return!1;var Y=I.length-1;return k==Y?I.pop():Cc.call(I,k,1),--this.size,!0}u($i,"listCacheDelete");function qa(b){var I=this.__data__,k=Ur(I,b);return k<0?void 0:I[k][1]}u(qa,"listCacheGet");function za(b){return Ur(this.__data__,b)>-1}u(za,"listCacheHas");function ai(b,I){var k=this.__data__,Y=Ur(k,b);return Y<0?(++this.size,k.push([b,I])):k[Y][1]=I,this}u(ai,"listCacheSet"),ht.prototype.clear=Bi,ht.prototype.delete=$i,ht.prototype.get=qa,ht.prototype.has=za,ht.prototype.set=ai;function In(b){var I=-1,k=b==null?0:b.length;for(this.clear();++I<k;){var Y=b[I];this.set(Y[0],Y[1])}}u(In,"MapCache");function Lr(){this.size=0,this.__data__={hash:new sr,map:new(_n||ht),string:new sr}}u(Lr,"mapCacheClear");function Bo(b){var I=Or(this,b).delete(b);return this.size-=I?1:0,I}u(Bo,"mapCacheDelete");function Vi(b){return Or(this,b).get(b)}u(Vi,"mapCacheGet");function ja(b){return Or(this,b).has(b)}u(ja,"mapCacheHas");function Te(b,I){var k=Or(this,b),Y=k.size;return k.set(b,I),this.size+=k.size==Y?0:1,this}u(Te,"mapCacheSet"),In.prototype.clear=Lr,In.prototype.delete=Bo,In.prototype.get=Vi,In.prototype.has=ja,In.prototype.set=Te;function qi(b){var I=-1,k=b==null?0:b.length;for(this.__data__=new In;++I<k;)this.add(b[I])}u(qi,"SetCache");function _c(b){return this.__data__.set(b,yn),this}u(_c,"setCacheAdd");function Ga(b){return this.__data__.has(b)}u(Ga,"setCacheHas"),qi.prototype.add=qi.prototype.push=_c,qi.prototype.has=Ga;function Mt(b){var I=this.__data__=new ht(b);this.size=I.size}u(Mt,"Stack");function zi(){this.__data__=new ht,this.size=0}u(zi,"stackClear");function xc(b){var I=this.__data__,k=I.delete(b);return this.size=I.size,k}u(xc,"stackDelete");function Ic(b){return this.__data__.get(b)}u(Ic,"stackGet");function Ne(b){return this.__data__.has(b)}u(Ne,"stackHas");function Wn(b,I){var k=this.__data__;if(k instanceof ht){var Y=k.__data__;if(!_n||Y.length<cn-1)return Y.push([b,I]),this.size=++k.size,this;k=this.__data__=new In(Y)}return k.set(b,I),this.size=k.size,this}u(Wn,"stackSet"),Mt.prototype.clear=zi,Mt.prototype.delete=xc,Mt.prototype.get=Ic,Mt.prototype.has=Ne,Mt.prototype.set=Wn;function Ka(b,I){var k=ur(b),Y=!k&&Ja(b),Le=!k&&!Y&&dr(b),le=!k&&!Y&&!Le&&q(b),re=k||Y||Le||le,Ge=re?Pt(b.length,String):[],ot=Ge.length;for(var Ve in b)(I||Yt.call(b,Ve))&&!(re&&(Ve=="length"||Le&&(Ve=="offset"||Ve=="parent")||le&&(Ve=="buffer"||Ve=="byteLength"||Ve=="byteOffset")||Ki(Ve,ot)))&&Ge.push(Ve);return Ge}u(Ka,"arrayLikeKeys");function Ur(b,I){for(var k=b.length;k--;)if(Xi(b[k][0],I))return k;return-1}u(Ur,"assocIndexOf");function cr(b,I,k){var Y=I(b);return ur(b)?Y:Uo(Y,k(b))}u(cr,"baseGetAllKeys");function Bn(b){return b==null?b===void 0?ye:Na:or&&or in Object(b)?dn(b):Hr(b)}u(Bn,"baseGetTag");function ji(b){return je(b)&&Bn(b)==Cn}u(ji,"baseIsArguments");function si(b,I,k,Y,Le){return b===I?!0:b==null||I==null||!je(b)&&!je(I)?b!==b&&I!==I:Ec(b,I,k,Y,si,Le)}u(si,"baseIsEqual");function Ec(b,I,k,Y,Le,le){var re=ur(b),Ge=ur(I),ot=re?rt:qt(b),Ve=Ge?rt:qt(I);ot=ot==Cn?xt:ot,Ve=Ve==Cn?xt:Ve;var Ee=ot==xt,Zt=Ve==xt,ke=ot==Ve;if(ke&&dr(b)){if(!dr(I))return!1;re=!0,Ee=!1}if(ke&&!Ee)return le||(le=new Mt),re||q(b)?Qa(b,I,k,Y,Le,le):Dc(b,I,ot,k,Y,Le,le);if(!(k&Xt)){var It=Ee&&Yt.call(b,"__wrapped__"),Ye=Zt&&Yt.call(I,"__wrapped__");if(It||Ye){var en=It?b.value():b,ae=Ye?I.value():I;return le||(le=new Mt),Le(en,ae,k,Y,le)}}return ke?(le||(le=new Mt),Tc(b,I,k,Y,Le,le)):!1}u(Ec,"baseIsEqualDeep");function $o(b){if(!Xe(b)||Xa(b))return!1;var I=Ji(b)?wc:Qe;return I.test(En(b))}u($o,"baseIsNative");function kc(b){return je(b)&&qo(b.length)&&!!We[Bn(b)]}u(kc,"baseIsTypedArray");function Rc(b){if(!Qi(b))return Mr(b);var I=[];for(var k in Object(b))Yt.call(b,k)&&k!="constructor"&&I.push(k);return I}u(Rc,"baseKeys");function Qa(b,I,k,Y,Le,le){var re=k&Xt,Ge=b.length,ot=I.length;if(Ge!=ot&&!(re&&ot>Ge))return!1;var Ve=le.get(b);if(Ve&&le.get(I))return Ve==I;var Ee=-1,Zt=!0,ke=k&Bt?new qi:void 0;for(le.set(b,I),le.set(I,b);++Ee<Ge;){var It=b[Ee],Ye=I[Ee];if(Y)var en=re?Y(Ye,It,Ee,I,b,le):Y(It,Ye,Ee,b,I,le);if(en!==void 0){if(en)continue;Zt=!1;break}if(ke){if(!de(I,function(ae,kn){if(!Ba(ke,kn)&&(It===ae||Le(It,ae,k,Y,le)))return ke.push(kn)})){Zt=!1;break}}else if(!(It===Ye||Le(It,Ye,k,Y,le))){Zt=!1;break}}return le.delete(b),le.delete(I),Zt}u(Qa,"equalArrays");function Dc(b,I,k,Y,Le,le,re){switch(k){case nr:if(b.byteLength!=I.byteLength||b.byteOffset!=I.byteOffset)return!1;b=b.buffer,I=I.buffer;case No:return!(b.byteLength!=I.byteLength||!le(new Sn(b),new Sn(I)));case On:case Fe:case tt:return Xi(+b,+I);case xe:return b.name==I.name&&b.message==I.message;case Tr:case ce:return b==I+"";case yt:var Ge=ir;case Ar:var ot=Y&Xt;if(Ge||(Ge=pc),b.size!=I.size&&!ot)return!1;var Ve=re.get(b);if(Ve)return Ve==I;Y|=Bt,re.set(b,I);var Ee=Qa(Ge(b),Ge(I),Y,Le,le,re);return re.delete(b),Ee;case $t:if(Hi)return Hi.call(b)==Hi.call(I)}return!1}u(Dc,"equalByTag");function Tc(b,I,k,Y,Le,le){var re=k&Xt,Ge=Gi(b),ot=Ge.length,Ve=Gi(I),Ee=Ve.length;if(ot!=Ee&&!re)return!1;for(var Zt=ot;Zt--;){var ke=Ge[Zt];if(!(re?ke in I:Yt.call(I,ke)))return!1}var It=le.get(b);if(It&&le.get(I))return It==I;var Ye=!0;le.set(b,I),le.set(I,b);for(var en=re;++Zt<ot;){ke=Ge[Zt];var ae=b[ke],kn=I[ke];if(Y)var Zi=re?Y(kn,ae,ke,I,b,le):Y(ae,kn,ke,b,I,le);if(!(Zi===void 0?ae===kn||Le(ae,kn,k,Y,le):Zi)){Ye=!1;break}en||(en=ke=="constructor")}if(Ye&&!en){var tn=b.constructor,ge=I.constructor;tn!=ge&&"constructor"in b&&"constructor"in I&&!(typeof tn=="function"&&tn instanceof tn&&typeof ge=="function"&&ge instanceof ge)&&(Ye=!1)}return le.delete(b),le.delete(I),Ye}u(Tc,"equalObjects");function Gi(b){return cr(b,B,ci)}u(Gi,"getAllKeys");function Or(b,I){var k=b.__data__;return lr(I)?k[typeof I=="string"?"string":"hash"]:k.map}u(Or,"getMapData");function un(b,I){var k=Mi(b,I);return $o(k)?k:void 0}u(un,"getNative");function dn(b){var I=Yt.call(b,or),k=b[or];try{b[or]=void 0;var Y=!0}catch(le){}var Le=mc.call(b);return Y&&(I?b[or]=k:delete b[or]),Le}u(dn,"getRawTag");var ci=ar?function(b){return b==null?[]:(b=Object(b),Wa(ar(b),function(I){return Li.call(b,I)}))}:Yi,qt=Bn;(Hn&&qt(new Hn(new ArrayBuffer(1)))!=nr||_n&&qt(new _n)!=yt||ii&&qt(ii.resolve())!=Dr||Ui&&qt(new Ui)!=Ar||Wo&&qt(new Wo)!=Ai)&&(qt=u(function(b){var I=Bn(b),k=I==xt?b.constructor:void 0,Y=k?En(k):"";if(Y)switch(Y){case Va:return nr;case Vt:return yt;case bc:return Dr;case L:return Ar;case Sc:return Ai}return I},"getTag"));function Ki(b,I){return I=I==null?Jt:I,!!I&&(typeof b=="number"||nt.test(b))&&b>-1&&b%1==0&&b<I}u(Ki,"isIndex");function lr(b){var I=typeof b;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?b!=="__proto__":b===null}u(lr,"isKeyable");function Xa(b){return!!Ho&&Ho in b}u(Xa,"isMasked");function Qi(b){var I=b&&b.constructor,k=typeof I=="function"&&I.prototype||ni;return b===k}u(Qi,"isPrototype");function Hr(b){return mc.call(b)}u(Hr,"objectToString");function En(b){if(b!=null){try{return Oo.call(b)}catch(I){}try{return b+""}catch(I){}}return""}u(En,"toSource");function Xi(b,I){return b===I||b!==b&&I!==I}u(Xi,"eq");var Ja=ji(function(){return arguments}())?ji:function(b){return je(b)&&Yt.call(b,"callee")&&!Li.call(b,"callee")},ur=Array.isArray;function Vo(b){return b!=null&&qo(b.length)&&!Ji(b)}u(Vo,"isArrayLike");var dr=$a||zo;function Wr(b,I){return si(b,I)}u(Wr,"isEqual");function Ji(b){if(!Xe(b))return!1;var I=Bn(b);return I==N||I==dt||I==mt||I==Ti}u(Ji,"isFunction");function qo(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=Jt}u(qo,"isLength");function Xe(b){var I=typeof b;return b!=null&&(I=="object"||I=="function")}u(Xe,"isObject");function je(b){return b!=null&&typeof b=="object"}u(je,"isObjectLike");var q=Fi?it(Fi):kc;function B(b){return Vo(b)?Ka(b):Rc(b)}u(B,"keys");function Yi(){return[]}u(Yi,"stubArray");function zo(){return!1}u(zo,"stubFalse"),Ce.exports=Wr},724:()=>{},189:function(Ce,J,f){"use strict";var cn=this&&this.__spreadArray||function(rt,mt,On){if(On||arguments.length===2)for(var Fe=0,xe=mt.length,N;Fe<xe;Fe++)(N||!(Fe in mt))&&(N||(N=Array.prototype.slice.call(mt,0,Fe)),N[Fe]=mt[Fe]);return rt.concat(N||Array.prototype.slice.call(mt))};Object.defineProperty(J,"__esModule",{value:!0}),J.config=J.loadMessageBundle=J.BundleFormat=J.MessageFormat=void 0;var yn=f(926),Xt=f(800),Bt=f(800);Object.defineProperty(J,"MessageFormat",{enumerable:!0,get:function(){return Bt.MessageFormat}}),Object.defineProperty(J,"BundleFormat",{enumerable:!0,get:function(){return Bt.BundleFormat}});function Jt(rt){return function(mt,On){for(var Fe=[],xe=2;xe<arguments.length;xe++)Fe[xe-2]=arguments[xe];if(typeof mt=="number")throw new Error("Browser implementation does currently not support externalized strings.");return Xt.localize.apply(void 0,cn([mt,On],Fe,!1))}}u(Jt,"loadMessageBundle"),J.loadMessageBundle=Jt;function Cn(rt){var mt;return(0,Xt.setPseudo)(((mt=rt==null?void 0:rt.locale)===null||mt===void 0?void 0:mt.toLowerCase())==="pseudo"),Jt}u(Cn,"config"),J.config=Cn,yn.default.install(Object.freeze({loadMessageBundle:Jt,config:Cn}))},800:(Ce,J,f)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0}),J.config=J.loadMessageBundle=J.localize=J.format=J.setPseudo=J.isPseudo=J.isDefined=J.BundleFormat=J.MessageFormat=void 0;var cn=f(926),yn;(function(xe){xe.file="file",xe.bundle="bundle",xe.both="both"})(yn=J.MessageFormat||(J.MessageFormat={}));var Xt;(function(xe){xe.standalone="standalone",xe.languagePack="languagePack"})(Xt=J.BundleFormat||(J.BundleFormat={}));var Bt;(function(xe){function N(dt){var yt=dt;return yt&&Jt(yt.key)&&Jt(yt.comment)}u(N,"is"),xe.is=N})(Bt||(Bt={}));function Jt(xe){return typeof xe!="undefined"}u(Jt,"isDefined"),J.isDefined=Jt,J.isPseudo=!1;function Cn(xe){J.isPseudo=xe}u(Cn,"setPseudo"),J.setPseudo=Cn;function rt(xe,N){var dt;return J.isPseudo&&(xe="\uFF3B"+xe.replace(/[aouei]/g,"$&$&")+"\uFF3D"),N.length===0?dt=xe:dt=xe.replace(/\{(\d+)\}/g,function(yt,tt){var Na=tt[0],xt=N[Na],Dr=yt;return typeof xt=="string"?Dr=xt:(typeof xt=="number"||typeof xt=="boolean"||xt===void 0||xt===null)&&(Dr=String(xt)),Dr}),dt}u(rt,"format"),J.format=rt;function mt(xe,N){for(var dt=[],yt=2;yt<arguments.length;yt++)dt[yt-2]=arguments[yt];return rt(N,dt)}u(mt,"localize"),J.localize=mt;function On(xe){return(0,cn.default)().loadMessageBundle(xe)}u(On,"loadMessageBundle"),J.loadMessageBundle=On;function Fe(xe){return(0,cn.default)().config(xe)}u(Fe,"config"),J.config=Fe},926:(Ce,J)=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});var f;function cn(){if(f===void 0)throw new Error("No runtime abstraction layer installed");return f}u(cn,"RAL"),function(yn){function Xt(Bt){if(Bt===void 0)throw new Error("No runtime abstraction layer provided");f=Bt}u(Xt,"install"),yn.install=Xt}(cn||(cn={})),J.default=cn}},Ma={};function et(Ce){var J=Ma[Ce];if(J!==void 0)return J.exports;var f=Ma[Ce]={id:Ce,loaded:!1,exports:{}};return hc[Ce].call(f.exports,f,f.exports,et),f.loaded=!0,f.exports}u(et,"__webpack_require__"),(()=>{et.n=Ce=>{var J=Ce&&Ce.__esModule?()=>Ce.default:()=>Ce;return et.d(J,{a:J}),J}})(),(()=>{et.d=(Ce,J)=>{for(var f in J)et.o(J,f)&&!et.o(Ce,f)&&Object.defineProperty(Ce,f,{enumerable:!0,get:J[f]})}})(),(()=>{et.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(Ce){if(typeof window=="object")return window}}()})(),(()=>{et.o=(Ce,J)=>Object.prototype.hasOwnProperty.call(Ce,J)})(),(()=>{et.r=Ce=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(Ce,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Ce,"__esModule",{value:!0})}})(),(()=>{et.nmd=Ce=>(Ce.paths=[],Ce.children||(Ce.children=[]),Ce)})();var fc={};(()=>{"use strict";et.r(fc),et.d(fc,{StateKeys:()=>Di,activate:()=>Gw,ensureProvidersRegistered:()=>Qt,getOpenActionsService:()=>lc,getState:()=>vp,isPreRelease:()=>jw,updateState:()=>Gu});var Ce={};et.r(Ce),et.d(Ce,{max:()=>bw,min:()=>Cw});var J=et(189);J.config({messageFormat:J.MessageFormat.bundle,bundleFormat:J.BundleFormat.standalone});const f=require("vscode"),cn=new TextDecoder,yn=new TextEncoder,Xt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function Bt(t){const e=yn.encode(t),n=new Array(e.length);for(let r=0;r<e.length;++r)n[r]=Xt[e[r]];return n.join("")}u(Bt,"encodeUtf8Hex");function Jt(t){const e=t.match(/(\w{2})/g);if(e===null)return"";const n=new Uint8Array(e.map(r=>parseInt(r,16)));return cn.decode(n)}u(Jt,"decodeUtf8Hex");const Cn=/^[0-9a-f]{40}$/i;function rt(t){return t!==void 0&&Cn.test(t)}u(rt,"isSha");const mt=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function On(t){return mt.test(t)}u(On,"isValidBranchName");function Fe(t){return t===""||t==="~"||t==="HEAD"?t:t.endsWith("^")?`${t.substr(0,7)}^`:t.substr(0,7)}u(Fe,"shortenRef");const xe=47;function N(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,fragment:""}).toString()}u(N,"asKey");function dt(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.query&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,query:"",fragment:""}).toString()}u(dt,"asFileKey");function yt(t,e){return`${(e==null?void 0:e.excludeScheme)?"":`${t.scheme}-`}${t.authority}${t.path.endsWith("/")?t.path.slice(0,-1):t.path}`}u(yt,"asFileStorageKey");function tt(t){const e=t.path;let n=0,r=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===xe){if(!i){n=o+1;break}}else r===-1&&(i=!1,r=o+1);return r===-1?"":e.slice(n,r)}u(tt,"basename");function Na(t){const e=t.path;if(e.length===1)return"/";let n,r=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(n=e.charCodeAt(o),n===xe){if(!i){r=o;break}}else i=!1;return r===-1?"/":e.slice(0,r)}u(Na,"dirname");function xt(t){const e=t.path.lastIndexOf("/");return e===-1?t.with({path:"/"}):t.with({path:t.path.substring(0,e)})}u(xt,"getParent");function Dr(t,e){const n=typeof e=="string"?e:e.path;return n.startsWith(t.path)?f.Uri.joinPath(t,n.substr(t.path.length)):f.Uri.joinPath(t,n)}u(Dr,"joinRelativePath");function Ti(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),Tr(t,e)&&t.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):Tr(t,e)&&t.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}u(Ti,"isChild");function Tr(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||t.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===t.scheme&&e.authority===t.authority&&(e.path.length===1||t.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}u(Tr,"isDescendent");function Ar(t){return t&&typeof t=="object"&&"scheme"in t}u(Ar,"isSerializedUri");var ce;(function(t){t.authoritySeparator="+",t.scheme="vscode-vfs",t.baseVirtualWorkspaceUri=f.Uri.parse(`${t.scheme}://`);function e(l){const{authority:d}=l,h=d.indexOf(t.authoritySeparator);return h!==-1?d.substr(0,h):d}u(e,"getProviderId"),t.getProviderId=e;function n(l){return l.scheme!==t.scheme?l:l.with({scheme:e(l)})}u(n,"getProviderUri"),t.getProviderUri=n;function r(l,d){const h=new Map,g=f.workspace.textDocuments;if(g.length===0)return h;for(const p of g)p.uri.scheme===l&&d.some(y=>Tr(p.uri,y))&&h.set(N(p.uri),p.uri);return h}u(r,"getOpenUris"),t.getOpenUris=r;function i(l){return l.scheme===t.scheme?l:l.with({scheme:t.scheme})}u(i,"getVirtualUri"),t.getVirtualUri=i;function o(l,d){const[h,g]=l.authority.split(t.authoritySeparator);let p;if(g)try{const y=JSON.parse(Jt(g));p=d?d(y):y}catch{}return{scheme:h,metadata:p}}u(o,"decodeAuthority"),t.decodeAuthority=o;function a(l,d){const h=d?`${t.authoritySeparator}${Bt(JSON.stringify(d))}`:"";return`${l}${h}`}u(a,"encodeAuthority"),t.encodeAuthority=a;function s(l){return l.authority.indexOf(t.authoritySeparator)===-1}u(s,"isCanonicalUri"),t.isCanonicalUri=s;function c(){var l,d;return(d=(l=f.workspace.workspaceFolders)==null?void 0:l.every(h=>h.uri.scheme===t.scheme))!=null?d:!1}u(c,"isVirtualWorkspace"),t.isVirtualWorkspace=c})(ce||(ce={}));var $t;(function(t){t[t.Admin=100]="Admin",t[t.Maintain=40]="Maintain",t[t.WriteToPullRequest=31]="WriteToPullRequest",t[t.Write=30]="Write",t[t.Triage=20]="Triage",t[t.Read=10]="Read",t[t.None=0]="None"})($t||($t={}));var ye;(function(t){t[t.Branch=0]="Branch",t[t.RemoteBranch=1]="RemoteBranch",t[t.Tag=2]="Tag",t[t.Commit=3]="Commit"})(ye||(ye={}));var Ai;(function(t){function e(n){return n!==void 0&&n.type===bn.Active}u(e,"isActive"),t.isActive=e})(Ai||(Ai={}));var No;(function(t){function e(n){const r=ce.decodeAuthority(n).metadata;if(!(r===void 0||r.idx===void 0)){if(r.idx==="latest")return{type:nr.Latest};if(rt(r.idx))return{type:nr.SHA,sha:r.idx}}}u(e,"decode"),t.decode=e})(No||(No={}));var nr;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(nr||(nr={}));var bn;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(bn||(bn={})),function(t){function e(n){return n!==void 0&&(n===t.Indexed||n===t.Match||n===t.Active)}u(e,"hasIndex"),t.hasIndex=e}(bn||(bn={}));var La;(function(t){t[t.Open=0]="Open",t[t.Closed=1]="Closed",t[t.Merged=2]="Merged"})(La||(La={}));var D;(function(t){t[t.Changed=1]="Changed",t[t.Created=2]="Created",t[t.Deleted=3]="Deleted"})(D||(D={}));var Ke;(function(t){t.CurrentWindow="currentWindow",t.NewWindow="newWindow",t.AddToWorkspace="addToWorkspace"})(Ke||(Ke={}));var Me;(function(t){t[t.Branch=0]="Branch",t[t.Tag=1]="Tag",t[t.Commit=2]="Commit",t[t.PullRequest=3]="PullRequest",t[t.Tree=4]="Tree"})(Me||(Me={}));var ei;(function(t){t[t.Abort=0]="Abort",t[t.KeepCurrent=1]="KeepCurrent",t[t.DiscardCurrent=2]="DiscardCurrent",t[t.Merge=3]="Merge"})(ei||(ei={}));var rr;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.File=4]="File",t[t.Tag=5]="Tag"})(rr||(rr={}));var Re;(function(t){t.Branch="branch",t.RemoteBranch="remoteBranch",t.PullRequestBranch="pullRequestBranch",t.PullRequestRemoteBranch="pullRequestRemoteBranch",t.Tag="tag",t.Commit="commit"})(Re||(Re={}));var Ua;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(Ua||(Ua={}));var Oa;(function(t){t.Browse="browse",t.Edit="edit"})(Oa||(Oa={}));var Qe;(function(t){t.CommitFailedError="CommitFailedError",t.DetachedHEADError="DetachedHEADError",t.InvalidBranchNameError="InvalidBranchNameError",t.InvalidCredentialsError="InvalidCredentialsError",t.MergeConflictError="MergeConflictError",t.NothingToCommitError="NothingToCommitError",t.SyncConflictsError="SyncConflictsError",t.SyncOrFetchError="SyncOrFetchError",t.UnresolvedConflictsError="UnresolvedConflictsError",t.Unknown="Unknown"})(Qe||(Qe={}));class nt extends Error{constructor(e,n,r){super(typeof e=="string"?e:e.message);this.messageOrError=e,this.errorCode=n,this.action=r}static CommitFailedError(){return new nt("Failed to create and push commit",Qe.CommitFailedError)}static DetachedHEADError(e){return new nt(e,Qe.DetachedHEADError)}static InvalidBranchNameError(e,n=!1){const r=n?`Branch '${e}' already exists`:`Invalid branch name '${e}'`;return new nt(r,Qe.InvalidBranchNameError)}static InvalidCredentialsError(e,n){return new nt(e,Qe.InvalidCredentialsError,n)}static MergeConflictError(e){return new nt(e,Qe.MergeConflictError)}static NothingToCommitError(e){return new nt(e,Qe.NothingToCommitError)}static SyncOrFetchError(e=!1){const n=e?"Unable to sync the repository":"Unable to fetch the repository";return new nt(n,Qe.SyncOrFetchError)}static SyncConflictsError(){const e="Sync operation will result in conflicts";return new nt(e,Qe.SyncConflictsError)}static UnresolvedConflictsError(){return new nt("You have unresolved merge conflicts.",Qe.UnresolvedConflictsError)}static asVirtualProviderErrorCode(e){return e instanceof Error&&"messageOrError"in e&&"errorCode"in e?e.errorCode:Qe.Unknown}}u(nt,"VirtualProviderError");const We=6;var Pr;(function(t){t.Off="off",t.Auto="auto",t.Always="always"})(Pr||(Pr={}));var pe;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(pe||(pe={})),function(t){function e(n){return n===t.None||n===t.Latest||n===t.Match||n===t.TipPlusLatest?n:t.None}u(e,"sanitize"),t.sanitize=e}(pe||(pe={}));var ve;(function(t){t.Browse="browse",t.Edit="edit"})(ve||(ve={})),function(t){function e(r){return r===t.Browse||r===t.Edit?r:t.Edit}u(e,"sanitize"),t.sanitize=e;function n(r){return r===t.Browse?t.Edit:t.Browse}u(n,"toggle"),t.toggle=n}(ve||(ve={}));var Pi;(function(t){function e(n,r){return n.display===r.display&&n.index===r.index}u(e,"equals"),t.equals=e})(Pi||(Pi={}));var Fr;(function(t){const e=new Map([[Re.Branch,pe.None],[Re.RemoteBranch,pe.None],[Re.PullRequestBranch,pe.Match],[Re.PullRequestRemoteBranch,pe.Match],[Re.Commit,pe.Match],[Re.Tag,pe.Match]]),n=new Map([[Re.Branch,ve.Edit],[Re.RemoteBranch,ve.Edit],[Re.PullRequestBranch,ve.Browse],[Re.PullRequestRemoteBranch,ve.Browse],[Re.Commit,ve.Browse],[Re.Tag,ve.Browse]]);function r(o){var a,s;return{display:(a=n.get(o))!=null?a:ve.Edit,index:(s=e.get(o))!=null?s:pe.None}}u(r,"getDefault"),t.getDefault=r;function i(o){switch(o){case Re.Branch:case Re.RemoteBranch:return{display:ve.Browse,index:pe.Latest};case Re.PullRequestBranch:case Re.PullRequestRemoteBranch:return{display:ve.Browse,index:pe.Match};case Re.Commit:case Re.Tag:return{display:ve.Browse,index:pe.Match};default:return{display:ve.Edit,index:pe.None}}}u(i,"getIndexDefault"),t.getIndexDefault=i})(Fr||(Fr={}));const gc=null;var Lo=et(179),Ha=et.n(Lo);const Fi="modes",Wa="indexMemento";class Uo{constructor(){this._onDidChange=new f.EventEmitter,this._onDidChangeAny=new f.EventEmitter,this.memoryState=new Map}static configure(e,n){de.configPrefix=e,de.state=n.workspaceState,n.subscriptions.push(f.workspace.onDidChangeConfiguration(de.onConfigurationChanged,de))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(this.configPrefix)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(Fi),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const n of this.memoryState.entries())this.modes[n[0]]=n[1];this._state.update(Fi,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(Wa),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,n,r){return r===void 0?f.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,n).get(e===void 0?this.configPrefix:e):f.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,n).get(e===void 0?this.configPrefix:e,r)}getMode(e,n,r){var i;const o=e.toString();let a=this.modes!==void 0?this.modes[o]:void 0;if(a!==void 0)return{display:ve.sanitize(a.display),index:pe.sanitize(a.index)};if(a=this.memoryState.get(o),a!==void 0)return a;if(n===Re.Branch||n===Re.RemoteBranch)switch((i=f.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:ve.Edit,index:pe.None};case"latest":return{display:ve.Browse,index:pe.Latest};case"tipPlusLatest":return{display:ve.Edit,index:pe.TipPlusLatest}}if(!r)return Fr.getDefault(n)}setMode(e,n){const r=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(r,n),Promise.resolve()):(this.modes[r]=n,this._state.update(Fi,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,n){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=n,this._state.update(Wa,this.indexMemento))}getAny(e,n,r){return r===void 0?f.workspace.getConfiguration(void 0,n).get(e):f.workspace.getConfiguration(void 0,n).get(e,r)}changed(e,n,r){var i;return(i=e==null?void 0:e.affectsConfiguration(`${this.configPrefix}.${n}`,r))!=null?i:!0}inspect(e,n){return f.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,n).inspect(e===void 0?this.configPrefix:e)}inspectAny(e,n){return f.workspace.getConfiguration(void 0,n).inspect(e)}async migrate(e,n,r){const i=de.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(n,r.migrationFn!=null?r.migrationFn(i.globalValue):i.globalValue,f.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceValue):i.workspaceValue,f.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,f.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&r.fallbackValue!==void 0&&(await this.update(n,r.fallbackValue,f.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,n,r){const i=de.inspect(e);if(i===void 0)return;const o=de.inspect(n);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(n,r.migrationFn!=null?r.migrationFn(i.globalValue):i.globalValue,f.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceValue):i.workspaceValue,f.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(n,r.migrationFn!=null?r.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,f.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,n,r){return f.workspace.getConfiguration(this.configPrefix).update(e,n,r)}updateAny(e,n,r,i){return f.workspace.getConfiguration(void 0,r===f.ConfigurationTarget.Global?void 0:i).update(e,n,r)}updateEffective(e,n){const r=de.inspect(e);return r.workspaceFolderValue!==void 0?n===r.workspaceFolderValue?Promise.resolve(void 0):de.update(e,n,f.ConfigurationTarget.WorkspaceFolder):r.workspaceValue!==void 0?n===r.workspaceValue?Promise.resolve(void 0):de.update(e,n,f.ConfigurationTarget.Workspace):r.globalValue===n||r.globalValue===void 0&&n===r.defaultValue?Promise.resolve(void 0):de.update(e,Ha()(n,r.defaultValue)?void 0:n,f.ConfigurationTarget.Global)}}u(Uo,"Configuration");const de=new Uo,Pt="";var it;(function(t){t.Off="off",t.Error="error",t.Warn="warn",t.Info="info",t.Debug="debug"})(it||(it={}));var Ba;(function(t){t[t.Off=0]="Off",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(Ba||(Ba={}));const Mi="[RemoteHub]",ir=u(class{static configure(t,e,n){this._isDebugging=t.extensionMode===f.ExtensionMode.Development,this.outputChannelName=e,this.logLevel=n}static enabled(t){return this.level>=this.toOrderedLevel(t)}static get logLevel(){return this._logLevel}static set logLevel(t){var e,n;this._logLevel=t,this.level=this.toOrderedLevel(t),t===it.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(n=this.output)!=null?n:f.window.createOutputChannel(this.outputChannelName)}static toOrderedLevel(t){switch(t){case it.Off:return 0;case it.Error:return 1;case it.Warn:return 2;case it.Info:return 3;case it.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(t,...e){ir.isDebugging&&console.log(this.timestamp,Mi,t!=null?t:Pt,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Pt}${this.toLoggableParams(!0,e)}`)}static error(t,e,...n){if(!(this.level<1&&!ir.isDebugging)){if(e===void 0){const r=t instanceof Error?t.stack:void 0;if(r){const i=/.*\s*?at\s(.+?)\s/.exec(r);i!==null&&(e=i[1])}}ir.isDebugging&&console.error(this.timestamp,Mi,e!=null?e:Pt,...n,t),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:Pt}${this.toLoggableParams(!1,n)}
${String(t)}`)}}static log(t,...e){ir.isDebugging&&console.log(this.timestamp,Mi,t!=null?t:Pt,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Pt}${this.toLoggableParams(!1,e)}`)}static warn(t,...e){ir.isDebugging&&console.warn(this.timestamp,Mi,t!=null?t:Pt,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Pt}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var t;(t=this.output)==null||t.show()}static toLoggable(t,e){if(typeof t!="object")return String(t);if(t instanceof f.Uri)return`Uri(${t.toString(!0)})`;try{return JSON.stringify(t,e)}catch{return"<error>"}}static toLoggableName(t){var e,n,r;let i;if(typeof t=="function"){if(t.prototype===void 0||t.prototype.constructor===void 0)return t.name;i=(e=t.prototype.constructor.name)!=null?e:Pt}else i=(r=(n=t.constructor)==null?void 0:n.name)!=null?r:Pt;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const t=new Date;return`[${t.toISOString().replace(/T/," ").replace(/\..+/,Pt)}:${`00${t.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(t,e){if(e.length===0||t&&this.level<4&&!ir.isDebugging)return Pt;const n=e.map(r=>this.toLoggable(r)).join(", ");return n.length!==0?` \u2014 ${n}`:Pt}},"_Logger");let U=ir;U.level=0,U._logLevel=it.Off;const pc=new TextDecoder,vc=new TextEncoder;async function ti(t){const e=typeof t=="string"?vc.encode(t):t;let n;if(globalThis.crypto.subtle)n=await globalThis.crypto.subtle.digest({name:"sha-1"},e);else{const r=new Ho;r.update(e),n=r.digest()}return globalThis.btoa(encodeURIComponent(pc.decode(n)))}u(ti,"sha1");var ni;(function(t){t[t.BLOCK_SIZE=64]="BLOCK_SIZE"})(ni||(ni={}));function ri(t,e,n=32){const r=n-e,i=~((1<<r)-1);return(t<<e|(i&t)>>>r)>>>0}u(ri,"leftRotate");function Oo(t,e=0,n=t.byteLength,r=0){for(let i=0;i<n;i++)t[e+i]=r}u(Oo,"fill");const Yt=u(class{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._finished=!1}update(t){const e=this._buff;let n=this._buffLen,r=0;const i=t.byteLength;for(;r<i;){const o=Math.min(64-n,i-r);for(let a=0;a<o;a++)e[n++]=t[r++];n>=64&&(this._step(),n-=64,this._totalLen+=64)}this._buffLen=n}digest(){this._finished||(this._finished=!0,this._totalLen+=this._buffLen,this._wrapUp());const t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this._h0,!1),e.setUint32(4,this._h1,!1),e.setUint32(8,this._h2,!1),e.setUint32(12,this._h3,!1),e.setUint32(16,this._h4,!1),t}_wrapUp(){this._buff[this._buffLen++]=128,Oo(this._buff,this._buffLen),this._buffLen>56&&(this._step(),Oo(this._buff));const t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){const t=Yt._bigBlock32,e=this._buffDV;for(let d=0;d<64;d+=4)t.setUint32(d,e.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)t.setUint32(d,ri(t.getUint32(d-12,!1)^t.getUint32(d-32,!1)^t.getUint32(d-56,!1)^t.getUint32(d-64,!1),1),!1);let n=this._h0,r=this._h1,i=this._h2,o=this._h3,a=this._h4,s,c,l;for(let d=0;d<80;d++)d<20?(s=r&i|~r&o,c=1518500249):d<40?(s=r^i^o,c=1859775393):d<60?(s=r&i|r&o|i&o,c=2400959708):(s=r^i^o,c=3395469782),l=ri(n,5)+s+a+c+t.getUint32(d*4,!1)&4294967295,a=o,o=i,i=ri(r,30),r=n,n=l;this._h0=this._h0+n&4294967295,this._h1=this._h1+r&4294967295,this._h2=this._h2+i&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}},"_SHA1Computer");let Ho=Yt;Ho._bigBlock32=new DataView(new ArrayBuffer(320));function mc(t){const e=globalThis.atob(t),n=e.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=e.charCodeAt(i);return r}u(mc,"fromBase64");const{fromCharCode:wc}=String;function yc(t){let e;if(typeof t=="string")e=t;else{e="";for(let n=0,{length:r}=t;n<r;n++)e+=wc(t[n])}return globalThis.btoa(e)}u(yc,"toBase64");function Ni(t,e){if(t===e)return-1;let n=0;for(;t[n]===e[n];)n++;return n}u(Ni,"indexOfDifference");let Sn;var Li;(function(t){function e(n){const r=or(n);return Sn=f.env.uiKind===f.UIKind.Web,U.warn(`Running on the ${Sn?"web":"desktop"}${n.extensionRuntime!==f.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${r}; storageUri=${n.globalStorageUri.toString(!0)}`),r}u(e,"configure"),t.configure=e})(Li||(Li={}));const Cc=/\/workspaceStorage\/(?<id>[^/]+)/i;function or(t){var e;if(t.storageUri===void 0)return"";const n=Cc.exec(t.storageUri.path);let r;if((e=n==null?void 0:n.groups)==null?void 0:e.id)r=n.groups.id;else{r=t.storageUri.path;const i=Ni(t.globalStorageUri.path,r),o=`/${t.extension.id}`;r.endsWith(o)?r=r.slice(i,-o.length):r=r.substr(i)}return/-[0-9]$/.test(r)?r.slice(0,-2):r}u(or,"getWorkspaceId");var ar;(function(t){t.HasVirtualFolders="remoteHub:hasVirtualFolders",t.VirtualFolderProviders="remoteHub:virtualFolderProviders",t.HasRecentRepositories="remoteHub:hasRecentRepositories",t.HasSearchIndexes="gitHub:hasSearchIndexes",t.EnabledSomeSearchIndexes="gitHub:enabledSomeSearchIndexes",t.EnabledAllSearchIndexes="gitHub:enabledAllSearchIndexes",t.HasPullRequestExtension="gitHub:hasPullRequestExtension"})(ar||(ar={}));const $a=new Map;function Mr(t){return t==="isWeb"?Sn:t==="remoteName"?f.env.remoteName:t==="virtualWorkspace"?ce.isVirtualWorkspace():t.startsWith("config.")?de.getAny(t.substring(7)):$a.get(t)}u(Mr,"getContext");function Hn(t){return t==="isWeb"||t==="remoteName"||t==="virtualWorkspace"||t.startsWith("config.")||t.startsWith("remoteHub:")||t.startsWith("continueOn:")}u(Hn,"isSupportedContextKey");async function _n(t,e){$a.set(t,e),!t.startsWith("continueOn:")&&await f.commands.executeCommand("setContext",t,e)}u(_n,"setContext");var ii=Object.defineProperty,Ui=Object.getOwnPropertySymbols,Wo=Object.prototype.hasOwnProperty,oi=Object.prototype.propertyIsEnumerable,Va=u((t,e,n)=>e in t?ii(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,"yo"),Vt=u((t,e)=>{for(var n in e||(e={}))Wo.call(e,n)&&Va(t,n,e[n]);if(Ui)for(var n of Ui(e))oi.call(e,n)&&Va(t,n,e[n]);return t},"Xe"),bc=u(t=>ii(t,"__esModule",{value:!0}),"Iu"),L=u((t,e)=>()=>(t&&(e=t(t=0)),e),"C"),Sc=u((t,e)=>{bc(t);for(var n in e)ii(t,n,{get:e[n],enumerable:!0})},"Tu"),Oi=u((t,e,n)=>new Promise((r,i)=>{var o=u(c=>{try{s(n.next(c))}catch(l){i(l)}},"a"),a=u(c=>{try{s(n.throw(c))}catch(l){i(l)}},"o"),s=u(c=>c.done?r(c.value):Promise.resolve(c.value).then(o,a),"c");s((n=n.apply(t,e)).next())}),"Br"),Hi,sr=L(()=>{Hi={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}}),Nr,ln,xn,Ft,Wi,ht,Bi,$i,qa,za,ai,In=L(()=>{Nr="function",ln="object",xn="undefined",Ft="prototype",Wi="hasOwnProperty",ht=Object,Bi=ht[Ft],$i=ht.assign,qa=ht.create,za=ht.defineProperty,ai=Bi[Wi]});function Lr(){return typeof globalThis!==xn&&globalThis?globalThis:typeof self!==xn&&self?self:typeof window!==xn&&window?window:typeof et.g!==xn&&et.g?et.g:null}u(Lr,"st");function Bo(t){throw new TypeError(t)}u(Bo,"Er");function Vi(t){var e=qa;if(e)return e(t);if(t==null)return{};var n=typeof t;n!==ln&&n!==Nr&&Bo("Object prototype may only be an Object:"+t);function r(){}return u(r,"n"),r[Ft]=t,new r}u(Vi,"Nt");var ja=L(()=>{In()});function Te(t,e){typeof e!==Nr&&e!==null&&Bo("Class extends value "+String(e)+" is not a constructor or null"),zi(t,e);function n(){this.constructor=t}u(n,"r"),t[Ft]=e===null?Vi(e):(n[Ft]=e[Ft],new n)}u(Te,"z");var qi,_c,Ga,Mt,zi,xc=L(()=>{In(),ja(),qi=(Lr()||{}).Symbol,_c=(Lr()||{}).Reflect,Ga=u(function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Bi[Wi].call(e,i)&&(t[i]=e[i])}return t},"Pu"),Mt=$i||Ga,zi=u(function(t,e){return zi=ht.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r[Wi](i)&&(n[i]=r[i])},zi(t,e)},"Mi")}),Ic=L(()=>{}),Ne=L(()=>{In(),ja(),xc(),Ic()});function Wn(t,e){return t&&dr[dn].hasOwnProperty.call(t,e)}u(Wn,"Bt");function Ka(t){return t&&(t===dr[dn]||t===Array[dn])}u(Ka,"Do");function Ur(t){return Ka(t)||t===Function[dn]}u(Ur,"Oi");function cr(t){if(t){if(Wr)return Wr(t);var e=t[Ja]||t[dn]||(t[un]?t[un][dn]:null);if(e)return e}return null}u(cr,"ar");function Bn(t,e){var n=[],r=dr.getOwnPropertyNames;if(r)n=r(t);else for(var i in t)typeof i=="string"&&Wn(t,i)&&n.push(i);if(n&&n.length>0)for(var o=0;o<n.length;o++)e(n[o])}u(Bn,"qn");function ji(t,e,n){return e!==un&&typeof t[e]===ci&&(n||Wn(t,e))}u(ji,"zi");function si(t){throw new TypeError("DynamicProto: "+t)}u(si,"Gn");function Ec(t){var e={};return Bn(t,function(n){!e[n]&&ji(t,n,!1)&&(e[n]=t[n])}),e}u(Ec,"Au");function $o(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return!0;return!1}u($o,"Hi");function kc(t,e,n,r){function i(c,l,d){var h=l[d];if(h[Ki]&&r){var g=c[qt]||{};g[Hr]!==!1&&(h=(g[l[lr]]||{})[d]||h)}return function(){return h.apply(c,arguments)}}u(i,"i");var o={};Bn(n,function(c){o[c]=i(e,n,c)});for(var a=cr(t),s=[];a&&!Ur(a)&&!$o(s,a);)Bn(a,function(c){!o[c]&&ji(a,c,!Wr)&&(o[c]=i(e,a,c))}),s.push(a),a=cr(a);return o}u(kc,"Nu");function Rc(t,e,n,r){var i=null;if(t&&Wn(n,lr)){var o=t[qt]||{};if(i=(o[n[lr]]||{})[e],i||si("Missing ["+e+"] "+ci),!i[Qi]&&o[Hr]!==!1){for(var a=!Wn(t,e),s=cr(t),c=[];a&&s&&!Ur(s)&&!$o(c,s);){var l=s[e];if(l){a=l===r;break}c.push(s),s=cr(s)}try{a&&(t[e]=i),i[Qi]=1}catch(d){o[Hr]=!1}}}return i}u(Rc,"Fu");function Qa(t,e,n){var r=e[t];return r===n&&(r=cr(e)[t]),typeof r!==ci&&si("["+t+"] is not a "+ci),r}u(Qa,"ku");function Dc(t,e,n,r,i){function o(c,l){var d=u(function(){var h=Rc(this,l,c,d)||Qa(l,c,d);return h.apply(this,arguments)},"l");return d[Ki]=1,d}if(u(o,"a"),!Ka(t)){var a=n[qt]=n[qt]||{},s=a[e]=a[e]||{};a[Hr]!==!1&&(a[Hr]=!!i),Bn(n,function(c){ji(n,c,!1)&&n[c]!==r[c]&&(s[c]=n[c],delete n[c],(!Wn(t,c)||t[c]&&!t[c][Ki])&&(t[c]=o(t,c)))})}}u(Dc,"Ru");function Tc(t,e){if(Wr)for(var n=[],r=cr(e);r&&!Ur(r)&&!$o(n,r);){if(r===t)return!0;n.push(r),r=cr(r)}return!1}u(Tc,"Mu");function Gi(t,e){return Wn(t,dn)?t.name||e||Xi:((t||{})[un]||{}).name||e||Xi}u(Gi,"ji");function Or(t,e,n,r){Wn(t,dn)||si("theClass is an invalid class definition.");var i=t[dn];Tc(i,e)||si("["+Gi(t)+"] is not in class hierarchy of ["+Gi(e)+"]");var o=null;Wn(i,lr)?o=i[lr]:(o=Xa+Gi(t,"_")+"$"+Ji,Ji++,i[lr]=o);var a=Or[En],s=!!a[ur];s&&r&&r[ur]!==void 0&&(s=!!r[ur]);var c=Ec(e),l=kc(i,e,c,s);n(e,l);var d=!!Wr&&!!a[Vo];d&&r&&(d=!!r[Vo]),Dc(i,o,e,c,d!==!1)}u(Or,"Bi");var un,dn,ci,qt,Ki,lr,Xa,Qi,Hr,En,Xi,Ja,ur,Vo,dr,Wr,Ji,qo,Xe,je=L(()=>{un="constructor",dn="prototype",ci="function",qt="_dynInstFuncs",Ki="_isDynProxy",lr="_dynClass",Xa="_dynCls$",Qi="_dynInstChk",Hr=Qi,En="_dfOpts",Xi="_unknown_",Ja="__proto__",ur="useBaseInst",Vo="setInstFuncs",dr=Object,Wr=dr.getPrototypeOf,Ji=0,qo={setInstFuncs:!0,useBaseInst:!0},Or[En]=qo,Xe=Or}),q,B,Yi=L(()=>{(function(t){t[t.CRITICAL=1]="CRITICAL",t[t.WARNING=2]="WARNING"})(q||(q={})),B={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103}});function zo(t){return Bi.toString.call(t)}u(zo,"Vi");function b(t,e){return typeof t===e}u(b,"qi");function I(t){return t===void 0||typeof t===xn}u(I,"de");function k(t){return t===null||I(t)}u(k,"x");function Y(t){return!k(t)}u(Y,"Gi");function Le(t,e){return t&&ai.call(t,e)}u(Le,"Pr");function le(t){return typeof t===ln}u(le,"ct");function re(t){return typeof t===Nr}u(re,"H");function Ge(t,e,n,r){r===void 0&&(r=!1);var i=!1;if(!k(t))try{k(t[Mc])?k(t[Fc])||(t[Fc](Pc+e,n),i=!0):(t[Mc](e,n,r),i=!0)}catch(o){}return i}u(Ge,"Vt");function ot(t,e,n,r){if(r===void 0&&(r=!1),!k(t))try{k(t[Lc])?k(t[Nc])||t[Nc](Pc+e,n):t[Lc](e,n,r)}catch(i){}}u(ot,"Kn");function Ve(t){var e=t,n=/([^\w\d_$])/g;return n.test(t)&&(e=t.replace(n,"_")),e}u(Ve,"Ki");function Ee(t,e){if(t)for(var n in t)ai.call(t,n)&&e.call(t,n,t[n])}u(Ee,"Y");function Zt(t,e){if(t&&e){var n=e.length,r=t.length;if(t===e)return!0;if(r>=n){for(var i=r-1,o=n-1;o>=0;o--){if(t[i]!=e[o])return!1;i--}return!0}}return!1}u(Zt,"Wi");function ke(t,e){return t&&e?t.indexOf(e)!==-1:!1}u(ke,"we");function It(t){return zo(t)==="[object Date]"}u(It,"br");function Ye(t){return zo(t)==="[object Array]"}u(Ye,"Me");function en(t){return zo(t)==="[object Error]"}u(en,"qt");function ae(t){return typeof t=="string"}u(ae,"_");function kn(t){return typeof t=="number"}u(kn,"or");function Zi(t){return typeof t=="boolean"}u(Zi,"Wr");function tn(t){if(It(t)){var e=u(function(n){var r=String(n);return r.length===1&&(r="0"+r),r},"e");return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}u(tn,"Le");function ge(t,e,n){for(var r=t.length,i=0;i<r&&!(i in t&&e.call(n||t,t[i],i,t)===-1);i++);}u(ge,"R");function jo(t,e,n){for(var r=t.length,i=n||0,o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in t&&t[o]===e)return o;return-1}u(jo,"kt");function Go(t,e,n){for(var r=t.length,i=n||t,o=new Array(r),a=0;a<r;a++)a in t&&(o[a]=e.call(i,t[a],t));return o}u(Go,"Gt");function Yu(t,e,n){var r=t.length,i=0,o;if(arguments.length>=3)o=arguments[2];else{for(;i<r&&!(i in t);)i++;o=t[i++]}for(;i<r;)i in t&&(o=e(o,t[i],i,t)),i++;return o}u(Yu,"Jr");function Ct(t){return typeof t!="string"?t:t.replace(/^\s+|\s+$/g,"")}u(Ct,"oe");function li(t){var e=typeof t;e!==Nr&&(e!==ln||t===null)&&Bo("objKeys called on non-object");var n=[];for(var r in t)t&&ai.call(t,r)&&n.push(r);if(nd)for(var i=Ya.length,o=0;o<i;o++)t&&ai.call(t,Ya[o])&&n.push(Ya[o]);return n}u(li,"et");function eo(t,e,n,r){if(Uc)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),Uc(t,e,i),!0}catch(o){}return!1}u(eo,"Ct");function hn(){var t=Date;return t.now?t.now():new t().getTime()}u(hn,"me");function Ae(t){return en(t)?t.name:""}u(Ae,"G");function Ie(t,e,n,r,i){var o=n;return t&&(o=t[e],o!==n&&(!i||i(o))&&(!r||r(n))&&(o=n,t[e]=o)),o}u(Ie,"K");function Et(t,e,n){var r;return t?(r=t[e],!r&&k(r)&&(r=I(n)?{}:n,t[e]=r)):r=I(n)?{}:n,r}u(Et,"ve");function Zu(t){return!t}u(Zu,"Wn");function Ac(t){return!!t}u(Ac,"Dr");function $n(t){throw new Error(t)}u($n,"Ne");function ed(t,e,n){if(t&&e&&t!==e&&le(t)&&le(e)){var r=u(function(o){if(ae(o)){var a=e[o];re(a)?(!n||n(o,!0,e,t))&&(t[o]=function(s){return function(){var c=arguments;return e[s].apply(e,c)}}(o)):(!n||n(o,!1,e,t))&&(Le(t,o)&&delete t[o],eo(t,o,function(){return e[o]},function(s){e[o]=s})||(t[o]=a))}},"n");for(var i in e)r(i)}return t}u(ed,"Xr");function yp(t){return function(){function e(){var n=this;t&&Ee(t,function(r,i){n[r]=i})}return u(e,"e"),e}()}u(yp,"Xi");function td(t){return t&&(t=ht($i?$i({},t):t)),t}u(td,"Jn");var Pc,Fc,Mc,Nc,Lc,Uc,Cp,bp,nd,Ya,kt=L(()=>{Ne(),Pc="on",Fc="attachEvent",Mc="addEventListener",Nc="detachEvent",Lc="removeEventListener",Uc=za,Cp=ht.freeze,bp=ht.seal,nd=!{toString:null}.propertyIsEnumerable("toString"),Ya=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]});function Rt(t){var e=Lr();return e&&e[t]?e[t]:t===Hc&&Za()?window:null}u(Rt,"Pe");function Za(){return Boolean(typeof window===ln&&window)}u(Za,"sr");function Ko(){return Za()?window:Rt(Hc)}u(Ko,"It");function rd(){return Boolean(typeof document===ln&&document)}u(rd,"Xn");function Vn(){return rd()?document:Rt(id)}u(Vn,"Fe");function Sp(){return Boolean(typeof navigator===ln&&navigator)}u(Sp,"_o");function qn(){return Sp()?navigator:Rt(od)}u(qn,"_e");function _p(){return Boolean(typeof history===ln&&history)}u(_p,"Oo");function xp(){return _p()?history:Rt(ad)}u(xp,"ea");function ui(t){if(t&&fd){var e=Rt("__mockLocation");if(e)return e}return typeof location===ln&&location?location:Rt(sd)}u(ui,"tt");function Ip(){return typeof console!==xn?console:Rt(cd)}u(Ip,"ta");function hr(){return Rt(ld)}u(hr,"Ze");function to(){return Boolean(typeof JSON===ln&&JSON||Rt(Wc)!==null)}u(to,"ht");function Rn(){return to()?JSON||Rt(Wc):null}u(Rn,"be");function Ep(){return Rt(ud)}u(Ep,"ra");function kp(){return Rt(dd)}u(kp,"na");function Rp(){var t=qn();return t&&t.product?t.product===hd:!1}u(Rp,"ia");function es(){var t=qn();if(t&&(t.userAgent!==is||rs===null)){is=t.userAgent;var e=(is||"").toLowerCase();rs=ke(e,ts)||ke(e,ns)}return rs}u(es,"Kt");function Oc(t){if(t===void 0&&(t=null),!t){var e=qn()||{};t=e?(e.userAgent||"").toLowerCase():""}var n=(t||"").toLowerCase();if(ke(n,ts))return parseInt(n.split(ts)[1]);if(ke(n,ns)){var r=parseInt(n.split(ns)[1]);if(r)return r+4}return null}u(Oc,"cr");function me(t){var e=Object[Ft].toString.call(t),n="";return e==="[object Error]"?n="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'":to()&&(n=Rn().stringify(t)),e+n}u(me,"O");var Hc,id,od,ad,sd,cd,ld,Wc,ud,dd,hd,ts,ns,rs,is,fd,Qo=L(()=>{Ne(),kt(),Hc="window",id="document",od="navigator",ad="history",sd="location",cd="console",ld="performance",Wc="JSON",ud="crypto",dd="msCrypto",hd="ReactNative",ts="msie",ns="trident/",rs=null,is=null,fd=!1});function gd(t){return t?'"'+t.replace(/\"/g,"")+'"':""}u(gd,"zo");function os(t,e){return(t||{}).logger||new Bc(e)}u(os,"Mt");var pd,vd,md,no,Bc,$c=L(()=>{Yi(),Qo(),je(),kt(),pd="AI (Internal): ",vd="AI: ",md="AITR_",no=function(){function t(e,n,r,i){r===void 0&&(r=!1);var o=this;o.messageId=e,o.message=(r?vd:pd)+e;var a="";to()&&(a=Rn().stringify(i));var s=(n?" message:"+gd(n):"")+(i?" props:"+gd(a):"");o.message+=s}return u(t,"t"),t.dataType="MessageData",t}(),Bc=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};Xe(t,this,function(i){k(e)&&(e={}),i.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},i.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},i.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},i.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},i.throwInternal=function(s,c,l,d,h){h===void 0&&(h=!1);var g=new no(c,l,h,d);if(i.enableDebugExceptions())throw g;if(!I(g.message)){var p=i.consoleLoggingLevel();if(h){var y=+g.messageId;!r[y]&&p>=q.WARNING&&(i.warnToConsole(g.message),r[y]=!0)}else p>=q.WARNING&&i.warnToConsole(g.message);i.logInternalMessage(s,g)}},i.warnToConsole=function(s){var c=Ip();if(c){var l="log";c.warn&&(l="warn"),re(c[l])&&c[l](s)}},i.resetInternalMessageCount=function(){n=0,r={}},i.logInternalMessage=function(s,c){if(!a()){var l=!0,d=md+c.messageId;if(r[d]?l=!1:r[d]=!0,l&&(s<=i.telemetryLoggingLevel()&&(i.queue.push(c),n++),n===i.maxInternalMessageLimit())){var h="Internal events throttle limit per PageView reached for this app.",g=new no(B.MessageLimitPerPVExceeded,h,!1);i.queue.push(g),i.warnToConsole(h)}}};function o(s,c){var l=e[s];return k(l)?c:l}u(o,"a");function a(){return n>=i.maxInternalMessageLimit()}u(a,"o")})}return u(t,"t"),t}()});function ro(t,e,n,r,i){if(t){var o=t;if(re(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(as);try{if(a=o.create(e(),r,i),a){if(s&&a.setCtx&&(a.setCtx(io.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(io.ChildrenContextKey);c||(c=[],s.setCtx(io.ChildrenContextKey,c)),c.push(a)}return o.setCtx(as,a),n(a)}}catch(l){a&&a.setCtx&&a.setCtx("exception",l)}finally{a&&o.fire(a),o.setCtx(as,s)}}}return n()}u(ro,"ut");var di,io,Vc,as,ss=L(()=>{je(),kt(),di="ctx",io=function(){function t(e,n,r){var i=this,o=!1;if(i.start=hn(),i.name=e,i.isAsync=r,i.isChildEvt=function(){return!1},re(n)){var a;o=eo(i,"payload",function(){return!a&&re(n)&&(a=n(),n=null),a})}i.getCtx=function(s){return s?s===t.ParentContextKey||s===t.ChildrenContextKey?i[s]:(i[di]||{})[s]:null},i.setCtx=function(s,c){if(s)if(s===t.ParentContextKey)i[s]||(i.isChildEvt=function(){return!0}),i[s]=c;else if(s===t.ChildrenContextKey)i[s]=c;else{var l=i[di]=i[di]||{};l[s]=c}},i.complete=function(){var s=0,c=i.getCtx(t.ChildrenContextKey);if(Ye(c))for(var l=0;l<c.length;l++){var d=c[l];d&&(s+=d.time)}i.time=hn()-i.start,i.exTime=i.time-s,i.complete=function(){},!o&&re(n)&&(i.payload=n())}}return u(t,"t"),t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),Vc=function(){function t(e){this.ctx={},Xe(t,this,function(n){n.create=function(r,i,o){return new io(r,i,o)},n.fire=function(r){r&&(r.complete(),e&&e.perfEvent(r))},n.setCtx=function(r,i){if(r){var o=n[di]=n[di]||{};o[r]=i}},n.getCtx=function(r){return(n[di]||{})[r]}})}return u(t,"t"),t}(),as="CoreUtils.doPerf"}),wd,Dp=L(()=>{ss(),Yi(),kt(),wd=function(){function t(e,n){var r=this,i=null,o=re(e.processTelemetry),a=re(e.setNextPlugin);r._hasRun=!1,r.getPlugin=function(){return e},r.getNext=function(){return i},r.setNext=function(s){i=s},r.processTelemetry=function(s,c){c||(c=n);var l=e?e.identifier:"TelemetryPluginChain";ro(c?c.core():null,function(){return l+":processTelemetry"},function(){if(e&&o){r._hasRun=!0;try{c.setNext(i),a&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(s,c)}catch(h){var d=i&&i._hasRun;(!i||!d)&&c.diagLog().throwInternal(q.CRITICAL,B.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+h),i&&!d&&i.processTelemetry(s,c)}}else i&&(r._hasRun=!0,i.processTelemetry(s,c))},function(){return{item:s}},!s.sync)}}return u(t,"t"),t}()});function qc(t,e){var n=[];if(t&&t.length>0)for(var r=null,i=0;i<t.length;i++){var o=t[i];if(o&&re(o.processTelemetry)){var a=new wd(o,e);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}u(qc,"oa");function Tp(t,e,n){var r=[],i=!n;if(t)for(;t;){var o=t.getPlugin();(i||o===n)&&(i=!0,r.push(o)),t=t.getNext()}return i||r.push(n),qc(r,e)}u(Tp,"Qu");function Ap(t,e,n){var r=t,i=!1;return n&&t&&(r=[],ge(t,function(o){(i||o===n)&&(i=!0,r.push(o))})),n&&!i&&(r||(r=[]),r.push(n)),qc(r,e)}u(Ap,"Zu");var hi,zc=L(()=>{$c(),Dp(),kt(),hi=function(){function t(e,n,r,i){var o=this,a=null;i!==null&&(e&&re(e.getPlugin)?a=Tp(e,o,i||e.getPlugin()):i?a=Ap(e,o,i):I(i)&&(a=qc(e,o))),o.core=function(){return r},o.diagLog=function(){return os(r,n)},o.getCfg=function(){return n},o.getExtCfg=function(s,c){c===void 0&&(c={});var l;if(n){var d=n.extensionConfig;d&&s&&(l=d[s])}return l||c},o.getConfig=function(s,c,l){l===void 0&&(l=!1);var d,h=o.getExtCfg(s,null);return h&&!k(h[c])?d=h[c]:n&&!k(n[c])&&(d=n[c]),k(d)?l:d},o.hasNext=function(){return a!=null},o.getNext=function(){return a},o.setNext=function(s){a=s},o.processNext=function(s){var c=a;c&&(a=c.getNext(),c.processTelemetry(s,o))},o.createNew=function(s,c){return s===void 0&&(s=null),new t(s||a,n,r,c)}}return u(t,"t"),t}()}),yd,jc,Cd=L(()=>{yd="iKey",jc="extensionConfig"}),Xo,fi,bd=L(()=>{zc(),kt(),Cd(),Xo="getPlugin",fi=function(){function t(){var e=this,n=!1,r=null,i=null;e.core=null,e.diagLog=function(o){return e._getTelCtx(o).diagLog()},e.isInitialized=function(){return n},e.setInitialized=function(o){n=o},e.setNextPlugin=function(o){i=o},e.processNext=function(o,a){a?a.processNext(o):i&&re(i.processTelemetry)&&i.processTelemetry(o,null)},e._getTelCtx=function(o){o===void 0&&(o=null);var a=o;if(!a){var s=r||new hi(null,{},e.core);i&&i[Xo]?a=s.createNew(null,i[Xo]):a=s.createNew(null,i)}return a},e._baseTelInit=function(o,a,s,c){o&&Ie(o,jc,[],null,k),!c&&a&&(c=a.getProcessTelContext().getNext());var l=i;i&&i[Xo]&&(l=i[Xo]()),e.core=a,r=new hi(c,o,a,l),n=!0}}return u(t,"t"),t.prototype.initialize=function(e,n,r,i){this._baseTelInit(e,n,r,i)},t}()});function Gc(t,e){for(var n=[],r=null,i=t.getNext();i;){var o=i.getPlugin();o&&(r&&re(r[Qc])&&re(o[cs])&&r[Qc](o),(!re(o[Xc])||!o[Xc]())&&n.push(o),r=o,i=i.getNext())}ge(n,function(a){a.initialize(t.getCfg(),t.core(),e,t.getNext())})}u(Gc,"$r");function Sd(t){return t.sort(function(e,n){var r=0,i=re(n[cs]);return re(e[cs])?r=i?e[Kc]-n[Kc]:1:i&&(r=-1),r})}u(Sd,"la");var cs,Kc,Qc,Xc,_d=L(()=>{kt(),cs="processTelemetry",Kc="priority",Qc="setNextPlugin",Xc="isInitialized"}),ls,xd,Id,Pp=L(()=>{Ne(),je(),bd(),zc(),_d(),kt(),ls=500,xd="Channel has invalid priority",Id=function(t){Te(e,t);function e(){var n=t.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=ls;var r;Xe(e,n,function(s,c){s.setNextPlugin=function(l){},s.processTelemetry=function(l,d){r&&ge(r,function(h){if(h.length>0){var g=n._getTelCtx(d).createNew(h);g.processNext(l)}})},s.getChannelControls=function(){return r},s.initialize=function(l,d,h){s.isInitialized()||(c.initialize(l,d,h),a((l||{}).channels,h),ge(r,function(g){return Gc(new hi(g,l,d),h)}))}});function i(s){ge(s,function(c){c.priority<ls&&$n(xd+c.identifier)})}u(i,"i");function o(s){s&&s.length>0&&(s=s.sort(function(c,l){return c.priority-l.priority}),i(s),r.push(s))}u(o,"a");function a(s,c){if(r=[],s&&ge(s,function(d){return o(d)}),c){var l=[];ge(c,function(d){d.priority>ls&&l.push(d)}),o(l)}}return u(a,"o"),n}return u(e,"e"),e._staticInit=function(){var n=e.prototype;eo(n,"ChannelControls",n.getChannelControls),eo(n,"channelQueue",n.getChannelControls)}(),e}(fi)});function Ed(t,e){var n=Jo[fr]||Zo[fr];return n||(n=Jo[fr]=Jo(t,e),Zo[fr]=n),n}u(Ed,"ha");function us(t){return t?t.isEnabled():!0}u(us,"ni");function Fp(t){var e=t.cookieCfg=t.cookieCfg||{};if(Ie(e,"domain",t.cookieDomain,Y,k),Ie(e,"path",t.cookiePath||"/",null,k),k(e[fs])){var n=void 0;I(t[el])||(n=!t[el]),I(t[tl])||(n=!t[tl]),e[fs]=n}return e}u(Fp,"Yu");function Jc(t,e){var n;if(t)n=t.getCookieMgr();else if(e){var r=e.cookieCfg;r[fr]?n=r[fr]:n=Jo(e)}return n||(n=Ed(e,(t||{}).logger)),n}u(Jc,"lr");function Jo(t,e){var n=Fp(t||Zo),r=n.path||"/",i=n.domain,o=n[fs]!==!1,a={isEnabled:function(){var s=o&&kd(e),c=Zo[fr];return s&&c&&a!==c&&(s=us(c)),s},setEnabled:function(s){o=s!==!1},set:function(s,c,l,d,h){if(us(a)){var g={},p=Ct(c||fn),y=p.indexOf(";");if(y!==-1&&(p=Ct(c.substring(0,y)),g=Rd(c.substring(y+1))),Ie(g,"domain",d||i,Ac,I),!k(l)){var v=es();if(I(g[hs])){var m=hn(),C=m+l*1e3;if(C>0){var w=new Date;w.setTime(C),Ie(g,hs,Dd(w,v?Yc:Zc)||Dd(w,v?Yc:Zc)||fn,Ac)}}v||Ie(g,"max-age",fn+l,null,I)}var _=ui();_&&_.protocol==="https:"&&(Ie(g,"secure",null,null,I),gs===null&&(gs=!Pd((qn()||{}).userAgent)),gs&&Ie(g,"SameSite","None",null,I)),Ie(g,"path",h||r,null,I);var E=n.setCookie||Ad;E(s,Td(p,g))}},get:function(s){var c=fn;return us(a)&&(c=(n.getCookie||Mp)(s)),c},del:function(s,c){us(a)&&a.purge(s,c)},purge:function(s,c){if(kd(e)){var l=(h={},h.path=c||"/",h[hs]="Thu, 01 Jan 1970 00:00:01 GMT",h);es()||(l["max-age"]="0");var d=n.delCookie||Ad;d(s,Td(fn,l))}var h}};return a[fr]=a,a}u(Jo,"fr");function kd(t){if(Yo===null){Yo=!1;try{var e=oo||{};Yo=e[ds]!==void 0}catch(n){t&&t.throwInternal(q.WARNING,B.CannotAccessCookie,"Cannot access document.cookie - "+Ae(n),{exception:me(n)})}}return Yo}u(kd,"xa");function Rd(t){var e={};if(t&&t.length){var n=Ct(t).split(";");ge(n,function(r){if(r=Ct(r||fn),r){var i=r.indexOf("=");i===-1?e[r]=null:e[Ct(r.substring(0,i))]=Ct(r.substring(i+1))}})}return e}u(Rd,"es");function Dd(t,e){return re(t[e])?t[e]():null}u(Dd,"ts");function Td(t,e){var n=t||fn;return Ee(e,function(r,i){n+="; "+r+(k(i)?fn:"="+i)}),n}u(Td,"rs");function Mp(t){var e=fn;if(oo){var n=oo[ds]||fn;nl!==n&&(rl=Rd(n),nl=n),e=Ct(rl[t]||fn)}return e}u(Mp,"el");function Ad(t,e){oo&&(oo[ds]=t+"="+e)}u(Ad,"ns");function Pd(t){return ae(t)?!!(ke(t,"CPU iPhone OS 12")||ke(t,"iPad; CPU OS 12")||ke(t,"Macintosh; Intel Mac OS X 10_14")&&ke(t,"Version/")&&ke(t,"Safari")||ke(t,"Macintosh; Intel Mac OS X 10_14")&&Zt(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||ke(t,"Chrome/5")||ke(t,"Chrome/6")||ke(t,"UnrealEngine")&&!ke(t,"Chrome")||ke(t,"UCBrowser/12")||ke(t,"UCBrowser/11")):!1}u(Pd,"ii");var Yc,Zc,ds,hs,fs,el,tl,fr,fn,Yo,gs,nl,oo,rl,Zo,il=L(()=>{Yi(),Qo(),kt(),Yc="toGMTString",Zc="toUTCString",ds="cookie",hs="expires",fs="enabled",el="isCookieUseDisabled",tl="disableCookiesUsage",fr="_ckMgr",fn="",Yo=null,gs=null,nl=null,oo=Vn(),rl={},Zo={}}),Fd,ol,al,Md=L(()=>{Ne(),je(),Pp(),zc(),_d(),ss(),il(),kt(),Cd(),Fd="Extensions must provide callback to initialize",ol="_notificationManager",al=function(){function t(){var e=!1,n,r,i,o,a;Xe(t,this,function(s){s._extensions=new Array,r=new Id,s.logger=Vi({throwInternal:function(c,l,d,h,g){g===void 0&&(g=!1)},warnToConsole:function(c){},resetInternalMessageCount:function(){}}),n=[],s.isInitialized=function(){return e},s.initialize=function(c,l,d,h){s.isInitialized()&&$n("Core should not be initialized more than once"),(!c||k(c.instrumentationKey))&&$n("Please provide instrumentation key"),i=h,s[ol]=h,s.config=c||{},c.extensions=k(c.extensions)?[]:c.extensions;var g=Et(c,jc);g.NotificationManager=h,d&&(s.logger=d);var p=[];p.push.apply(p,l.concat(c.extensions)),p=Sd(p);var y=[],v=[],m={};ge(p,function(C){(k(C)||k(C.initialize))&&$n(Fd);var w=C.priority,_=C.identifier;C&&w&&(k(m[w])?m[w]=_:d.warnToConsole("Two extensions have same priority #"+w+" - "+m[w]+", "+_)),!w||w<r.priority?y.push(C):v.push(C)}),p.push(r),y.push(r),p=Sd(p),s._extensions=p,Gc(new hi([r],c,s),p),Gc(new hi(y,c,s),p),s._extensions=y,s.getTransmissionControls().length===0&&$n("No channels available"),e=!0,s.releaseQueue()},s.getTransmissionControls=function(){return r.getChannelControls()},s.track=function(c){Ie(c,yd,s.config.instrumentationKey,null,Zu),Ie(c,"time",tn(new Date),null,Zu),Ie(c,"ver","4.0",null,k),s.isInitialized()?s.getProcessTelContext().processNext(c):n.push(c)},s.getProcessTelContext=function(){var c=s._extensions,l=c;return(!c||c.length===0)&&(l=[r]),new hi(l,s.config,s)},s.getNotifyMgr=function(){return i||(i=Vi({addNotificationListener:function(c){},removeNotificationListener:function(c){},eventsSent:function(c){},eventsDiscarded:function(c,l){},eventsSendRequest:function(c,l){}}),s[ol]=i),i},s.getCookieMgr=function(){return a||(a=Jo(s.config,s.logger)),a},s.setCookieMgr=function(c){a=c},s.getPerfMgr=function(){return o||s.config&&s.config.enablePerfMgr&&(o=new Vc(s.getNotifyMgr())),o},s.setPerfMgr=function(c){o=c},s.eventCnt=function(){return n.length},s.releaseQueue=function(){n.length>0&&(ge(n,function(c){s.getProcessTelContext().processNext(c)}),n=[])}})}return u(t,"t"),t}()}),sl,Nd=L(()=>{je(),kt(),sl=function(){function t(e){this.listeners=[];var n=!!(e||{}).perfEvtsSendAll;Xe(t,this,function(r){r.addNotificationListener=function(i){r.listeners.push(i)},r.removeNotificationListener=function(i){for(var o=jo(r.listeners,i);o>-1;)r.listeners.splice(o,1),o=jo(r.listeners,i)},r.eventsSent=function(i){ge(r.listeners,function(o){o&&o.eventsSent&&setTimeout(function(){return o.eventsSent(i)},0)})},r.eventsDiscarded=function(i,o){ge(r.listeners,function(a){a&&a.eventsDiscarded&&setTimeout(function(){return a.eventsDiscarded(i,o)},0)})},r.eventsSendRequest=function(i,o){ge(r.listeners,function(a){if(a&&a.eventsSendRequest)if(o)setTimeout(function(){return a.eventsSendRequest(i,o)},0);else try{a.eventsSendRequest(i,o)}catch(s){}})},r.perfEvent=function(i){i&&(n||!i.isChildEvt())&&ge(r.listeners,function(o){if(o&&o.perfEvent)if(i.isAsync)setTimeout(function(){return o.perfEvent(i)},0);else try{o.perfEvent(i)}catch(a){}})}})}return u(t,"t"),t}()}),cl,Np=L(()=>{Ne(),Md(),sr(),Nd(),ss(),$c(),je(),kt(),cl=function(t){Te(e,t);function e(){var n=t.call(this)||this;return Xe(e,n,function(r,i){r.initialize=function(s,c,l,d){i.initialize(s,c,l||new Bc(s),d||new sl(s))},r.track=function(s){ro(r.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){s===null&&(a(s),$n("Invalid telemetry item")),o(s),i.track(s)},function(){return{item:s}},!s.sync)},r.addNotificationListener=function(s){var c=r.getNotifyMgr();c&&c.addNotificationListener(s)},r.removeNotificationListener=function(s){var c=r.getNotifyMgr();c&&c.removeNotificationListener(s)},r.pollInternalLogs=function(s){var c=r.config.diagnosticLogInterval;return(!c||!(c>0))&&(c=1e4),setInterval(function(){var l=r.logger?r.logger.queue:[];ge(l,function(d){var h={name:s||"InternalMessageId: "+d.messageId,iKey:r.config.instrumentationKey,time:tn(new Date),baseType:no.dataType,baseData:{message:d.message}};r.track(h)}),l.length=0},c)};function o(s){if(k(s.name))throw a(s),Error("telemetry name required")}u(o,"a");function a(s){var c=r.getNotifyMgr();c&&c.eventsDiscarded([s],Hi.InvalidEvent)}u(a,"o")}),n}return u(e,"e"),e}(al)});function Ld(t){t<0&&(t>>>=0),ao=123456789+t&gr,so=987654321-t&gr,ul=!0}u(Ld,"cs");function Ud(){try{var t=hn()&2147483647;Ld((Math.random()*ll^t)+t)}catch(e){}}u(Ud,"us");function Od(t){return t>0?Math.floor(gi()/gr*(t+1))>>>0:0}u(Od,"oi");function gi(t){var e,n=Ep()||kp();return n&&n.getRandomValues?e=n.getRandomValues(new Uint32Array(1))[0]&gr:es()?(ul||Ud(),e=Hd()&gr):e=Math.floor(ll*Math.random()|0),t||(e>>>=0),e}u(gi,"Tt");function Lp(t){t?Ld(t):Ud()}u(Lp,"Ca");function Hd(t){so=36969*(so&65535)+(so>>16)&gr,ao=18e3*(ao&65535)+(ao>>16)&gr;var e=(so<<16)+(ao&65535)>>>0&gr|0;return t||(e>>>=0),e}u(Hd,"si");var ll,gr,ul,ao,so,Wd=L(()=>{Qo(),kt(),ll=4294967296,gr=4294967295,ul=!1,ao=123456789,so=987654321});function pi(t,e){var n=!1,r=Ko();r&&(n=Ge(r,t,e),n=Ge(r.body,t,e)||n);var i=Vn();return i&&(n=ta.Attach(i,t,e)||n),n}u(pi,"Ut");function Up(){function t(){return Od(15)}return u(t,"t"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace($d,function(e){var n=t()|0,r=e==="x"?n:n&3|8;return r.toString(16)})}u(Up,"ls");function Op(){var t=hr();return t&&t.now?t.now():hn()}u(Op,"fs");function ps(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=gi()>>>0,r=0,i="";i.length<t;)r++,i+=e.charAt(n&63),n>>>=6,r===5&&(n=(gi()<<2&4294967295|n&3)>>>0,r=0);return i}u(ps,"Xt");function zn(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e="",n,r=0;r<4;r++)n=gi(),e+=t[n&15]+t[n>>4&15]+t[n>>8&15]+t[n>>12&15]+t[n>>16&15]+t[n>>20&15]+t[n>>24&15]+t[n>>28&15];var i=t[8+(gi()&3)|0];return e.substr(0,8)+e.substr(9,4)+"4"+e.substr(13,3)+i+e.substr(16,3)+e.substr(19,12)}u(zn,"He");function co(t,e){var n=Ed(t,e),r=vs._canUseCookies;return lo===null&&(lo=[],ea=r,eo(vs,"_canUseCookies",function(){return ea},function(i){ea=i,ge(lo,function(o){o.setEnabled(i)})})),jo(lo,n)===-1&&lo.push(n),Zi(r)&&n.setEnabled(r),Zi(ea)&&n.setEnabled(ea),n}u(co,"Zt");function Bd(){co().setEnabled(!1)}u(Bd,"ci");function Hp(t){return co(null,t).isEnabled()}u(Hp,"Ta");function Wp(t,e){return co(null,t).get(e)}u(Wp,"Ea");function Bp(t,e,n,r){co(null,t).set(e,n,null,r)}u(Bp,"wa");function $p(t,e){return co(null,t).del(e)}u($p,"Pa");var lo,ea,vs,$d,ta,Vp=L(()=>{Ne(),il(),Qo(),kt(),Wd(),lo=null,vs={_canUseCookies:void 0,isTypeof:b,isUndefined:I,isNullOrUndefined:k,hasOwnProperty:Le,isFunction:re,isObject:le,isDate:It,isArray:Ye,isError:en,isString:ae,isNumber:kn,isBoolean:Zi,toISOString:tn,arrForEach:ge,arrIndexOf:jo,arrMap:Go,arrReduce:Yu,strTrim:Ct,objCreate:Vi,objKeys:li,objDefineAccessors:eo,addEventHandler:pi,dateNow:hn,isIE:es,disableCookies:Bd,newGuid:Up,perfNow:Op,newId:ps,randomValue:Od,random32:gi,mwcRandomSeed:Lp,mwcRandom32:Hd,generateW3CId:zn},$d=/[xy]/g,ta={Attach:Ge,AttachEvent:Ge,Detach:ot,DetachEvent:ot}});function dl(t,e){if(t)for(var n=0;n<t.length&&!e(t[n],n);n++);}u(dl,"ba");function hl(t,e,n,r,i){i>=0&&i<=2&&dl(t,function(o,a){var s=o.cbks,c=s[pl[i]];if(c){e.ctx=function(){var h=r[a]=r[a]||{};return h};try{c.apply(e.inst,n)}catch(h){var l=e.err;try{var d=s[pl[2]];d&&(e.err=h,d.apply(e.inst,n))}catch(g){}finally{e.err=l}}}})}u(hl,"Da");function qp(t){return function(){var e=this,n=arguments,r=t.h,i={name:t.n,inst:e,ctx:null,set:c},o=[],a=s([i],n);function s(d,h){return dl(h,function(g){d.push(g)}),d}u(s,"c");function c(d,h){n=s([],n),n[d]=h,a=s([i],n)}u(c,"s"),hl(r,i,a,o,0);var l=t.f;try{i.rslt=l.apply(e,n)}catch(d){throw i.err=d,hl(r,i,a,o,3),d}return hl(r,i,a,o,1),i.rslt}}u(qp,"al");function zp(t){if(t){if(vl)return vl(t);var e=t[qd]||t[Ft]||t[zd];if(e)return e}return null}u(zp,"ol");function Vd(t,e,n){var r=null;return t&&(Le(t,e)?r=t:n&&(r=Vd(zp(t),e,!1))),r}u(Vd,"vs");function jp(t,e,n){return t?fl(t[Ft],e,n,!1):null}u(jp,"Aa");function fl(t,e,n,r){if(r===void 0&&(r=!0),t&&e&&n){var i=Vd(t,e,r);if(i){var o=i[e];if(typeof o===Nr){var a=o[gl];if(!a){a={i:0,n:e,f:o,h:[]};var s=qp(a);s[gl]=a,i[e]=s}var c={id:a.i,cbks:n,rm:function(){var l=this.id;dl(a.h,function(d,h){if(d.id===l)return a.h.splice(h,1),1})}};return a.i++,a.h.push(c),c}}}return null}u(fl,"un");var gl,pl,qd,zd,vl,Gp=L(()=>{Ne(),kt(),gl="_aiHooks",pl=["req","rsp","hkErr","fnErr"],qd="__proto__",zd="constructor",vl=Object.getPrototypeOf}),be=L(()=>{Np(),Md(),bd(),Wd(),Vp(),kt(),Qo(),Ne(),Nd(),ss(),$c(),Yi(),Gp(),il()}),Be,jd=L(()=>{Be={requestContextHeader:"Request-Context",requestContextTargetKey:"appId",requestContextAppIdFormat:"appId=cid-v1:",requestIdHeader:"Request-Id",traceParentHeader:"traceparent",traceStateHeader:"tracestate",sdkContextHeader:"Sdk-Context",sdkContextHeaderAppIdRequest:"appId",requestContextHeaderLowerCase:"request-context"}});function ml(t,e,n){var r=e.length,i=Gd(t,e);if(i.length!==r){for(var o=0,a=i;n[a]!==void 0;)o++,a=i.substring(0,150-3)+Xd(o);i=a}return i}u(ml,"ui");function Gd(t,e){var n;return e&&(e=Ct(e.toString()),e.length>150&&(n=e.substring(0,150),t.throwInternal(q.WARNING,B.NameTooLong,"name is too long.  It has been truncated to "+150+" characters.",{name:e},!0))),n||e}u(Gd,"Fa");function Nt(t,e,n){n===void 0&&(n=1024);var r;return e&&(n=n||1024,e=Ct(e),e.toString().length>n&&(r=e.toString().substring(0,n),t.throwInternal(q.WARNING,B.StringValueTooLong,"string value is too long. It has been truncated to "+n+" characters.",{value:e},!0))),r||e}u(Nt,"ae");function na(t,e){return yl(t,e,2048,B.UrlTooLong)}u(na,"Et");function wl(t,e){var n;return e&&e.length>32768&&(n=e.substring(0,32768),t.throwInternal(q.WARNING,B.MessageTruncated,"message is too long, it has been truncated to "+32768+" characters.",{message:e},!0)),n||e}u(wl,"Fr");function Kd(t,e){var n;if(e){var r=""+e;r.length>32768&&(n=r.substring(0,32768),t.throwInternal(q.WARNING,B.ExceptionTruncated,"exception is too long, it has been truncated to "+32768+" characters.",{exception:e},!0))}return n||e}u(Kd,"li");function Br(t,e){if(e){var n={};Ee(e,function(r,i){if(le(i)&&to())try{i=Rn().stringify(i)}catch(o){t.throwInternal(q.WARNING,B.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:o},!0)}i=Nt(t,i,8192),r=ml(t,r,n),n[r]=i}),e=n}return e}u(Br,"je");function $r(t,e){if(e){var n={};Ee(e,function(r,i){r=ml(t,r,n),n[r]=i}),e=n}return e}u($r,"Be");function Qd(t,e){return e&&yl(t,e,128,B.IdTooLong).toString()}u(Qd,"fi");function yl(t,e,n,r){var i;return e&&(e=Ct(e),e.length>n&&(i=e.substring(0,n),t.throwInternal(q.WARNING,r,"input is too long, it has been truncated to "+n+" characters.",{data:e},!0))),i||e}u(yl,"pi");function Xd(t){var e="00"+t;return e.substr(e.length-3)}u(Xd,"ka");var Jd,Dn=L(()=>{be(),Jd={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768,sanitizeKeyAndAddUniqueness:ml,sanitizeKey:Gd,sanitizeString:Nt,sanitizeUrl:na,sanitizeMessage:wl,sanitizeException:Kd,sanitizeProperties:Br,sanitizeMeasurements:$r,sanitizeId:Qd,sanitizeInput:yl,padNumber:Xd,trim:Ct}});function uo(t){var e=null;if(re(Event))e=new Event(t);else{var n=Vn();n&&n.createEvent&&(e=n.createEvent("Event"),e.initEvent(t,!0,!0))}return e}u(uo,"_t");var Yd=L(()=>{be()});function Ue(t,e){return e===void 0&&(e=!1),t==null?e:t.toString().toLowerCase()==="true"}u(Ue,"ee");function pr(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=""+t%1e3,n=""+Math.floor(t/1e3)%60,r=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,o=Math.floor(t/(1e3*60*60*24));return e=e.length===1?"00"+e:e.length===2?"0"+e:e,n=n.length<2?"0"+n:n,r=r.length<2?"0"+r:r,i=i.length<2?"0"+i:i,(o>0?o+".":"")+i+":"+r+":"+n+"."+e}u(pr,"Ke");function Cl(){var t=qn();return"sendBeacon"in t&&t.sendBeacon}u(Cl,"kr");function Zd(t,e){var n=null;return ge(t,function(r){if(r.identifier===e)return n=r,-1}),n}u(Zd,"ln");function eh(t,e,n,r,i){return!i&&ae(t)&&(t==="Script error."||t==="Script error")}u(eh,"fn");var ms=L(()=>{be()}),vi,ws,ho,ys,bl,gn,Tn=L(()=>{vi="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ws="sampleRate",ho="ProcessLegacy",ys="http.method",bl="https://dc.services.visualstudio.com",gn="not_specified"}),mi,An,th=L(()=>{(function(t){t[t.LocalStorage=0]="LocalStorage",t[t.SessionStorage=1]="SessionStorage"})(mi||(mi={})),function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C",t[t.W3C=2]="W3C"}(An||(An={}))});function Sl(){return xl()?Cs(mi.LocalStorage):null}u(Sl,"Ua");function Cs(t){try{if(k(Lr()))return null;var e=new Date,n=Rt(t===mi.LocalStorage?"localStorage":"sessionStorage");n.setItem(e.toString(),e.toString());var r=n.getItem(e.toString())!==e.toString();if(n.removeItem(e.toString()),!r)return n}catch(i){}return null}u(Cs,"di");function _l(){return fo()?Cs(mi.SessionStorage):null}u(_l,"_a");function nh(){Vr=!1,qr=!1}u(nh,"mn");function xl(){return Vr===void 0&&(Vr=!!Cs(mi.LocalStorage)),Vr}u(xl,"Mr");function rh(t,e){var n=Sl();if(n!==null)try{return n.getItem(e)}catch(r){Vr=!1,t.throwInternal(q.WARNING,B.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+Ae(r),{exception:me(r)})}return null}u(rh,"gn");function ih(t,e,n){var r=Sl();if(r!==null)try{return r.setItem(e,n),!0}catch(i){Vr=!1,t.throwInternal(q.WARNING,B.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+Ae(i),{exception:me(i)})}return!1}u(ih,"vn");function oh(t,e){var n=Sl();if(n!==null)try{return n.removeItem(e),!0}catch(r){Vr=!1,t.throwInternal(q.WARNING,B.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+Ae(r),{exception:me(r)})}return!1}u(oh,"hn");function fo(){return qr===void 0&&(qr=!!Cs(mi.SessionStorage)),qr}u(fo,"Pt");function Kp(){var t=[];return fo()&&Ee(Rt("sessionStorage"),function(e){t.push(e)}),t}u(Kp,"Oa");function bs(t,e){var n=_l();if(n!==null)try{return n.getItem(e)}catch(r){qr=!1,t.throwInternal(q.WARNING,B.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+Ae(r),{exception:me(r)})}return null}u(bs,"Yt");function Ss(t,e,n){var r=_l();if(r!==null)try{return r.setItem(e,n),!0}catch(i){qr=!1,t.throwInternal(q.WARNING,B.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+Ae(i),{exception:me(i)})}return!1}u(Ss,"er");function ah(t,e){var n=_l();if(n!==null)try{return n.removeItem(e),!0}catch(r){qr=!1,t.throwInternal(q.WARNING,B.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+Ae(r),{exception:me(r)})}return!1}u(ah,"xn");var Vr,qr,sh=L(()=>{be(),th(),Vr=void 0,qr=void 0});function ra(t){var e=kl,n=dh,r=n[e];return El.createElement?n[e]||(r=n[e]=El.createElement("a")):r={host:uh(t,!0)},r.href=t,e++,e>=n.length&&(e=0),kl=e,r}u(ra,"gr");function ch(t){var e,n=ra(t);return n&&(e=n.href),e}u(ch,"yn");function Qp(t){var e,n=ra(t);return n&&(e=n.pathname),e}u(Qp,"Ha");function lh(t,e){return t?t.toUpperCase()+" "+e:e}u(lh,"Sn");function uh(t,e){var n=Il(t,e)||"";if(n){var r=n.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(r!=null&&r.length>3&&ae(r[2])&&r[2].length>0)return r[2]+(r[3]||"")}return n}u(uh,"mi");function Il(t,e){var n=null;if(t){var r=t.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(r!=null&&r.length>2&&ae(r[2])&&r[2].length>0&&(n=r[2]||"",e&&r.length>2)){var i=(r[1]||"").toLowerCase(),o=r[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),n+=o}}return n}u(Il,"Cn");var El,kl,dh,hh=L(()=>{be(),El=Vn()||{},kl=0,dh=[null,null,null,null,null]});function _s(t){return fh.indexOf(t.toLowerCase())!==-1}u(_s,"Lr");function Xp(t,e,n,r){var i,o=r,a=r;if(e&&e.length>0){var s=ra(e);if(i=s.host,!o)if(s.pathname!=null){var c=s.pathname.length===0?"/":s.pathname;c.charAt(0)!=="/"&&(c="/"+c),a=s.pathname,o=Nt(t,n?n+" "+c:c)}else o=Nt(t,e)}else i=r,o=r;return{target:i,name:o,data:a}}u(Xp,"Ss");function ia(){var t=hr();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return hn()}u(ia,"vr");function Lt(t,e){var n=null;return t!==0&&e!==0&&!k(t)&&!k(e)&&(n=e-t),n}u(Lt,"he");var fh,Rl,gh,zr,ph,vh=L(()=>{be(),jd(),Dn(),Yd(),ms(),Tn(),sh(),hh(),fh=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],Rl={NotSpecified:gn,createDomEvent:uo,disableStorage:nh,isInternalApplicationInsightsEndpoint:_s,canUseLocalStorage:xl,getStorage:rh,setStorage:ih,removeStorage:oh,canUseSessionStorage:fo,getSessionStorageKeys:Kp,getSessionStorage:bs,setSessionStorage:Ss,removeSessionStorage:ah,disableCookies:Bd,canUseCookies:Hp,disallowsSameSiteNone:Pd,setCookie:Bp,stringToBoolOrDefault:Ue,getCookie:Wp,deleteCookie:$p,trim:Ct,newId:ps,random32:function(){return gi(!0)},generateW3CId:zn,isArray:Ye,isError:en,isDate:It,toISOStringForIE8:tn,getIEVersion:Oc,msToTimeSpan:pr,isCrossOriginError:eh,dump:me,getExceptionName:Ae,addEventHandler:Ge,IsBeaconApiSupported:Cl,getExtension:Zd},gh={parseUrl:ra,getAbsoluteUrl:ch,getPathName:Qp,getCompleteUrl:lh,parseHost:uh,parseFullHost:Il},zr={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(t,e,n){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t.correlationHeaderExcludePatterns){for(var r=0;r<t.correlationHeaderExcludePatterns.length;r++)if(t.correlationHeaderExcludePatterns[r].test(e))return!1}var i=ra(e).host.toLowerCase();if(i&&(i.indexOf(":443")!==-1||i.indexOf(":80")!==-1)&&(i=(Il(e,!0)||"").toLowerCase()),(!t||!t.enableCorsCorrelation)&&i&&i!==n)return!1;var o=t&&t.correlationHeaderDomains;if(o){var a;if(ge(o,function(l){var d=new RegExp(l.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(i)}),!a)return!1}var s=t&&t.correlationHeaderExcludedDomains;if(!s||s.length===0)return!0;for(var r=0;r<s.length;r++){var c=new RegExp(s[r].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(c.test(i))return!1}return i&&i.length>0},getCorrelationContext:function(t){if(t){var e=zr.getCorrelationContextValue(t,Be.requestContextTargetKey);if(e&&e!==zr.correlationIdPrefix)return e}},getCorrelationContextValue:function(t,e){if(t)for(var n=t.split(","),r=0;r<n.length;++r){var i=n[r].split("=");if(i.length===2&&i[0]===e)return i[1]}}},ph={Now:ia,GetDuration:Lt}});function mh(t){if(!t)return{};var e=t.split(wh),n=Yu(e,function(i,o){var a=o.split(yh);if(a.length===2){var s=a[0].toLowerCase(),c=a[1];i[s]=c}return i},{});if(li(n).length>0){if(n.endpointsuffix){var r=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+r+"dc."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||bl}return n}u(mh,"gi");var wh,yh,Ch,Jp=L(()=>{Tn(),be(),wh=";",yh="=",Ch={parse:mh}}),Dl,bh=L(()=>{Dl=function(){function t(){}return u(t,"t"),t}()}),Tl,Sh=L(()=>{Ne(),bh(),Tl=function(t){Te(e,t);function e(){return t.call(this)||this}return u(e,"e"),e}(Dl)}),_h,Yp=L(()=>{_h=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return u(t,"t"),t}()}),Al,Zp=L(()=>{Ne(),Yp(),Dn(),be(),Tn(),Al=function(t){Te(e,t);function e(n,r,i){var o=t.call(this)||this;return o.name=Nt(n,i)||gn,o.data=r,o.time=tn(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1},o}return u(e,"e"),e}(_h)}),Pl,xh=L(()=>{Pl=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return u(t,"t"),t}()}),Pn,ev=L(()=>{Ne(),xh(),Dn(),Tn(),Pn=function(t){Te(e,t);function e(n,r,i,o){var a=t.call(this)||this;return a.aiDataContract={ver:1,name:1,properties:0,measurements:0},a.name=Nt(n,r)||gn,a.properties=Br(n,i),a.measurements=$r(n,o),a}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}(Pl)}),Ih,tv=L(()=>{Ih=function(){function t(){}return u(t,"t"),t}()}),Eh,nv=L(()=>{Eh=function(){function t(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}}return u(t,"t"),t}()}),kh,rv=L(()=>{kh=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return u(t,"t"),t}()});function Fl(t,e){var n=t;return n&&!ae(n)&&(JSON&&JSON.stringify?(n=JSON.stringify(t),e&&(!n||n==="{}")&&(re(t.toString)?n=t.toString():n=""+t)):n=""+t+" - (Missing JSON.stringify)"),n||""}u(Fl,"Za");function Rh(t,e){var n=t;return t&&(n=t[Es]||t[Ll]||"",n&&!ae(n)&&(n=Fl(n,!0)),t.filename&&(n=n+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(n||"").indexOf(e)===-1&&(n=e+": "+n),n||""}u(Rh,"Ms");function iv(t){return le(t)?"hasFullStack"in t&&"typeName"in t:!1}u(iv,"pl");function ov(t){return le(t)?"ver"in t&&"exceptions"in t&&"properties"in t:!1}u(ov,"dl");function Dh(t){return t&&t.src&&ae(t.src)&&t.obj&&Ye(t.obj)}u(Dh,"Ls");function go(t){var e=t||"";ae(e)||(ae(e[nn])?e=e[nn]:e=""+e);var n=e.split(`
`);return{src:e,obj:n}}u(go,"_r");function av(t){for(var e=[],n=t.split(`
`),r=0;r<n.length;r++){var i=n[r];n[r+1]&&(i+="@"+n[r+1],r++),e.push(i)}return{src:t,obj:e}}u(av,"ml");function Th(t){var e=null;if(t)try{if(t[nn])e=go(t[nn]);else if(t[wi]&&t[wi][nn])e=go(t[wi][nn]);else if(t.exception&&t.exception[nn])e=go(t.exception[nn]);else if(Dh(t))e=t;else if(Dh(t[Is]))e=t[Is];else if(window.opera&&t[Es])e=av(t.message);else if(ae(t))e=go(t);else{var n=t[Es]||t[Ll]||"";ae(t[Nl])&&(n&&(n+=`
`),n+=" from "+t[Nl]),n&&(e=go(n))}}catch(r){e=go(r)}return e||{src:"",obj:null}}u(Th,"Us");function sv(t){var e="";return t&&(t.obj?ge(t.obj,function(n){e+=n+`
`}):e=t.src||""),e}u(sv,"gl");function cv(t){var e,n=t.obj;if(n&&n.length>0){e=[];var r=0,i=0;ge(n,function(y){var v=y.toString();if(ks.regex.test(v)){var m=new ks(v,r++);i+=m.sizeInBytes,e.push(m)}});var o=32*1024;if(i>o)for(var a=0,s=e.length-1,c=0,l=a,d=s;a<s;){var h=e[a].sizeInBytes,g=e[s].sizeInBytes;if(c+=h+g,c>o){var p=d-l+1;e.splice(l,p);break}l=a,d=s,a++,s--}}return e}u(cv,"vl");function xs(t){var e="";if(t&&(e=t.typeName||t.name||"",!e))try{var n=/function (.{1,200})\(/,r=n.exec(t.constructor.toString());e=r&&r.length>1?r[1]:""}catch(i){}return e}u(xs,"hi");function Ml(t){if(t)try{if(!ae(t)){var e=xs(t),n=Fl(t,!1);return(!n||n==="{}")&&(t[wi]&&(t=t[wi],e=xs(t)),n=Fl(t,!0)),n.indexOf(e)!==0&&e!=="String"?e+":"+n:n}}catch(r){}return""+(t||"")}u(Ml,"$a");var Ah,wi,nn,Is,Nl,Es,Ll,Ut,Ul,ks,lv=L(()=>{Ne(),tv(),nv(),rv(),Dn(),be(),Tn(),Ah="<no_method>",wi="error",nn="stack",Is="stackDetails",Nl="errorSrc",Es="message",Ll="description",Ut=function(t){Te(e,t);function e(n,r,i,o,a,s){var c=t.call(this)||this;return c.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},ov(r)?(c.exceptions=r.exceptions,c.properties=r.properties,c.measurements=r.measurements,r.severityLevel&&(c.severityLevel=r.severityLevel),r.id&&(c.id=r.id),r.problemGroup&&(c.problemGroup=r.problemGroup),c.ver=2,k(r.isManual)||(c.isManual=r.isManual)):(i||(i={}),c.exceptions=[new Ul(n,r,i)],c.properties=Br(n,i),c.measurements=$r(n,o),a&&(c.severityLevel=a),s&&(c.id=s)),c}return u(e,"e"),e.CreateAutoException=function(n,r,i,o,a,s,c,l){var d=xs(a||s||n);return{message:Rh(n,d),url:r,lineNumber:i,columnNumber:o,error:Ml(a||s||n),evt:Ml(s||n),typeName:d,stackDetails:Th(c||a||s),errorSrc:l}},e.CreateFromInterface=function(n,r,i,o){var a=r.exceptions&&Go(r.exceptions,function(c){return Ul.CreateFromInterface(n,c)}),s=new e(n,Mt({},r,{exceptions:a}),i,o);return s},e.prototype.toInterface=function(){var n=this,r=n.exceptions,i=n.properties,o=n.measurements,a=n.severityLevel,s=n.ver,c=n.problemGroup,l=n.id,d=n.isManual,h=r instanceof Array&&Go(r,function(g){return g.toInterface()})||void 0;return{ver:"4.0",exceptions:h,severityLevel:a,properties:i,measurements:o,problemGroup:c,id:l,isManual:d}},e.CreateSimpleException=function(n,r,i,o,a,s){return{exceptions:[{hasFullStack:!0,message:n,stack:a,typeName:r}]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=Ml,e}(Eh),Ul=function(t){Te(e,t);function e(n,r,i){var o=t.call(this)||this;if(o.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},iv(r))o.typeName=r.typeName,o.message=r.message,o[nn]=r[nn],o.parsedStack=r.parsedStack,o.hasFullStack=r.hasFullStack;else{var a=r,s=a&&a.evt;en(a)||(a=a[wi]||s||a),o.typeName=Nt(n,xs(a))||gn,o.message=wl(n,Rh(r||a,o.typeName))||gn;var c=r[Is]||Th(r);o.parsedStack=cv(c),o[nn]=Kd(n,sv(c)),o.hasFullStack=Ye(o.parsedStack)&&o.parsedStack.length>0,i&&(i.typeName=i.typeName||o.typeName)}return o}return u(e,"e"),e.prototype.toInterface=function(){var n=this.parsedStack instanceof Array&&Go(this.parsedStack,function(i){return i.toInterface()}),r={id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this[nn],parsedStack:n||void 0};return r},e.CreateFromInterface=function(n,r){var i=r.parsedStack instanceof Array&&Go(r.parsedStack,function(a){return ks.CreateFromInterface(a)})||r.parsedStack,o=new e(n,Mt({},r,{parsedStack:i}));return o},e}(kh),ks=function(t){Te(e,t);function e(n,r){var i=t.call(this)||this;if(i.sizeInBytes=0,i.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},typeof n=="string"){var o=n;i.level=r,i.method=Ah,i.assembly=Ct(o),i.fileName="",i.line=0;var a=o.match(e.regex);a&&a.length>=5&&(i.method=Ct(a[2])||i.method,i.fileName=Ct(a[4]),i.line=parseInt(a[5])||0)}else i.level=n.level,i.method=n.method,i.assembly=n.assembly,i.fileName=n.fileName,i.line=n.line,i.sizeInBytes=0;return i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=e.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}return u(e,"e"),e.CreateFromInterface=function(n){return new e(n,null)},e.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}(Ih)}),Ph,uv=L(()=>{Ph=function(){function t(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}}return u(t,"t"),t}()}),Ol,dv=L(()=>{(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(Ol||(Ol={}))}),Fh,hv=L(()=>{dv(),Fh=function(){function t(){this.kind=Ol.Measurement}return u(t,"t"),t}()}),Mh,fv=L(()=>{Ne(),hv(),Mh=function(t){Te(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},n}return u(e,"e"),e}(Fh)}),jn,gv=L(()=>{Ne(),uv(),Dn(),fv(),Tn(),jn=function(t){Te(e,t);function e(n,r,i,o,a,s,c,l){var d=t.call(this)||this;d.aiDataContract={ver:1,metrics:1,properties:0};var h=new Mh;return h.count=o>0?o:void 0,h.max=isNaN(s)||s===null?void 0:s,h.min=isNaN(a)||a===null?void 0:a,h.name=Nt(n,r)||gn,h.value=i,d.metrics=[h],d.properties=Br(n,c),d.measurements=$r(n,l),d}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}(Ph)}),Rs,Hl=L(()=>{Ne(),xh(),Rs=function(t){Te(e,t);function e(){var n=t.call(this)||this;return n.ver=2,n.properties={},n.measurements={},n}return u(e,"e"),e}(Pl)}),Fn,pv=L(()=>{Ne(),Hl(),Dn(),ms(),Tn(),Fn=function(t){Te(e,t);function e(n,r,i,o,a,s,c){var l=t.call(this)||this;return l.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},l.id=Qd(n,c),l.url=na(n,i),l.name=Nt(n,r)||gn,isNaN(o)||(l.duration=pr(o)),l.properties=Br(n,a),l.measurements=$r(n,s),l}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}(Rs)}),Nh,vv=L(()=>{Nh=function(){function t(){this.ver=2,this.success=!0,this.properties={},this.measurements={}}return u(t,"t"),t}()}),Gn,mv=L(()=>{Ne(),Dn(),vh(),vv(),ms(),Gn=function(t){Te(e,t);function e(n,r,i,o,a,s,c,l,d,h,g,p){d===void 0&&(d="Ajax");var y=t.call(this)||this;y.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},y.id=r,y.duration=pr(a),y.success=s,y.resultCode=c+"",y.type=Nt(n,d);var v=Xp(n,i,l,o);return y.data=na(n,o)||v.data,y.target=Nt(n,v.target),h&&(y.target=y.target+" | "+h),y.name=Nt(n,v.name),y.properties=Br(n,g),y.measurements=$r(n,p),y}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}(Nh)}),Lh,wv=L(()=>{Lh=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return u(t,"t"),t}()}),vr,yv=L(()=>{Ne(),wv(),Dn(),Tn(),vr=function(t){Te(e,t);function e(n,r,i,o,a){var s=t.call(this)||this;return s.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},r=r||gn,s.message=wl(n,r),s.properties=Br(n,o),s.measurements=$r(n,a),i&&(s.severityLevel=i),s}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}(Lh)}),Uh,Cv=L(()=>{Ne(),Hl(),Uh=function(t){Te(e,t);function e(){var n=t.call(this)||this;return n.ver=2,n.properties={},n.measurements={},n}return u(e,"e"),e}(Rs)}),mr,bv=L(()=>{Ne(),Cv(),Dn(),Tn(),mr=function(t){Te(e,t);function e(n,r,i,o,a,s,c){var l=t.call(this)||this;return l.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},l.url=na(n,i),l.name=Nt(n,r)||gn,l.properties=Br(n,a),l.measurements=$r(n,s),c&&(l.domProcessing=c.domProcessing,l.duration=c.duration,l.networkConnect=c.networkConnect,l.perfTotal=c.perfTotal,l.receivedResponse=c.receivedResponse,l.sentRequest=c.sentRequest),l}return u(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}(Uh)}),wr,Sv=L(()=>{Ne(),Sh(),wr=function(t){Te(e,t);function e(n,r){var i=t.call(this)||this;return i.aiDataContract={baseType:1,baseData:1},i.baseType=n,i.baseData=r,i}return u(e,"e"),e}(Tl)}),oa,_v=L(()=>{(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(oa||(oa={}))}),Oh,xv=L(()=>{be(),Oh=function(){function t(){}return u(t,"t"),t.getConfig=function(e,n,r,i){i===void 0&&(i=!1);var o;return r&&e.extensionConfig&&e.extensionConfig[r]&&!k(e.extensionConfig[r][n])?o=e.extensionConfig[r][n]:o=e[n],k(o)?i:o},t}()});function jr(t){var e="ai."+t+".";return function(n){return e+n}}u(jr,"tr");var po,at,aa,yi,Ds,yr,Gr,vo,Ts,Hh=L(()=>{Ne(),be(),po=jr("application"),at=jr("device"),aa=jr("location"),yi=jr("operation"),Ds=jr("session"),yr=jr("user"),Gr=jr("cloud"),vo=jr("internal"),Ts=function(t){Te(e,t);function e(){return t.call(this)||this}return u(e,"e"),e}(yp({applicationVersion:po("ver"),applicationBuild:po("build"),applicationTypeId:po("typeId"),applicationId:po("applicationId"),applicationLayer:po("layer"),deviceId:at("id"),deviceIp:at("ip"),deviceLanguage:at("language"),deviceLocale:at("locale"),deviceModel:at("model"),deviceFriendlyName:at("friendlyName"),deviceNetwork:at("network"),deviceNetworkName:at("networkName"),deviceOEMName:at("oemName"),deviceOS:at("os"),deviceOSVersion:at("osVersion"),deviceRoleInstance:at("roleInstance"),deviceRoleName:at("roleName"),deviceScreenResolution:at("screenResolution"),deviceType:at("type"),deviceMachineName:at("machineName"),deviceVMName:at("vmName"),deviceBrowser:at("browser"),deviceBrowserVersion:at("browserVersion"),locationIp:aa("ip"),locationCountry:aa("country"),locationProvince:aa("province"),locationCity:aa("city"),operationId:yi("id"),operationName:yi("name"),operationParentId:yi("parentId"),operationRootId:yi("rootId"),operationSyntheticSource:yi("syntheticSource"),operationCorrelationVector:yi("correlationVector"),sessionId:Ds("id"),sessionIsFirst:Ds("isFirst"),sessionIsNew:Ds("isNew"),userAccountAcquisitionDate:yr("accountAcquisitionDate"),userAccountId:yr("accountId"),userAgent:yr("userAgent"),userId:yr("id"),userStoreRegion:yr("storeRegion"),userAuthUserId:yr("authUserId"),userAnonymousUserAcquisitionDate:yr("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:yr("authUserAcquisitionDate"),cloudName:Gr("name"),cloudRole:Gr("role"),cloudRoleVer:Gr("roleVer"),cloudRoleInstance:Gr("roleInstance"),cloudEnvironment:Gr("environment"),cloudLocation:Gr("location"),cloudDeploymentUnit:Gr("deploymentUnit"),internalNodeName:vo("nodeName"),internalSdkVersion:vo("sdkVersion"),internalAgentVersion:vo("agentVersion"),internalSnippet:vo("snippet"),internalSdkSrc:vo("sdkSrc")}))}),Kn,Iv=L(()=>{Dn(),be(),Tn(),Kn=function(){function t(){}return u(t,"t"),t.create=function(e,n,r,i,o,a){if(r=Nt(i,r)||gn,k(e)||k(n)||k(r))throw Error("Input doesn't contain all required fields");var s={name:r,time:tn(new Date),iKey:"",ext:a||{},tags:[],data:{},baseType:n,baseData:e};return k(o)||Ee(o,function(c,l){s.data[c]=l}),s},t}()}),Ot,He,Ev=L(()=>{Hh(),Ot={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},He=new Ts}),mo,As,Wl,ft=L(()=>{vh(),Jp(),jd(),Tn(),Sh(),bh(),Zp(),ev(),lv(),gv(),pv(),Hl(),mv(),yv(),bv(),Sv(),_v(),xv(),Hh(),Dn(),Iv(),Ev(),th(),ms(),Yd(),sh(),hh(),mo="AppInsightsPropertiesPlugin",As="AppInsightsChannelPlugin",Wl="ApplicationInsightsAnalytics"}),Wh,kv=L(()=>{ft(),be(),je(),Wh=function(){function t(e,n,r,i){Xe(t,this,function(o){var a=null,s=[],c=!1,l;r&&(l=r.logger);function d(){r&&ge(r.getTransmissionControls(),function(g){ge(g,function(p){return p.flush(!0)})})}u(d,"l");function h(g){s.push(g),a||(a=setInterval(function(){var p=s.slice(0),y=!1;s=[],ge(p,function(v){v()?y=!0:s.push(v)}),s.length===0&&(clearInterval(a),a=null),y&&d()},100))}u(h,"f"),o.trackPageView=function(g,p){var y=g.name;if(k(y)||typeof y!="string"){var v=Vn();y=g.name=v&&v.title||""}var m=g.uri;if(k(m)||typeof m!="string"){var C=ui();m=g.uri=C&&C.href||""}if(!i.isPerformanceTimingSupported()){e.sendPageViewInternal(g,p),d(),l.throwInternal(q.WARNING,B.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var w=!1,_,E=i.getPerformanceTiming().navigationStart;E>0&&(_=Lt(E,+new Date),i.shouldCollectDuration(_)||(_=void 0));var x;!k(p)&&!k(p.duration)&&(x=p.duration),(n||!isNaN(x))&&(isNaN(x)&&(p||(p={}),p.duration=_),e.sendPageViewInternal(g,p),d(),w=!0);var T=6e4;p||(p={}),h(function(){var W=!1;try{if(i.isPerformanceTimingDataReady()){W=!0;var F={name:y,uri:m};i.populatePageViewPerformanceEvent(F),!F.isValid&&!w?(p.duration=_,e.sendPageViewInternal(g,p)):(w||(p.duration=F.durationMs,e.sendPageViewInternal(g,p)),c||(e.sendPageViewPerformanceInternal(F,p),c=!0))}else E>0&&Lt(E,+new Date)>T&&(W=!0,w||(p.duration=T,e.sendPageViewInternal(g,p)))}catch(G){l.throwInternal(q.CRITICAL,B.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+Ae(G),{exception:me(G)})}return W})}})}return u(t,"t"),t}()}),Bh,$h,Rv=L(()=>{ft(),be(),Bh=function(){function t(e,n){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=n,this._logger=e}return u(t,"t"),t.prototype.trackPreviousPageVisit=function(e,n){try{var r=this.restartPageVisitTimer(e,n);r&&this.pageVisitTimeTrackingHandler(r.pageName,r.pageUrl,r.pageVisitTime)}catch(i){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+me(i))}},t.prototype.restartPageVisitTimer=function(e,n){try{var r=this.stopPageVisitTimer();return this.startPageVisitTimer(e,n),r}catch(i){return this._logger.warnToConsole("Call to restart failed: "+me(i)),null}},t.prototype.startPageVisitTimer=function(e,n){try{if(fo()){bs(this._logger,this.prevPageVisitDataKeyName)!=null&&$n("Cannot call startPageVisit consecutively without first calling stopPageVisit");var r=new $h(e,n),i=Rn().stringify(r);Ss(this._logger,this.prevPageVisitDataKeyName,i)}}catch(o){this._logger.warnToConsole("Call to start failed: "+me(o))}},t.prototype.stopPageVisitTimer=function(){try{if(fo()){var e=hn(),n=bs(this._logger,this.prevPageVisitDataKeyName);if(n&&to()){var r=Rn().parse(n);return r.pageVisitTime=e-r.pageVisitStartTime,ah(this._logger,this.prevPageVisitDataKeyName),r}else return null}return null}catch(i){return this._logger.warnToConsole("Stop page visit timer failed: "+me(i)),null}},t}(),$h=function(){function t(e,n){this.pageVisitStartTime=hn(),this.pageName=e,this.pageUrl=n}return u(t,"t"),t}()}),Vh,Dv=L(()=>{ft(),be(),Vh=function(){function t(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return u(t,"t"),t.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var n=this.getPerformanceNavigationTiming(),r=this.getPerformanceTiming(),i=0,o=0,a=0,s=0,c=0;(n||r)&&(n?(i=n.duration,o=n.startTime===0?n.connectEnd:Lt(n.startTime,n.connectEnd),a=Lt(n.requestStart,n.responseStart),s=Lt(n.responseStart,n.responseEnd),c=Lt(n.responseEnd,n.loadEventEnd)):(i=Lt(r.navigationStart,r.loadEventEnd),o=Lt(r.navigationStart,r.connectEnd),a=Lt(r.requestStart,r.responseStart),s=Lt(r.responseStart,r.responseEnd),c=Lt(r.responseEnd,r.loadEventEnd)),i===0?this._logger.throwInternal(q.WARNING,B.ErrorPVCalc,"error calculating page view performance.",{total:i,network:o,request:a,response:s,dom:c}):this.shouldCollectDuration(i,o,a,s,c)?i<Math.floor(o)+Math.floor(a)+Math.floor(s)+Math.floor(c)?this._logger.throwInternal(q.WARNING,B.ClientPerformanceMathError,"client performance math error.",{total:i,network:o,request:a,response:s,dom:c}):(e.durationMs=i,e.perfTotal=e.duration=pr(i),e.networkConnect=pr(o),e.sentRequest=pr(a),e.receivedResponse=pr(s),e.domProcessing=pr(c),e.isValid=!0):this._logger.throwInternal(q.WARNING,B.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:i,network:o,request:a,response:s,dom:c}))},t.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?hr().timing:null},t.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?hr().getEntriesByType("navigation")[0]:null},t.prototype.isPerformanceNavigationTimingSupported=function(){var e=hr();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},t.prototype.isPerformanceTimingSupported=function(){var e=hr();return e&&e.timing},t.prototype.isPerformanceTimingDataReady=function(){var e=hr(),n=e?e.timing:0;return n&&n.domainLookupStart>0&&n.navigationStart>0&&n.responseStart>0&&n.requestStart>0&&n.loadEventEnd>0&&n.responseEnd>0&&n.connectEnd>0&&n.domLoading>0},t.prototype.shouldCollectDuration=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=qn()||{},i=["googlebot","adsbot-google","apis-google","mediapartners-google"],o=r.userAgent,a=!1;if(o)for(var s=0;s<i.length;s++)a=a||o.toLowerCase().indexOf(i[s])!==-1;if(a)return!1;for(var s=0;s<e.length;s++)if(e[s]<0||e[s]>=this.MAX_DURATION_ALLOWED)return!1;return!0},t}()});function sa(t,e){t&&t.dispatchEvent&&e&&t.dispatchEvent(e)}u(sa,"Dn");var Bl,Ps,$l,Vl,Tv=L(()=>{Ne(),ft(),be(),kv(),Rv(),Dv(),je(),Bl="duration",Ps="event",$l=function(t){Te(e,t);function e(){var n=t.call(this)||this;n.identifier=Wl,n.priority=180,n.autoRoutePVDelay=500;var r,i,o,a=0,s,c;return Xe(e,n,function(l,d){var h=ui(!0);s=h&&h.href||"",l.getCookieMgr=function(){return Jc(l.core)},l.processTelemetry=function(m,C){ro(l.core,function(){return l.identifier+":processTelemetry"},function(){var w=!1,_=l._telemetryInitializers.length;C=l._getTelCtx(C);for(var E=0;E<_;++E){var x=l._telemetryInitializers[E];if(x)try{if(x.apply(null,[m])===!1){w=!0;break}}catch(T){C.diagLog().throwInternal(q.CRITICAL,B.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Ae(T),{exception:me(T)},!0)}}w||l.processNext(m,C)},function(){return{item:m}},!m.sync)},l.trackEvent=function(m,C){try{var w=Kn.create(m,Pn.dataType,Pn.envelopeType,l.diagLog(),C);l.core.track(w)}catch(_){l.diagLog().throwInternal(q.WARNING,B.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Ae(_),{exception:me(_)})}},l.startTrackEvent=function(m){try{r.start(m)}catch(C){l.diagLog().throwInternal(q.CRITICAL,B.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+Ae(C),{exception:me(C)})}},l.stopTrackEvent=function(m,C,w){try{r.stop(m,void 0,C)}catch(_){l.diagLog().throwInternal(q.CRITICAL,B.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+Ae(_),{exception:me(_)})}},l.trackTrace=function(m,C){try{var w=Kn.create(m,vr.dataType,vr.envelopeType,l.diagLog(),C);l.core.track(w)}catch(_){l.diagLog().throwInternal(q.WARNING,B.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Ae(_),{exception:me(_)})}},l.trackMetric=function(m,C){try{var w=Kn.create(m,jn.dataType,jn.envelopeType,l.diagLog(),C);l.core.track(w)}catch(_){l.diagLog().throwInternal(q.CRITICAL,B.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+Ae(_),{exception:me(_)})}},l.trackPageView=function(m,C){try{var w=m||{};l._pageViewManager.trackPageView(w,Mt({},w.properties,w.measurements,C)),l.config.autoTrackPageVisitTime&&l._pageVisitTimeManager.trackPreviousPageVisit(w.name,w.uri)}catch(_){l.diagLog().throwInternal(q.CRITICAL,B.TrackPVFailed,"trackPageView failed, page view will not be collected: "+Ae(_),{exception:me(_)})}},l.sendPageViewInternal=function(m,C,w){var _=Vn();_&&(m.refUri=m.refUri===void 0?_.referrer:m.refUri);var E=Kn.create(m,Fn.dataType,Fn.envelopeType,l.diagLog(),C,w);l.core.track(E),a=0},l.sendPageViewPerformanceInternal=function(m,C,w){var _=Kn.create(m,mr.dataType,mr.envelopeType,l.diagLog(),C,w);l.core.track(_)},l.trackPageViewPerformance=function(m,C){try{l._pageViewPerformanceManager.populatePageViewPerformanceEvent(m),l.sendPageViewPerformanceInternal(m,C)}catch(w){l.diagLog().throwInternal(q.CRITICAL,B.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+Ae(w),{exception:me(w)})}},l.startTrackPage=function(m){try{if(typeof m!="string"){var C=Vn();m=C&&C.title||""}i.start(m)}catch(w){l.diagLog().throwInternal(q.CRITICAL,B.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+Ae(w),{exception:me(w)})}},l.stopTrackPage=function(m,C,w,_){try{if(typeof m!="string"){var E=Vn();m=E&&E.title||""}if(typeof C!="string"){var x=ui();C=x&&x.href||""}i.stop(m,C,w,_),l.config.autoTrackPageVisitTime&&l._pageVisitTimeManager.trackPreviousPageVisit(m,C)}catch(T){l.diagLog().throwInternal(q.CRITICAL,B.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+Ae(T),{exception:me(T)})}},l.sendExceptionInternal=function(m,C,w){var _=m.exception||m.error||new Error(gn),E=new Ut(l.diagLog(),_,m.properties||C,m.measurements,m.severityLevel,m.id).toInterface(),x=Kn.create(E,Ut.dataType,Ut.envelopeType,l.diagLog(),C,w);l.core.track(x)},l.trackException=function(m,C){try{l.sendExceptionInternal(m,C)}catch(w){l.diagLog().throwInternal(q.CRITICAL,B.TrackExceptionFailed,"trackException failed, exception will not be collected: "+Ae(w),{exception:me(w)})}},l._onerror=function(m){var C=m&&m.error,w=m&&m.evt;try{if(!w){var _=Ko();_&&(w=_[Ps])}var E=m&&m.url||(Vn()||{}).URL,x=m.errorSrc||"window.onerror@"+E+":"+(m.lineNumber||0)+":"+(m.columnNumber||0),T={errorSrc:x,url:E,lineNumber:m.lineNumber||0,columnNumber:m.columnNumber||0,message:m.message};eh(m.message,m.url,m.lineNumber,m.columnNumber,m.error)?v(Ut.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",E,m.lineNumber||0,m.columnNumber||0,C,w,null,x),T):(m.errorSrc||(m.errorSrc=x),l.trackException({exception:m,severityLevel:oa.Error},T))}catch(F){var W=C?C.name+", "+C.message:"null";l.diagLog().throwInternal(q.CRITICAL,B.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+Ae(F),{exception:me(F),errorString:W})}},l.addTelemetryInitializer=function(m){l._telemetryInitializers.push(m)},l.initialize=function(m,C,w,_){if(!l.isInitialized()){if(k(C))throw Error("Error initializing");d.initialize(m,C,w,_),l.setInitialized(!1);var E=l._getTelCtx(),x=l.identifier;l.config=E.getExtCfg(x);var T=e.getDefaultConfig(m);T!==void 0&&Ee(T,function(z,te){l.config[z]=E.getConfig(x,z,te),l.config[z]===void 0&&(l.config[z]=te)}),l.config.isStorageUseDisabled&&nh();var W={instrumentationKey:function(){return m.instrumentationKey},accountId:function(){return l.config.accountId||m.accountId},sessionRenewalMs:function(){return l.config.sessionRenewalMs||m.sessionRenewalMs},sessionExpirationMs:function(){return l.config.sessionExpirationMs||m.sessionExpirationMs},sampleRate:function(){return l.config.samplingPercentage||m.samplingPercentage},sdkExtension:function(){return l.config.sdkExtension||m.sdkExtension},isBrowserLinkTrackingEnabled:function(){return l.config.isBrowserLinkTrackingEnabled||m.isBrowserLinkTrackingEnabled},appId:function(){return l.config.appId||m.appId}};l._pageViewPerformanceManager=new Vh(l.core),l._pageViewManager=new Wh(n,l.config.overridePageViewDuration,l.core,l._pageViewPerformanceManager),l._pageVisitTimeManager=new Bh(l.diagLog(),function(z,te,oe){return g(z,te,oe)}),l._telemetryInitializers=l._telemetryInitializers||[],p(W),r=new Vl(l.diagLog(),"trackEvent"),r.action=function(z,te,oe,fe){fe||(fe={}),fe[Bl]=oe.toString(),l.trackEvent({name:z,properties:fe})},i=new Vl(l.diagLog(),"trackPageView"),i.action=function(z,te,oe,fe,Se){k(fe)&&(fe={}),fe[Bl]=oe.toString();var Oe={name:z,uri:te,properties:fe,measurements:Se};l.sendPageViewInternal(Oe,fe)};var F=Ko(),G=xp(),Z=ui(!0),ee=n;if(l.config.disableExceptionTracking===!1&&!l.config.autoExceptionInstrumented&&F){var Q="onerror",se=F[Q];F.onerror=function(z,te,oe,fe,Se){var Oe=F[Ps],mn=se&&se(z,te,oe,fe,Se);return mn!==!0&&ee._onerror(Ut.CreateAutoException(z,te,oe,fe,Se,Oe)),mn},l.config.autoExceptionInstrumented=!0}if(l.config.disableExceptionTracking===!1&&l.config.enableUnhandledPromiseRejectionTracking===!0&&!l.config.autoUnhandledPromiseInstrumented&&F){var R="onunhandledrejection",O=F[R];F[R]=function(z){var te=F[Ps],oe=O&&O.call(F,z);return oe!==!0&&ee._onerror(Ut.CreateAutoException(z.reason.toString(),Z?Z.href:"",0,0,z,te)),oe},l.config.autoUnhandledPromiseInstrumented=!0}if(l.config.enableAutoRouteTracking===!0&&G&&re(G.pushState)&&re(G.replaceState)&&F&&typeof Event!="undefined"){var j=n;ge(w,function(z){z.identifier===mo&&(o=z)}),G.pushState=function(z){return function(){var te=z.apply(this,arguments);return sa(F,uo(j.config.namePrefix+"pushState")),sa(F,uo(j.config.namePrefix+"locationchange")),te}}(G.pushState),G.replaceState=function(z){return function(){var te=z.apply(this,arguments);return sa(F,uo(j.config.namePrefix+"replaceState")),sa(F,uo(j.config.namePrefix+"locationchange")),te}}(G.replaceState),F.addEventListener&&(F.addEventListener(j.config.namePrefix+"popstate",function(){sa(F,uo(j.config.namePrefix+"locationchange"))}),F.addEventListener(j.config.namePrefix+"locationchange",function(){if(o&&o.context&&o.context.telemetryTrace){o.context.telemetryTrace.traceID=zn();var z="_unknown_";Z&&Z.pathname&&(z=Z.pathname+(Z.hash||"")),o.context.telemetryTrace.name=z}c&&(s=c),c=Z&&Z.href||"",setTimeout(function(te){j.trackPageView({refUri:te,properties:{duration:0}})}.bind(n,s),j.autoRoutePVDelay)}))}l.setInitialized(!0)}};function g(m,C,w){var _={PageName:m,PageUrl:C};l.trackMetric({name:"PageVisitTime",average:w,max:w,min:w,sampleCount:1},_)}u(g,"m");function p(m){if(!m.isBrowserLinkTrackingEnabled()){var C=["/browserLinkSignalR/","/__browserLink/"],w=u(function(_){if(_.baseType===Gn.dataType){var E=_.baseData;if(E){for(var x=0;x<C.length;x++)if(E.target&&E.target.indexOf(C[x])>=0)return!1}}return!0},"y");y(w)}}u(p,"I");function y(m){l._telemetryInitializers.push(m)}u(y,"E");function v(m,C){var w=Kn.create(m,Ut.dataType,Ut.envelopeType,l.diagLog(),C);l.core.track(w)}u(v,"b")}),n}return u(e,"e"),e.getDefaultConfig=function(n){return n||(n={}),n.sessionRenewalMs=30*60*1e3,n.sessionExpirationMs=24*60*60*1e3,n.disableExceptionTracking=Ue(n.disableExceptionTracking),n.autoTrackPageVisitTime=Ue(n.autoTrackPageVisitTime),n.overridePageViewDuration=Ue(n.overridePageViewDuration),n.enableUnhandledPromiseRejectionTracking=Ue(n.enableUnhandledPromiseRejectionTracking),(isNaN(n.samplingPercentage)||n.samplingPercentage<=0||n.samplingPercentage>=100)&&(n.samplingPercentage=100),n.isStorageUseDisabled=Ue(n.isStorageUseDisabled),n.isBrowserLinkTrackingEnabled=Ue(n.isBrowserLinkTrackingEnabled),n.enableAutoRouteTracking=Ue(n.enableAutoRouteTracking),n.namePrefix=n.namePrefix||"",n.enableDebug=Ue(n.enableDebug),n.disableFlushOnBeforeUnload=Ue(n.disableFlushOnBeforeUnload),n.disableFlushOnUnload=Ue(n.disableFlushOnUnload,n.disableFlushOnBeforeUnload),n},e.Version="2.6.4",e}(fi),Vl=function(){function t(e,n){var r=this,i={};r.start=function(o){typeof i[o]!="undefined"&&e.throwInternal(q.WARNING,B.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:o,key:o},!0),i[o]=+new Date},r.stop=function(o,a,s,c){var l=i[o];if(isNaN(l))e.throwInternal(q.WARNING,B.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:o,key:o},!0);else{var d=+new Date,h=Lt(l,d);r.action(o,a,h,s,c)}delete i[o],i[o]=void 0}}return u(t,"t"),t}()}),qh=L(()=>{Tv()}),zh,jh,Av=L(()=>{ft(),be(),je(),zh=function(){function t(e){var n=[];Xe(t,this,function(r){r.enqueue=function(i){n.push(i)},r.count=function(){return n.length},r.clear=function(){n.length=0},r.getItems=function(){return n.slice(0)},r.batchPayloads=function(i){if(i&&i.length>0){var o=e.emitLineDelimitedJson()?i.join(`
`):"["+i.join(",")+"]";return o}return null},r.markAsSent=function(i){r.clear()},r.clearSent=function(i){}})}return u(t,"t"),t}(),jh=function(){function t(e,n){var r=!1,i;Xe(t,this,function(o){var a=l(t.BUFFER_KEY),s=l(t.SENT_BUFFER_KEY);i=a.concat(s),i.length>t.MAX_BUFFER_SIZE&&(i.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,[]),d(t.BUFFER_KEY,i),o.enqueue=function(h){if(i.length>=t.MAX_BUFFER_SIZE){r||(e.throwInternal(q.WARNING,B.SessionStorageBufferFull,"Maximum buffer size reached: "+i.length,!0),r=!0);return}i.push(h),d(t.BUFFER_KEY,i)},o.count=function(){return i.length},o.clear=function(){i=[],d(t.BUFFER_KEY,[]),d(t.SENT_BUFFER_KEY,[]),r=!1},o.getItems=function(){return i.slice(0)},o.batchPayloads=function(h){if(h&&h.length>0){var g=n.emitLineDelimitedJson()?h.join(`
`):"["+h.join(",")+"]";return g}return null},o.markAsSent=function(h){i=c(h,i),d(t.BUFFER_KEY,i);var g=l(t.SENT_BUFFER_KEY);g instanceof Array&&h instanceof Array&&(g=g.concat(h),g.length>t.MAX_BUFFER_SIZE&&(e.throwInternal(q.CRITICAL,B.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+g.length,!0),g.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,g))},o.clearSent=function(h){var g=l(t.SENT_BUFFER_KEY);g=c(h,g),d(t.SENT_BUFFER_KEY,g)};function c(h,g){var p=[];return ge(g,function(y){!re(y)&&jo(h,y)===-1&&p.push(y)}),p}u(c,"s");function l(h){var g=h;try{g=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+g:g;var p=bs(e,g);if(p){var y=Rn().parse(p);if(ae(y)&&(y=Rn().parse(y)),y&&Ye(y))return y}}catch(v){e.throwInternal(q.CRITICAL,B.FailedToRestoreStorageBuffer," storage key: "+g+", "+Ae(v),{exception:me(v)})}return[]}u(l,"u");function d(h,g){var p=h;try{p=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+p:p;var y=JSON.stringify(g);Ss(e,p,y)}catch(v){Ss(e,p,JSON.stringify([])),e.throwInternal(q.WARNING,B.FailedToSetStorageBuffer," storage key: "+p+", "+Ae(v)+". Buffer cleared",{exception:me(v)})}}u(d,"l")})}return u(t,"t"),t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}()});function st(t,e,n){return Ie(t,e,n,Ac)}u(st,"Se");var Fs,qe,gt,ql,Je,Gh,zl,Kh,Qh,Xh,Jh,Yh,Pv=L(()=>{Ne(),ft(),be(),Fs="baseType",qe="baseData",gt="properties",ql="true",Je=function(){function t(){}return u(t,"t"),t.extractPropsAndMeasurements=function(e,n,r){k(e)||Ee(e,function(i,o){kn(o)?r[i]=o:ae(o)?n[i]=o:to()&&(n[i]=Rn().stringify(o))})},t.createEnvelope=function(e,n,r,i){var o=new Al(e,i,n);st(o,"sampleRate",r[ws]),(r[qe]||{}).startTime&&(o.time=tn(r[qe].startTime)),o.iKey=r.iKey;var a=r.iKey.replace(/-/g,"");return o.name=o.name.replace("{0}",a),t.extractPartAExtensions(r,o),r.tags=r.tags||[],td(o)},t.extractPartAExtensions=function(e,n){var r=n.tags=n.tags||{},i=e.ext=e.ext||{},o=e.tags=e.tags||[],a=i.user;a&&(st(r,He.userAuthUserId,a.authId),st(r,He.userId,a.id||a.localId));var s=i.app;s&&st(r,He.sessionId,s.sesId);var c=i.device;c&&(st(r,He.deviceId,c.id||c.localId),st(r,He.deviceType,c.deviceClass),st(r,He.deviceIp,c.ip),st(r,He.deviceModel,c.model),st(r,He.deviceType,c.deviceType));var l=e.ext.web;if(l){st(r,He.deviceLanguage,l.browserLang),st(r,He.deviceBrowserVersion,l.browserVer),st(r,He.deviceBrowser,l.browser);var d=n.data=n.data||{},h=d[qe]=d[qe]||{},g=h[gt]=h[gt]||{};st(g,"domain",l.domain),st(g,"isManual",l.isManual?ql:null),st(g,"screenRes",l.screenRes),st(g,"userConsent",l.userConsent?ql:null)}var p=i.os;p&&st(r,He.deviceOS,p.name);var y=i.trace;y&&(st(r,He.operationParentId,y.parentID),st(r,He.operationName,y.name),st(r,He.operationId,y.traceID));for(var v={},m=o.length-1;m>=0;m--){var C=o[m];Ee(C,function(_,E){v[_]=E}),o.splice(m,1)}Ee(o,function(_,E){v[_]=E});var w=Mt({},r,v);w[He.internalSdkVersion]||(w[He.internalSdkVersion]="javascript:"+t.Version),n.tags=td(w)},t.prototype.Init=function(e,n){this._logger=e,k(n[qe])&&this._logger.throwInternal(q.CRITICAL,B.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},t.Version="2.6.4",t}(),Gh=function(t){Te(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe].measurements||{},o=r[qe][gt]||{};Je.extractPropsAndMeasurements(r.data,o,i);var a=r[qe];if(k(a))return n.warnToConsole("Invalid input for dependency data"),null;var s=a[gt]&&a[gt][ys]?a[gt][ys]:"GET",c=new Gn(n,a.id,a.target,a.name,a.duration,a.success,a.responseCode,s,a.type,a.correlationContext,o,i),l=new wr(Gn.dataType,c);return Je.createEnvelope(n,Gn.envelopeType,r,l)},e.DependencyEnvelopeCreator=new e,e}(Je),zl=function(t){Te(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i={},o={};r[Fs]!==Pn.dataType&&(i.baseTypeSource=r[Fs]),r[Fs]===Pn.dataType?(i=r[qe][gt]||{},o=r[qe].measurements||{}):r[qe]&&Je.extractPropsAndMeasurements(r[qe],i,o),Je.extractPropsAndMeasurements(r.data,i,o);var a=r[qe].name,s=new Pn(n,a,i,o),c=new wr(Pn.dataType,s);return Je.createEnvelope(n,Pn.envelopeType,r,c)},e.EventEnvelopeCreator=new e,e}(Je),Kh=function(t){Te(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe].measurements||{},o=r[qe][gt]||{};Je.extractPropsAndMeasurements(r.data,o,i);var a=r[qe],s=Ut.CreateFromInterface(n,a,o,i),c=new wr(Ut.dataType,s);return Je.createEnvelope(n,Ut.envelopeType,r,c)},e.ExceptionEnvelopeCreator=new e,e}(Je),Qh=function(t){Te(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe],o=i[gt]||{},a=i.measurements||{};Je.extractPropsAndMeasurements(r.data,o,a);var s=new jn(n,i.name,i.average,i.sampleCount,i.min,i.max,o,a),c=new wr(jn.dataType,s);return Je.createEnvelope(n,jn.envelopeType,r,c)},e.MetricEnvelopeCreator=new e,e}(Je),Xh=function(t){Te(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i="duration",o,a=r[qe];!k(a)&&!k(a[gt])&&!k(a[gt][i])?(o=a[gt][i],delete a[gt][i]):!k(r.data)&&!k(r.data[i])&&(o=r.data[i],delete r.data[i]);var s=r[qe],c;((r.ext||{}).trace||{}).traceID&&(c=r.ext.trace.traceID);var l=s.id||c,d=s.name,h=s.uri,g=s[gt]||{},p=s.measurements||{};if(k(s.refUri)||(g.refUri=s.refUri),k(s.pageType)||(g.pageType=s.pageType),k(s.isLoggedIn)||(g.isLoggedIn=s.isLoggedIn.toString()),!k(s[gt])){var y=s[gt];Ee(y,function(C,w){g[C]=w})}Je.extractPropsAndMeasurements(r.data,g,p);var v=new Fn(n,d,h,o,g,p,l),m=new wr(Fn.dataType,v);return Je.createEnvelope(n,Fn.envelopeType,r,m)},e.PageViewEnvelopeCreator=new e,e}(Je),Jh=function(t){Te(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe],o=i.name,a=i.uri||i.url,s=i[gt]||{},c=i.measurements||{};Je.extractPropsAndMeasurements(r.data,s,c);var l=new mr(n,o,a,void 0,s,c,i),d=new wr(mr.dataType,l);return Je.createEnvelope(n,mr.envelopeType,r,d)},e.PageViewPerformanceEnvelopeCreator=new e,e}(Je),Yh=function(t){Te(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return u(e,"e"),e.prototype.Create=function(n,r){t.prototype.Init.call(this,n,r);var i=r[qe].message,o=r[qe].severityLevel,a=r[qe][gt]||{},s=r[qe].measurements||{};Je.extractPropsAndMeasurements(r.data,a,s);var c=new vr(n,i,o,a,s),l=new wr(vr.dataType,c);return Je.createEnvelope(n,vr.envelopeType,r,l)},e.TraceEnvelopeCreator=new e,e}(Je)}),Zh,Fv=L(()=>{be(),je(),Zh=function(){function t(e){Xe(t,this,function(n){n.serialize=function(a){var s=r(a,"root");try{return Rn().stringify(s)}catch(c){e.throwInternal(q.CRITICAL,B.CannotSerializeObject,c&&re(c.toString)?c.toString():"Error serializing object",null,!0)}};function r(a,s){var c="__aiCircularRefCheck",l={};if(!a)return e.throwInternal(q.CRITICAL,B.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:s},!0),l;if(a[c])return e.throwInternal(q.WARNING,B.CircularReferenceDetected,"Circular reference detected while serializing object",{name:s},!0),l;if(!a.aiDataContract){if(s==="measurements")l=o(a,"number",s);else if(s==="properties")l=o(a,"string",s);else if(s==="tags")l=o(a,"string",s);else if(Ye(a))l=i(a,s);else{e.throwInternal(q.WARNING,B.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:s},!0);try{Rn().stringify(a),l=a}catch(d){e.throwInternal(q.CRITICAL,B.CannotSerializeObject,d&&re(d.toString)?d.toString():"Error serializing object",null,!0)}}return l}return a[c]=!0,Ee(a.aiDataContract,function(d,h){var g=re(h)?h()&1:h&1,p=re(h)?h()&4:h&4,y=h&2,v=a[d]!==void 0,m=le(a[d])&&a[d]!==null;if(g&&!v&&!y)e.throwInternal(q.CRITICAL,B.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:d,name:s});else if(!p){var C=void 0;m?y?C=i(a[d],d):C=r(a[d],d):C=a[d],C!==void 0&&(l[d]=C)}}),delete a[c],l}u(r,"n");function i(a,s){var c;if(a)if(!Ye(a))e.throwInternal(q.CRITICAL,B.ItemNotInArray,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:s},!0);else{c=[];for(var l=0;l<a.length;l++){var d=a[l],h=r(d,s+"["+l+"]");c.push(h)}}return c}u(i,"i");function o(a,s,c){var l;return a&&(l={},Ee(a,function(d,h){if(s==="string")h===void 0?l[d]="undefined":h===null?l[d]="null":h.toString?l[d]=h.toString():l[d]="invalid field: toString() is not defined.";else if(s==="number")if(h===void 0)l[d]="undefined";else if(h===null)l[d]="null";else{var g=parseFloat(h);isNaN(g)?l[d]="NaN":l[d]=g}else l[d]="invalid field: "+c+" is of unknown type.",e.throwInternal(q.CRITICAL,l[d],null,!0)})),l}u(o,"a")})}return u(t,"t"),t}()}),ef,jl,Mv=L(()=>{be(),je(),ef=function(){function t(){var e=Ko(),n=Vn(),r=!1,i=!0;Xe(t,this,function(o){try{if(e&&ta.Attach(e,"online",c)&&(ta.Attach(e,"offline",l),r=!0),n){var a=n.body||n;I(a.ononline)||(a.ononline=c,a.onoffline=l,r=!0)}if(r){var s=qn();s&&!k(s.onLine)&&(i=s.onLine)}}catch(d){r=!1}o.isListening=r,o.isOnline=function(){var d=!0,h=qn();return r?d=i:h&&!k(h.onLine)&&(d=h.onLine),d},o.isOffline=function(){return!o.isOnline()};function c(){i=!0}u(c,"s");function l(){i=!1}u(l,"u")})}return u(t,"t"),t.Offline=new t,t}(),jl=ef.Offline}),tf,Nv=L(()=>{tf=function(){function t(){}return u(t,"t"),t.prototype.getHashCodeScore=function(e){var n=this.getHashCode(e)/t.INT_MAX_VALUE;return n*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e.length<t.MIN_INPUT_LENGTH;)e=e.concat(e);for(var n=5381,r=0;r<e.length;++r)n=(n<<5)+n+e.charCodeAt(r),n=n&n;return Math.abs(n)},t.INT_MAX_VALUE=2147483647,t.MIN_INPUT_LENGTH=8,t}()}),nf,Lv=L(()=>{Nv(),ft(),nf=function(){function t(){this.hashCodeGeneragor=new tf,this.keys=new Ts}return u(t,"t"),t.prototype.getSamplingScore=function(e){var n=0;return e.tags&&e.tags[this.keys.userId]?n=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?n=this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?n=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?n=this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):n=Math.random()*100,n},t}()}),rf,Uv=L(()=>{Lv(),ft(),be(),rf=function(){function t(e,n){this.INT_MAX_VALUE=2147483647,this._logger=n||os(null),(e>100||e<0)&&(this._logger.throwInternal(q.WARNING,B.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new nf}return u(t,"t"),t.prototype.isSampledIn=function(e){var n=this.sampleRate,r=!1;return n==null||n>=100||e.baseType===jn.dataType?!0:(r=this.samplingScoreGenerator.getSamplingScore(e)<n,r)},t}()});function Ms(t){try{return t.responseText}catch(e){}return null}u(Ms,"Ii");var Gl,Ov=L(()=>{Ne(),Av(),Pv(),Fv(),ft(),be(),Mv(),Uv(),je(),Gl=function(t){Te(e,t);function e(){var n=t.call(this)||this;n.priority=1001,n.identifier=As,n._XMLHttpRequestSupported=!1;var r,i,o,a,s,c,l={};return Xe(e,n,function(d,h){function g(){$n("Method not implemented.")}u(g,"m"),d.pause=g,d.resume=g,d.flush=function(){try{d.triggerSend(!0,null,1)}catch(R){d.diagLog().throwInternal(q.CRITICAL,B.FlushFailed,"flush failed, telemetry will not be collected: "+Ae(R),{exception:me(R)})}},d.onunloadFlush=function(){if((d._senderConfig.onunloadDisableBeacon()===!1||d._senderConfig.isBeaconApiDisabled()===!1)&&Cl())try{d.triggerSend(!0,m,2)}catch(R){d.diagLog().throwInternal(q.CRITICAL,B.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Ae(R),{exception:me(R)})}else d.flush()},d.teardown=g,d.addHeader=function(R,O){l[R]=O},d.initialize=function(R,O,j,z){h.initialize(R,O,j,z);var te=d._getTelCtx(),oe=d.identifier;s=new Zh(O.logger),r=0,i=null,o=0,d._sender=null,c=0;var fe=e._getDefaultAppInsightsChannelConfig();if(d._senderConfig=e._getEmptyAppInsightsChannelConfig(),Ee(fe,function(M,V){d._senderConfig[M]=function(){return te.getConfig(oe,M,V())}}),d._buffer=d._senderConfig.enableSessionStorageBuffer()&&fo()?new jh(d.diagLog(),d._senderConfig):new zh(d._senderConfig),d._sample=new rf(d._senderConfig.samplingPercentage(),d.diagLog()),se(R)||d.diagLog().throwInternal(q.CRITICAL,B.InvalidInstrumentationKey,"Invalid Instrumentation key "+R.instrumentationKey),!_s(d._senderConfig.endpointUrl())&&d._senderConfig.customHeaders()&&d._senderConfig.customHeaders().length>0&&ge(d._senderConfig.customHeaders(),function(M){n.addHeader(M.header,M.value)}),!d._senderConfig.isBeaconApiDisabled()&&Cl())d._sender=m;else{var Se=Rt("XMLHttpRequest");if(Se){var Oe=new Se;"withCredentials"in Oe?(d._sender=C,d._XMLHttpRequestSupported=!0):typeof XDomainRequest!==xn&&(d._sender=G)}else{var mn=Rt("fetch");mn&&(d._sender=w)}}},d.processTelemetry=function(R,O){O=d._getTelCtx(O);try{if(d._senderConfig.disableTelemetry())return;if(!R){O.diagLog().throwInternal(q.CRITICAL,B.CannotSendEmptyTelemetry,"Cannot send empty telemetry");return}if(R.baseData&&!R.baseType){O.diagLog().throwInternal(q.CRITICAL,B.InvalidEvent,"Cannot send telemetry without baseData and baseType");return}if(R.baseType||(R.baseType="EventData"),!d._sender){O.diagLog().throwInternal(q.CRITICAL,B.SenderNotInitialized,"Sender was not initialized");return}if(p(R))R[ws]=d._sample.sampleRate;else{O.diagLog().throwInternal(q.WARNING,B.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:d._sample.sampleRate});return}var j=e.constructEnvelope(R,d._senderConfig.instrumentationKey(),O.diagLog());if(!j){O.diagLog().throwInternal(q.CRITICAL,B.CreateEnvelopeError,"Unable to create an AppInsights envelope");return}var z=!1;if(R.tags&&R.tags[ho]&&(ge(R.tags[ho],function(Se){try{Se&&Se(j)===!1&&(z=!0,O.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(Oe){O.diagLog().throwInternal(q.CRITICAL,B.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Ae(Oe),{exception:me(Oe)},!0)}}),delete R.tags[ho]),z)return;var te=s.serialize(j),oe=d._buffer.getItems(),fe=d._buffer.batchPayloads(oe);fe&&fe.length+te.length>d._senderConfig.maxBatchSizeInBytes()&&d.triggerSend(!0,null,10),d._buffer.enqueue(te),T()}catch(Se){O.diagLog().throwInternal(q.WARNING,B.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Ae(Se),{exception:me(Se)})}d.processNext(R,O)},d._xhrReadyStateChange=function(R,O,j){R.readyState===4&&y(R.status,O,R.responseURL,j,F(R),Ms(R)||R.response)},d.triggerSend=function(R,O,j){R===void 0&&(R=!0);try{if(d._senderConfig.disableTelemetry())d._buffer.clear();else{if(d._buffer.count()>0){var z=d._buffer.getItems();Q(j||0,R),O?O.call(n,z,R):d._sender(z,R)}o=+new Date}clearTimeout(a),a=null,i=null}catch(oe){var te=Oc();(!te||te>9)&&d.diagLog().throwInternal(q.CRITICAL,B.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+Ae(oe),{exception:me(oe)})}},d._onError=function(R,O,j){d.diagLog().throwInternal(q.WARNING,B.OnError,"Failed to send telemetry.",{message:O}),d._buffer.clearSent(R)},d._onPartialSuccess=function(R,O){for(var j=[],z=[],te=O.errors.reverse(),oe=0,fe=te;oe<fe.length;oe++){var Se=fe[oe],Oe=R.splice(Se.index,1)[0];W(Se.statusCode)?z.push(Oe):j.push(Oe)}R.length>0&&d._onSuccess(R,O.itemsAccepted),j.length>0&&d._onError(j,F(null,["partial success",O.itemsAccepted,"of",O.itemsReceived].join(" "))),z.length>0&&(E(z),d.diagLog().throwInternal(q.WARNING,B.TransmissionFailed,"Partial success. Delivered: "+R.length+", Failed: "+j.length+". Will retry to send "+z.length+" our of "+O.itemsReceived+" items"))},d._onSuccess=function(R,O){d._buffer.clearSent(R)},d._xdrOnLoad=function(R,O){var j=Ms(R);if(R&&(j+""=="200"||j===""))r=0,d._onSuccess(O,0);else{var z=_(j);z&&z.itemsReceived&&z.itemsReceived>z.itemsAccepted&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(O,z):d._onError(O,Z(R))}};function p(R){return d._sample.isSampledIn(R)}u(p,"I");function y(R,O,j,z,te,oe){var fe=null;if(d._appId||(fe=_(oe),fe&&fe.appId&&(d._appId=fe.appId)),(R<200||R>=300)&&R!==0){if((R===301||R===307||R===308)&&!v(j)){d._onError(O,te);return}!d._senderConfig.isRetryDisabled()&&W(R)?(E(O),d.diagLog().throwInternal(q.WARNING,B.TransmissionFailed,". Response code "+R+". Will retry to send "+O.length+" items.")):d._onError(O,te)}else if(jl.isOffline()){if(!d._senderConfig.isRetryDisabled()){var Se=10;E(O,Se),d.diagLog().throwInternal(q.WARNING,B.TransmissionFailed,". Offline - Response Code: "+R+". Offline status: "+jl.isOffline()+". Will retry to send "+O.length+" items.")}}else v(j),R===206?(fe||(fe=_(oe)),fe&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(O,fe):d._onError(O,te)):(r=0,d._onSuccess(O,z))}u(y,"E");function v(R){return c>=10?!1:!k(R)&&R!==""&&R!==d._senderConfig.endpointUrl()?(d._senderConfig.endpointUrl=function(){return R},++c,!0):!1}u(v,"b");function m(R,O){var j=d._senderConfig.endpointUrl(),z=d._buffer.batchPayloads(R),te=new Blob([z],{type:"text/plain;charset=UTF-8"}),oe=qn().sendBeacon(j,te);oe?(d._buffer.markAsSent(R),d._onSuccess(R,R.length)):(C(R,!0),d.diagLog().throwInternal(q.WARNING,B.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}u(m,"p");function C(R,O){var j=new XMLHttpRequest,z=d._senderConfig.endpointUrl();try{j[vi]=!0}catch(oe){}j.open("POST",z,O),j.setRequestHeader("Content-type","application/json"),_s(z)&&j.setRequestHeader(Be.sdkContextHeader,Be.sdkContextHeaderAppIdRequest),ge(li(l),function(oe){j.setRequestHeader(oe,l[oe])}),j.onreadystatechange=function(){return d._xhrReadyStateChange(j,R,R.length)},j.onerror=function(oe){return d._onError(R,F(j),oe)};var te=d._buffer.batchPayloads(R);j.send(te),d._buffer.markAsSent(R)}u(C,"v");function w(R,O){var j=d._senderConfig.endpointUrl(),z=d._buffer.batchPayloads(R),te=new Blob([z],{type:"text/plain;charset=UTF-8"}),oe=new Headers;_s(j)&&oe.append(Be.sdkContextHeader,Be.sdkContextHeaderAppIdRequest),ge(li(l),function(Oe){oe.append(Oe,l[Oe])});var fe={method:"POST",headers:oe,body:te},Se=new Request(j,fe);fetch(Se).then(function(Oe){if(Oe.ok)Oe.text().then(function(mn){y(Oe.status,R,Oe.url,R.length,Oe.statusText,mn)}),d._buffer.markAsSent(R);else throw Error(Oe.statusText)}).catch(function(Oe){d._onError(R,Oe.message)})}u(w,"y");function _(R){try{if(R&&R!==""){var O=Rn().parse(R);if(O&&O.itemsReceived&&O.itemsReceived>=O.itemsAccepted&&O.itemsReceived-O.itemsAccepted===O.errors.length)return O}}catch(j){d.diagLog().throwInternal(q.CRITICAL,B.InvalidBackendResponse,"Cannot parse the response. "+Ae(j),{response:R})}return null}u(_,"w");function E(R,O){if(O===void 0&&(O=1),!(!R||R.length===0)){d._buffer.clearSent(R),r++;for(var j=0,z=R;j<z.length;j++){var te=z[j];d._buffer.enqueue(te)}x(O),T()}}u(E,"L");function x(R){var O=10,j;if(r<=1)j=O;else{var z=(Math.pow(2,r)-1)/2,te=Math.floor(Math.random()*z*O)+1;te=R*te,j=Math.max(Math.min(te,3600),O)}var oe=hn()+j*1e3;i=oe}u(x,"F");function T(){if(!a){var R=i?Math.max(0,i-hn()):0,O=Math.max(d._senderConfig.maxBatchInterval(),R);a=setTimeout(function(){d.triggerSend(!0,null,1)},O)}}u(T,"Q");function W(R){return R===408||R===429||R===500||R===503}u(W,"Ce");function F(R,O){return R?"XMLHttpRequest,Status:"+R.status+",Response:"+Ms(R)||0||0:O}u(F,"X");function G(R,O){var j=Ko(),z=new XDomainRequest;z.onload=function(){return d._xdrOnLoad(z,R)},z.onerror=function(Se){return d._onError(R,Z(z),Se)};var te=j&&j.location&&j.location.protocol||"";if(d._senderConfig.endpointUrl().lastIndexOf(te,0)!==0){d.diagLog().throwInternal(q.WARNING,B.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),d._buffer.clear();return}var oe=d._senderConfig.endpointUrl().replace(/^(https?:)/,"");z.open("POST",oe);var fe=d._buffer.batchPayloads(R);z.send(fe),d._buffer.markAsSent(R)}u(G,"ge");function Z(R,O){return R?"XDomainRequest,Response:"+Ms(R)||0:O}u(Z,"Ae");function ee(){var R="getNotifyMgr";return d.core[R]?d.core[R]():d.core._notificationManager}u(ee,"dt");function Q(R,O){var j=ee();if(j&&j.eventsSendRequest)try{j.eventsSendRequest(R,O)}catch(z){d.diagLog().throwInternal(q.CRITICAL,B.NotificationException,"send request notification failed: "+Ae(z),{exception:me(z)})}}u(Q,"ot");function se(R){var O=k(R.disableInstrumentationKeyValidation)?!1:R.disableInstrumentationKeyValidation;if(O)return!0;var j="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",z=new RegExp(j);return z.test(R.instrumentationKey)}u(se,"mt")}),n}return u(e,"e"),e.constructEnvelope=function(n,r,i){var o;switch(r!==n.iKey&&!k(r)?o=Mt({},n,{iKey:r}):o=n,o.baseType){case Pn.dataType:return zl.EventEnvelopeCreator.Create(i,o);case vr.dataType:return Yh.TraceEnvelopeCreator.Create(i,o);case Fn.dataType:return Xh.PageViewEnvelopeCreator.Create(i,o);case mr.dataType:return Jh.PageViewPerformanceEnvelopeCreator.Create(i,o);case Ut.dataType:return Kh.ExceptionEnvelopeCreator.Create(i,o);case jn.dataType:return Qh.MetricEnvelopeCreator.Create(i,o);case Gn.dataType:return Gh.DependencyEnvelopeCreator.Create(i,o);default:return zl.EventEnvelopeCreator.Create(i,o)}},e._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){}}},e._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0,customHeaders:void 0}},e}(fi)}),of=L(()=>{Ov()}),af,Kl,sf,Hv=L(()=>{je(),ft(),be(),af="ai_session",Kl=function(){function t(){}return u(t,"t"),t}(),sf=function(){function t(e,n){var r=this,i,o,a=os(n),s=Jc(n);Xe(t,r,function(c){e||(e={}),re(e.sessionExpirationMs)||(e.sessionExpirationMs=function(){return t.acquisitionSpan}),re(e.sessionRenewalMs)||(e.sessionRenewalMs=function(){return t.renewalSpan}),c.config=e;var l=c.config.sessionCookiePostfix&&c.config.sessionCookiePostfix()?c.config.sessionCookiePostfix():c.config.namePrefix&&c.config.namePrefix()?c.config.namePrefix():"";i=u(function(){return af+l},"i"),c.automaticSession=new Kl,c.update=function(){var v=hn(),m=!1,C=c.automaticSession;C.id||(m=!d(C,v));var w=c.config.sessionExpirationMs();if(!m&&w>0){var _=c.config.sessionRenewalMs(),E=v-C.acquisitionDate,x=v-C.renewalDate;m=E<0||x<0,m=m||E>w,m=m||x>_}m?g(v):(!o||v-o>t.cookieUpdateInterval)&&p(C,v)},c.backup=function(){var v=c.automaticSession;y(v.id,v.acquisitionDate,v.renewalDate)};function d(v,m){var C=!1,w=s.get(i());if(w&&re(w.split))C=h(v,w);else{var _=rh(a,i());_&&(C=h(v,_))}return C||!!v.id}u(d,"l");function h(v,m){var C=!1,w=", session will be reset",_=m.split("|");if(_.length>=2)try{var E=+_[1]||0,x=+_[2]||0;isNaN(E)||E<=0?a.throwInternal(q.WARNING,B.SessionRenewalDateIsZero,"AI session acquisition date is 0"+w):isNaN(x)||x<=0?a.throwInternal(q.WARNING,B.SessionRenewalDateIsZero,"AI session renewal date is 0"+w):_[0]&&(v.id=_[0],v.acquisitionDate=E,v.renewalDate=x,C=!0)}catch(T){a.throwInternal(q.CRITICAL,B.ErrorParsingAISessionCookie,"Error parsing ai_session value ["+(m||"")+"]"+w+" - "+Ae(T),{exception:me(T)})}return C}u(h,"f");function g(v){var m=c.config||{},C=(m.getNewId?m.getNewId():null)||ps;c.automaticSession.id=C(m.idLength?m.idLength():22),c.automaticSession.acquisitionDate=v,p(c.automaticSession,v),xl()||a.throwInternal(q.WARNING,B.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}u(g,"m");function p(v,m){var C=v.acquisitionDate;v.renewalDate=m;var w=c.config,_=w.sessionRenewalMs(),E=C+w.sessionExpirationMs()-m,x=[v.id,C,m],T=0;E<_?T=E/1e3:T=_/1e3;var W=w.cookieDomain?w.cookieDomain():null;s.set(i(),x.join("|"),w.sessionExpirationMs()>0?T:null,W),o=m}u(p,"I");function y(v,m,C){ih(a,i(),[v,m,C].join("|"))}u(y,"E")})}return u(t,"t"),t.acquisitionSpan=864e5,t.renewalSpan=18e5,t.cookieUpdateInterval=6e4,t}()}),cf,Wv=L(()=>{cf=function(){function t(){}return u(t,"t"),t}()}),lf,Bv=L(()=>{lf=function(){function t(){this.id="browser",this.deviceClass="Browser"}return u(t,"t"),t}()}),uf,df,$v=L(()=>{uf="2.6.4",df=function(){function t(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:"+uf}return u(t,"t"),t}()});function hf(t){return!(typeof t!="string"||!t||t.match(/,|;|=| |\|/))}u(hf,"Kc");var ff,Vv=L(()=>{je(),ft(),be(),ff=function(){function t(e,n){this.isNewUser=!1;var r=os(n),i=Jc(n),o;Xe(t,this,function(a){a.config=e;var s=a.config.userCookiePostfix&&a.config.userCookiePostfix()?a.config.userCookiePostfix():"";o=u(function(){return t.userCookieName+s},"a");var c=i.get(o());if(c){a.isNewUser=!1;var l=c.split(t.cookieSeparator);l.length>0&&(a.id=l[0])}if(!a.id){var d=e||{},h=(d.getNewId?d.getNewId():null)||ps;a.id=h(d.idLength?e.idLength():22);var g=31536e3,p=tn(new Date);a.accountAcquisitionDate=p,a.isNewUser=!0;var y=[a.id,p];i.set(o(),y.join(t.cookieSeparator),g);var v=e.namePrefix&&e.namePrefix()?e.namePrefix()+"ai_session":"ai_session";oh(r,v)}a.accountId=e.accountId?e.accountId():void 0;var m=i.get(t.authUserCookieName);if(m){m=decodeURI(m);var C=m.split(t.cookieSeparator);C[0]&&(a.authenticatedId=C[0]),C.length>1&&C[1]&&(a.accountId=C[1])}a.setAuthenticatedUserContext=function(w,_,E){E===void 0&&(E=!1);var x=!hf(w)||_&&!hf(_);if(x){r.throwInternal(q.WARNING,B.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}a.authenticatedId=w;var T=a.authenticatedId;_&&(a.accountId=_,T=[a.authenticatedId,a.accountId].join(t.cookieSeparator)),E&&i.set(t.authUserCookieName,encodeURI(T))},a.clearAuthenticatedUserContext=function(){a.authenticatedId=null,a.accountId=null,i.del(t.authUserCookieName)}})}return u(t,"t"),t.cookieSeparator="|",t.userCookieName="ai_user",t.authUserCookieName="ai_authUser",t}()}),gf,qv=L(()=>{gf=function(){function t(){}return u(t,"t"),t}()}),pf,zv=L(()=>{ft(),be(),pf=function(){function t(e,n,r,i){var o=this;o.traceID=e||zn(),o.parentID=n,o.name=r;var a=ui();!r&&a&&a.pathname&&(o.name=a.pathname),o.name=Nt(i,o.name)}return u(t,"t"),t}()});function wo(t,e){t&&t[e]&&li(t[e]).length===0&&delete t[e]}u(wo,"Hr");var ca,la,vf,jv=L(()=>{je(),be(),Hv(),ft(),Wv(),Bv(),$v(),Vv(),qv(),zv(),ca="ext",la="tags",vf=function(){function t(e,n){var r=this,i=e.logger;this.appId=function(){return null},Xe(t,this,function(o){o.application=new cf,o.internal=new df(n),Za()&&(o.sessionManager=new sf(n,e),o.device=new lf,o.location=new gf,o.user=new ff(n,e),o.telemetryTrace=new pf(void 0,void 0,void 0,i),o.session=new Kl),o.applySessionContext=function(a,s){var c=o.session,l=o.sessionManager;c&&ae(c.id)?Ie(Et(a.ext,Ot.AppExt),"sesId",c.id):l&&l.automaticSession&&Ie(Et(a.ext,Ot.AppExt),"sesId",l.automaticSession.id,ae)},o.applyOperatingSystemContxt=function(a,s){Ie(a.ext,Ot.OSExt,o.os)},o.applyApplicationContext=function(a,s){var c=o.application;if(c){var l=Et(a,la);Ie(l,He.applicationVersion,c.ver,ae),Ie(l,He.applicationBuild,c.build,ae)}},o.applyDeviceContext=function(a,s){var c=o.device;if(c){var l=Et(Et(a,ca),Ot.DeviceExt);Ie(l,"localId",c.id,ae),Ie(l,"ip",c.ip,ae),Ie(l,"model",c.model,ae),Ie(l,"deviceClass",c.deviceClass,ae)}},o.applyInternalContext=function(a,s){var c=o.internal;if(c){var l=Et(a,la);Ie(l,He.internalAgentVersion,c.agentVersion,ae),Ie(l,He.internalSdkVersion,c.sdkVersion,ae),(a.baseType===no.dataType||a.baseType===Fn.dataType)&&(Ie(l,He.internalSnippet,c.snippetVer,ae),Ie(l,He.internalSdkSrc,c.sdkSrc,ae))}},o.applyLocationContext=function(a,s){var c=r.location;c&&Ie(Et(a,la,[]),He.locationIp,c.ip,ae)},o.applyOperationContext=function(a,s){var c=o.telemetryTrace;if(c){var l=Et(Et(a,ca),Ot.TraceExt,{traceID:void 0,parentID:void 0});Ie(l,"traceID",c.traceID,ae),Ie(l,"name",c.name,ae),Ie(l,"parentID",c.parentID,ae)}},o.applyWebContext=function(a,s){var c=r.web;c&&Ie(Et(a,ca),Ot.WebExt,c)},o.applyUserContext=function(a,s){var c=o.user;if(c){var l=Et(a,la,[]);Ie(l,He.userAccountId,c.accountId,ae);var d=Et(Et(a,ca),Ot.UserExt);Ie(d,"id",c.id,ae),Ie(d,"authId",c.authenticatedId,ae)}},o.cleanUp=function(a,s){var c=a.ext;c&&(wo(c,Ot.DeviceExt),wo(c,Ot.UserExt),wo(c,Ot.WebExt),wo(c,Ot.OSExt),wo(c,Ot.AppExt),wo(c,Ot.TraceExt))}})}return u(t,"t"),t}()}),mf,Ql,Gv=L(()=>{Ne(),je(),be(),jv(),ft(),mf=function(t){Te(e,t);function e(){var n=t.call(this)||this;n.priority=110,n.identifier=mo;var r,i;return Xe(e,n,function(o,a){o.initialize=function(c,l,d,h){a.initialize(c,l,d,h);var g=o._getTelCtx(),p=o.identifier,y=e.getDefaultConfig();i=i||{},Ee(y,function(v,m){i[v]=function(){return g.getConfig(p,v,m())}}),o.context=new vf(l,i),r=Zd(d,As),o.context.appId=function(){return r?r._appId:null},o._extConfig=i},o.processTelemetry=function(c,l){if(!k(c)){l=o._getTelCtx(l),c.name===Fn.envelopeType&&l.diagLog().resetInternalMessageCount();var d=o.context||{};if(d.session&&typeof o.context.session.id!="string"&&d.sessionManager&&d.sessionManager.update(),s(c,l),d.user&&d.user.isNewUser){d.user.isNewUser=!1;var h=new no(B.SendBrowserInfoOnUserInit,(qn()||{}).userAgent||"");l.diagLog().logInternalMessage(q.CRITICAL,h)}o.processNext(c,l)}};function s(c,l){Et(c,"tags",[]),Et(c,"ext",{});var d=o.context;d.applySessionContext(c,l),d.applyApplicationContext(c,l),d.applyDeviceContext(c,l),d.applyOperationContext(c,l),d.applyUserContext(c,l),d.applyOperatingSystemContxt(c,l),d.applyWebContext(c,l),d.applyLocationContext(c,l),d.applyInternalContext(c,l),d.cleanUp(c,l)}u(s,"c")}),n}return u(e,"e"),e.getDefaultConfig=function(){var n={instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 30*60*1e3},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 24*60*60*1e3},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}};return n},e}(fi),Ql=mf}),wf=L(()=>{Gv()});function yf(t,e,n){var r=0,i=t[e],o=t[n];return i&&o&&(r=Lt(i,o)),r}u(yf,"ru");function Ci(t,e,n,r,i){var o=0,a=yf(n,r,i);return a&&(o=Kr(t,e,pr(a))),o}u(Ci,"Sr");function Kr(t,e,n){var r="ajaxPerf",i=0;if(t&&e&&n){var o=t[r]=t[r]||{};o[e]=n,i=1}return i}u(Kr,"nr");function Kv(t,e){var n=t.perfTiming,r=e[zt]||{},i=0,o="name",a="Start",s="End",c="domainLookup",l="connect",d="redirect",h="request",g="response",p="duration",y="startTime",v=c+a,m=c+s,C=l+a,w=l+s,_=h+a,E=h+s,x=g+a,T=g+s,W=d+a,F=d=s,G="transferSize",Z="encodedBodySize",ee="decodedBodySize",Q="serverTiming";if(n){i|=Ci(r,d,n,W,F),i|=Ci(r,c,n,v,m),i|=Ci(r,l,n,C,w),i|=Ci(r,h,n,_,E),i|=Ci(r,g,n,x,T),i|=Ci(r,"networkConnect",n,y,w),i|=Ci(r,"sentRequest",n,_,T);var se=n[p];se||(se=yf(n,y,T)||0),i|=Kr(r,p,se),i|=Kr(r,"perfTotal",se);var R=n[Q];if(R){var O={};ge(R,function(j,z){var te=Ve(j[o]||""+z),oe=O[te]||{};Ee(j,function(fe,Se){(fe!==o&&ae(Se)||kn(Se))&&(oe[fe]&&(Se=oe[fe]+";"+Se),(Se||!ae(Se))&&(oe[fe]=Se))}),O[te]=oe}),i|=Kr(r,Q,O)}i|=Kr(r,G,n[G]),i|=Kr(r,Z,n[Z]),i|=Kr(r,ee,n[ee])}else t.perfMark&&(i|=Kr(r,"missing",t.perfAttempts));i&&(e[zt]=r)}u(Kv,"Il");var zt,Cf,Xl,Qv=L(()=>{ft(),be(),je(),zt="properties",Cf=function(){function t(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1}return u(t,"t"),t}(),Xl=function(){function t(e,n,r){var i=this,o=r,a="responseText";i.perfMark=null,i.completed=!1,i.requestHeadersSize=null,i.requestHeaders=null,i.responseReceivingDuration=null,i.callbackDuration=null,i.ajaxTotalDuration=null,i.aborted=0,i.pageUrl=null,i.requestUrl=null,i.requestSize=0,i.method=null,i.status=null,i.requestSentTime=null,i.responseStartedTime=null,i.responseFinishedTime=null,i.callbackFinishedTime=null,i.endTime=null,i.xhrMonitoringState=new Cf,i.clientFailure=0,i.traceID=e,i.spanID=n,Xe(t,i,function(s){s.getAbsoluteUrl=function(){return s.requestUrl?ch(s.requestUrl):null},s.getPathName=function(){return s.requestUrl?na(o,lh(s.method,s.requestUrl)):null},s.CreateTrackItem=function(c,l,d){if(s.ajaxTotalDuration=Math.round(Lt(s.requestSentTime,s.responseFinishedTime)*1e3)/1e3,s.ajaxTotalDuration<0)return null;var h=(v={id:"|"+s.traceID+"."+s.spanID,target:s.getAbsoluteUrl(),name:s.getPathName(),type:c,startTime:null,duration:s.ajaxTotalDuration,success:+s.status>=200&&+s.status<400,responseCode:+s.status,method:s.method},v[zt]={HttpMethod:s.method},v);if(s.requestSentTime&&(h.startTime=new Date,h.startTime.setTime(s.requestSentTime)),Kv(s,h),l&&li(s.requestHeaders).length>0&&(h[zt]=h[zt]||{},h[zt].requestHeaders=s.requestHeaders),d){var g=d();if(g){var p=g.correlationContext;if(p&&(h.correlationContext=p),g.headerMap&&li(g.headerMap).length>0&&(h[zt]=h[zt]||{},h[zt].responseHeaders=g.headerMap),s.status>=400){var y=g.type;h[zt]=h[zt]||{},(y===""||y==="text")&&(h[zt][a]=g[a]?g.statusText+" - "+g[a]:g.statusText),y==="json"&&(h[zt][a]=g.response?g.statusText+" - "+JSON.stringify(g.response):g.statusText)}}}return h;var v}})}return u(t,"t"),t}()}),Xv,Jv=L(()=>{be(),be(),Xv=function(){function t(){}return u(t,"t"),t.GetLength=function(e){var n=0;if(!k(e)){var r="";try{r=e.toString()}catch(i){}n=r.length,n=isNaN(n)?0:n}return n},t}()}),Jl,Yv=L(()=>{be(),Jl=function(){function t(e,n){var r=this;r.traceFlag=t.DEFAULT_TRACE_FLAG,r.version=t.DEFAULT_VERSION,e&&t.isValidTraceId(e)?r.traceId=e:r.traceId=zn(),n&&t.isValidSpanId(n)?r.spanId=n:r.spanId=zn().substr(0,16)}return u(t,"t"),t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.prototype.toString=function(){var e=this;return e.version+"-"+e.traceId+"-"+e.spanId+"-"+e.traceFlag},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}()});function Zv(){var t=Lr();return!t||k(t.Request)||k(t.Request[Ft])||k(t[bo])?null:t[bo]}u(Zv,"El");function em(t){var e=!1;if(typeof XMLHttpRequest!==xn&&!k(XMLHttpRequest)){var n=XMLHttpRequest[Ft];e=!k(n)&&!k(n.open)&&!k(n.send)&&!k(n.abort)}var r=Oc();if(r&&r<9&&(e=!1),e)try{var i=new XMLHttpRequest;i[jt]={};var o=XMLHttpRequest[Ft].open;XMLHttpRequest[Ft].open=o}catch(a){e=!1,ua(t,B.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:me(a)})}return e}u(em,"wl");function Ns(t){var e="";try{!k(t)&&!k(t[jt])&&!k(t[jt].requestUrl)&&(e+="(url: '"+t[jt].requestUrl+"')")}catch(n){}return e}u(Ns,"wi");function ua(t,e,n,r,i){t[Co]()[Zl](q.CRITICAL,e,n,r,i)}u(ua,"Mn");function Ls(t,e,n,r,i){t[Co]()[Zl](q.WARNING,e,n,r,i)}u(Ls,"Pi");function da(t,e,n){return function(r){ua(t,e,n,{ajaxDiagnosticsMessage:Ns(r.inst),exception:me(r.err)})}}u(da,"Ln");function yo(t,e){return t&&e?t.indexOf(e):-1}u(yo,"jr");var Yl,Co,jt,Zl,bo,eu,tu,tm=L(()=>{Ne(),ft(),be(),Qv(),Jv(),Yv(),je(),Yl="ai.ajxmn.",Co="diagLog",jt="ajaxData",Zl="throwInternal",bo="fetch",eu=0,tu=function(t){Te(e,t);function e(){var n=t.call(this)||this;n.identifier=e.identifier,n.priority=120;var r="trackDependencyDataInternal",i=ui(),o=!1,a=!1,s=i&&i.host&&i.host.toLowerCase(),c=e.getEmptyConfig(),l=!1,d=0,h,g,p,y,v=!1,m=0,C=!1,w=[],_={},E;return Xe(e,n,function(x,T){x.initialize=function(M,V,X,K){if(!x.isInitialized()){T.initialize(M,V,X,K);var ne=x._getTelCtx(),he=e.getDefaultConfig();Ee(he,function(At,Rr){c[At]=ne.getConfig(e.identifier,At,Rr)});var ue=c.distributedTracingMode;if(l=c.enableRequestHeaderTracking,v=c.enableAjaxPerfTracking,m=c.maxAjaxCallsPerView,C=c.enableResponseHeaderTracking,E=c.excludeRequestFromAutoTrackingPatterns,p=ue===An.AI||ue===An.AI_AND_W3C,g=ue===An.AI_AND_W3C||ue===An.W3C,v){var _e=M.instrumentationKey||"unkwn";_e.length>5?y=Yl+_e.substring(_e.length-5)+".":y=Yl+_e+"."}if(c.disableAjaxTracking===!1&&Z(),F(),X.length>0&&X){for(var $e=void 0,Ze=0;!$e&&Ze<X.length;)X[Ze]&&X[Ze].identifier===mo&&($e=X[Ze]),Ze++;$e&&(h=$e.context)}}},x.teardown=function(){ge(w,function(M){M.rm()}),w=[],o=!1,a=!1,x.setInitialized(!1)},x.trackDependencyData=function(M,V){x[r](M,V)},x.includeCorrelationHeaders=function(M,V,X,K){var ne=x._currentWindowHost||s;if(V){if(zr.canIncludeCorrelationHeader(c,M.getAbsoluteUrl(),ne)){if(X||(X={}),X.headers=new Headers(X.headers||(V instanceof Request?V.headers||{}:{})),p){var he="|"+M.traceID+"."+M.spanID;X.headers.set(Be.requestIdHeader,he),l&&(M.requestHeaders[Be.requestIdHeader]=he)}var ue=c.appId||h&&h.appId();if(ue&&(X.headers.set(Be.requestContextHeader,Be.requestContextAppIdFormat+ue),l&&(M.requestHeaders[Be.requestContextHeader]=Be.requestContextAppIdFormat+ue)),g){var _e=new Jl(M.traceID,M.spanID);X.headers.set(Be.traceParentHeader,_e.toString()),l&&(M.requestHeaders[Be.traceParentHeader]=_e.toString())}}return X}else if(K){if(zr.canIncludeCorrelationHeader(c,M.getAbsoluteUrl(),ne)){if(p){var he="|"+M.traceID+"."+M.spanID;K.setRequestHeader(Be.requestIdHeader,he),l&&(M.requestHeaders[Be.requestIdHeader]=he)}var ue=c.appId||h&&h.appId();if(ue&&(K.setRequestHeader(Be.requestContextHeader,Be.requestContextAppIdFormat+ue),l&&(M.requestHeaders[Be.requestContextHeader]=Be.requestContextAppIdFormat+ue)),g){var _e=new Jl(M.traceID,M.spanID);K.setRequestHeader(Be.traceParentHeader,_e.toString()),l&&(M.requestHeaders[Be.traceParentHeader]=_e.toString())}}return K}},x[r]=function(M,V,X){if(m===-1||d<m){(c.distributedTracingMode===An.W3C||c.distributedTracingMode===An.AI_AND_W3C)&&typeof M.id=="string"&&M.id[M.id.length-1]!=="."&&(M.id+="."),k(M.startTime)&&(M.startTime=new Date);var K=Kn.create(M,Gn.dataType,Gn.envelopeType,x[Co](),V,X);x.core.track(K)}else d===m&&ua(x,B.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++d};function W(M){var V=!0;return(M||c.ignoreHeaders)&&ge(c.ignoreHeaders,function(X){if(X.toLowerCase()===M.toLowerCase())return V=!1,-1}),V}u(W,"Ce");function F(){var M=Zv();if(M){var V=Lr(),X=M.polyfill;c.disableFetchTracking===!1?(w.push(fl(V,bo,{req:function(K,ne,he){var ue;if(o&&!ee(null,ne,he)&&!(X&&a)){var _e=K.ctx();ue=fe(ne,he);var $e=x.includeCorrelationHeaders(ue,ne,he);$e!==he&&K.set(1,$e),_e.data=ue}},rsp:function(K,ne){var he=K.ctx().data;he&&(K.rslt=K.rslt.then(function(ue){return Oe(K,(ue||{}).status,ue,he,function(){var _e={statusText:ue.statusText,headerMap:null,correlationContext:mn(ue)};if(C){var $e={};ue.headers.forEach(function(Ze,At){W(At)&&($e[At]=Ze)}),_e.headerMap=$e}return _e}),ue}).catch(function(ue){throw Oe(K,0,ne,he,null,{error:ue.message}),ue}))},hkErr:da(x,B.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),o=!0):X&&w.push(fl(V,bo,{req:function(K,ne,he){ee(null,ne,he)}})),X&&(V[bo].polyfill=X)}}u(F,"X");function G(M,V,X){w.push(jp(M,V,X))}u(G,"ge");function Z(){em(x)&&!a&&(G(XMLHttpRequest,"open",{req:function(M,V,X,K){var ne=M.inst,he=ne[jt];!ee(ne,X)&&Q(ne,!0)&&(!he||!he.xhrMonitoringState.openDone)&&se(ne,V,X,K)},hkErr:da(x,B.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),G(XMLHttpRequest,"send",{req:function(M,V){var X=M.inst,K=X[jt];Q(X)&&!K.xhrMonitoringState.sendDone&&(te("xhr",K),K.requestSentTime=ia(),x.includeCorrelationHeaders(K,void 0,void 0,X),K.xhrMonitoringState.sendDone=!0)},hkErr:da(x,B.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),G(XMLHttpRequest,"abort",{req:function(M){var V=M.inst,X=V[jt];Q(V)&&!X.xhrMonitoringState.abortDone&&(X.aborted=1,X.xhrMonitoringState.abortDone=!0)},hkErr:da(x,B.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),l&&G(XMLHttpRequest,"setRequestHeader",{req:function(M,V,X){var K=M.inst;Q(K)&&W(V)&&(K[jt].requestHeaders[V]=X)},hkErr:da(x,B.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),a=!0)}u(Z,"Ae");function ee(M,V,X){var K=!1,ne=((ae(V)?V:(V||{}).url||"")||"").toLowerCase();if(ge(E,function(_e){var $e=_e;ae(_e)&&($e=new RegExp(_e)),K||(K=$e.test(ne))}),K)return K;var he=yo(ne,"?"),ue=yo(ne,"#");return(he===-1||ue!==-1&&ue<he)&&(he=ue),he!==-1&&(ne=ne.substring(0,he)),k(M)?k(V)||(K=(typeof V=="object"?V[vi]===!0:!1)||(X?X[vi]===!0:!1)):K=M[vi]===!0||ne[vi]===!0,K?_[ne]||(_[ne]=1):_[ne]&&(K=!0),K}u(ee,"dt");function Q(M,V){var X=!0,K=a;return k(M)||(X=V===!0||!k(M[jt])),K&&X}u(Q,"ot");function se(M,V,X,K){var ne=h&&h.telemetryTrace&&h.telemetryTrace.traceID||zn(),he=zn().substr(0,16),ue=new Xl(ne,he,x[Co]());ue.method=V,ue.requestUrl=X,ue.xhrMonitoringState.openDone=!0,ue.requestHeaders={},ue.async=K,M[jt]=ue,R(M)}u(se,"mt");function R(M){M[jt].xhrMonitoringState.stateChangeAttached=ta.Attach(M,"readystatechange",function(){try{M&&M.readyState===4&&Q(M)&&j(M)}catch(X){var V=me(X);(!V||yo(V.toLowerCase(),"c00c023f")===-1)&&ua(x,B.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Ns(M),exception:V})}})}u(R,"d");function O(M){try{var V=M.responseType;if(V===""||V==="text")return M.responseText}catch(X){}return null}u(O,"T");function j(M){var V=M[jt];V.responseFinishedTime=ia(),V.status=M.status;function X(K,ne){var he=ne||{};he.ajaxDiagnosticsMessage=Ns(M),K&&(he.exception=me(K)),Ls(x,B.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",he)}u(X,"N"),oe("xmlhttprequest",V,function(){try{var K=V.CreateTrackItem("Ajax",l,function(){var ne={statusText:M.statusText,headerMap:null,correlationContext:z(M),type:M.responseType,responseText:O(M),response:M.response};if(C){var he=M.getAllResponseHeaders();if(he){var ue=Ct(he).split(/[\r\n]+/),_e={};ge(ue,function($e){var Ze=$e.split(": "),At=Ze.shift(),Rr=Ze.join(": ");W(At)&&(_e[At]=Rr)}),ne.headerMap=_e}}return ne});K?x[r](K):X(null,{requestSentTime:V.requestSentTime,responseFinishedTime:V.responseFinishedTime})}finally{try{M[jt]=null}catch(ne){}}},function(K){X(K,null)})}u(j,"A");function z(M){try{var V=M.getAllResponseHeaders();if(V!==null){var X=yo(V.toLowerCase(),Be.requestContextHeaderLowerCase);if(X!==-1){var K=M.getResponseHeader(Be.requestContextHeader);return zr.getCorrelationContext(K)}}}catch(ne){Ls(x,B.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Ns(M),exception:me(ne)})}}u(z,"D");function te(M,V){if(V.requestUrl&&y&&v){var X=hr();if(X&&re(X.mark)){eu++;var K=y+M+"#"+eu;X.mark(K);var ne=X.getEntriesByName(K);ne&&ne.length===1&&(V.perfMark=ne[0])}}}u(te,"j");function oe(M,V,X,K){var ne=V.perfMark,he=hr(),ue=c.maxAjaxPerfLookupAttempts,_e=c.ajaxPerfLookupDelay,$e=V.requestUrl,Ze=0;u(function At(){try{if(he&&ne){Ze++;for(var Rr=null,dc=he.getEntries(),Mo=dc.length-1;Mo>=0;Mo--){var wn=dc[Mo];if(wn){if(wn.entryType==="resource")wn.initiatorType===M&&(yo(wn.name,$e)!==-1||yo($e,wn.name)!==-1)&&(Rr=wn);else if(wn.entryType==="mark"&&wn.name===ne.name){V.perfTiming=Rr;break}if(wn.startTime<ne.startTime-1e3)break}}}!ne||V.perfTiming||Ze>=ue||V.async===!1?(ne&&re(he.clearMarks)&&he.clearMarks(ne.name),V.perfAttempts=Ze,X()):setTimeout(At,_e)}catch(Xu){K(Xu)}},"Je")()}u(oe,"U");function fe(M,V){var X=h&&h.telemetryTrace&&h.telemetryTrace.traceID||zn(),K=zn().substr(0,16),ne=new Xl(X,K,x[Co]());ne.requestSentTime=ia(),M instanceof Request?ne.requestUrl=M?M.url:"":ne.requestUrl=M;var he="GET";V&&V.method?he=V.method:M&&M instanceof Request&&(he=M.method),ne.method=he;var ue={};if(l){var _e=new Headers((V?V.headers:0)||(M instanceof Request?M.headers||{}:{}));_e.forEach(function($e,Ze){W(Ze)&&(ue[Ze]=$e)})}return ne.requestHeaders=ue,te("fetch",ne),ne}u(fe,"q");function Se(M){var V="";try{k(M)||(typeof M=="string"?V+="(url: '"+M+"')":V+="(url: '"+M.url+"')")}catch(X){ua(x,B.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:me(X)})}return V}u(Se,"Z");function Oe(M,V,X,K,ne,he){if(!K)return;function ue(_e,$e,Ze){var At=Ze||{};At.fetchDiagnosticsMessage=Se(X),$e&&(At.exception=me($e)),Ls(x,_e,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",At)}u(ue,"B"),K.responseFinishedTime=ia(),K.status=V,oe("fetch",K,function(){var _e=K.CreateTrackItem("Fetch",l,ne);_e?x[r](_e):ue(B.FailedMonitorAjaxDur,null,{requestSentTime:K.requestSentTime,responseFinishedTime:K.responseFinishedTime})},function(_e){ue(B.FailedMonitorAjaxGetCorrelationHeader,_e,null)})}u(Oe,"ie");function mn(M){if(M&&M.headers)try{var V=M.headers.get(Be.requestContextHeader);return zr.getCorrelationContext(V)}catch(X){Ls(x,B.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:Se(M),exception:me(X)})}}u(mn,"jt")}),n}return u(e,"e"),e.getDefaultConfig=function(){var n={maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:An.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"]};return n},e.getEmptyConfig=function(){var n=this.getDefaultConfig();return Ee(n,function(r){n[r]=void 0}),n},e.prototype.processTelemetry=function(n,r){this.processNext(n,r)},e.identifier="AjaxDependencyPlugin",e}(fi)}),bf=L(()=>{tm()}),nu,ru,Sf,_f,iu,xf=L(()=>{be(),qh(),of(),wf(),bf(),ft(),ru=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],Sf={Default:0,Required:1,Array:2,Hidden:4},_f={__proto__:null,PropertiesPluginIdentifier:mo,BreezeChannelIdentifier:As,AnalyticsPluginIdentifier:Wl,Util:Rl,CorrelationIdHelper:zr,UrlHelper:gh,DateTimeUtils:ph,ConnectionStringParser:Ch,FieldType:Sf,RequestHeaders:Be,DisabledPropertyName:vi,ProcessLegacy:ho,SampleRate:ws,HttpMethod:ys,DEFAULT_BREEZE_ENDPOINT:bl,AIData:Tl,AIBase:Dl,Envelope:Al,Event:Pn,Exception:Ut,Metric:jn,PageView:Fn,PageViewData:Rs,RemoteDependencyData:Gn,Trace:vr,PageViewPerformance:mr,Data:wr,SeverityLevel:oa,ConfigurationManager:Oh,ContextTagKeys:Ts,DataSanitizer:Jd,TelemetryItemCreator:Kn,CtxTagKeys:He,Extensions:Ot,DistributedTracingModes:An},iu=function(){function t(e){var n=this;n._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var r=e.config||{};if(r.connectionString){var i=mh(r.connectionString),o=i.ingestionendpoint;r.endpointUrl=o?o+"/v2/track":r.endpointUrl,r.instrumentationKey=i.instrumentationkey||r.instrumentationKey}n.appInsights=new $l,n.properties=new Ql,n.dependencies=new tu,n.core=new cl,n._sender=new Gl,n.snippet=e,n.config=r,n.getSKUDefaults()}return u(t,"t"),t.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},t.prototype.trackEvent=function(e,n){this.appInsights.trackEvent(e,n)},t.prototype.trackPageView=function(e){var n=e||{};this.appInsights.trackPageView(n)},t.prototype.trackPageViewPerformance=function(e){var n=e||{};this.appInsights.trackPageViewPerformance(n)},t.prototype.trackException=function(e){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},t.prototype._onerror=function(e){this.appInsights._onerror(e)},t.prototype.trackTrace=function(e,n){this.appInsights.trackTrace(e,n)},t.prototype.trackMetric=function(e,n){this.appInsights.trackMetric(e,n)},t.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},t.prototype.stopTrackPage=function(e,n,r,i){this.appInsights.stopTrackPage(e,n,r,i)},t.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,n,r){this.appInsights.stopTrackEvent(e,n,r)},t.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},t.prototype.setAuthenticatedUserContext=function(e,n,r){r===void 0&&(r=!1),this.properties.context.user.setAuthenticatedUserContext(e,n,r)},t.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},t.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},t.prototype.flush=function(e){var n=this;e===void 0&&(e=!0),ro(this.core,function(){return"AISKU.flush"},function(){ge(n.core.getTransmissionControls(),function(r){ge(r,function(i){i.flush(e)})})},null,e)},t.prototype.onunloadFlush=function(e){e===void 0&&(e=!0),ge(this.core.getTransmissionControls(),function(n){ge(n,function(r){r.onunloadFlush?r.onunloadFlush():r.flush(e)})})},t.prototype.loadAppInsights=function(e,n,r){var i=this;e===void 0&&(e=!1);var o=this;function a(s){if(s){var c="";k(o._snippetVersion)||(c+=o._snippetVersion),e&&(c+=".lg"),o.context&&o.context.internal&&(o.context.internal.snippetVer=c||"-"),Ee(o,function(l,d){ae(l)&&!re(d)&&l&&l[0]!=="_"&&ru.indexOf(l)===-1&&(s[l]=d)})}}return u(a,"o"),e&&o.config.extensions&&o.config.extensions.length>0&&$n("Extensions not allowed in legacy mode"),ro(o.core,function(){return"AISKU.loadAppInsights"},function(){var s=[];s.push(o._sender),s.push(o.properties),s.push(o.dependencies),s.push(o.appInsights),o.core.initialize(o.config,s,n,r),o.context=o.properties.context,nu&&o.context&&(o.context.internal.sdkSrc=nu),a(o.snippet),o.emptyQueue(),o.pollInternalLogs(),o.addHousekeepingBeforeUnload(i)}),o},t.prototype.updateSnippetDefinitions=function(e){ed(e,this,function(n){return n&&ru.indexOf(n)===-1})},t.prototype.emptyQueue=function(){var e=this;try{if(Ye(e.snippet.queue)){for(var n=e.snippet.queue.length,r=0;r<n;r++){var i=e.snippet.queue[r];i()}e.snippet.queue=void 0,delete e.snippet.queue}}catch(a){var o={};a&&re(a.toString)&&(o.exception=a.toString())}},t.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},t.prototype.addHousekeepingBeforeUnload=function(e){if(Za()||rd()){var n=u(function(){e.onunloadFlush(!1),ge(e.appInsights.core._extensions,function(i){if(i.identifier===mo)return i&&i.context&&i.context._sessionManager&&i.context._sessionManager.backup(),-1})},"r");if(!e.appInsights.config.disableFlushOnBeforeUnload){var r=pi("beforeunload",n);r=pi("unload",n)||r,r=pi("pagehide",n)||r,r=pi("visibilitychange",n)||r,!r&&!Rp()&&e.appInsights.core.logger.throwInternal(q.CRITICAL,B.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||(pi("pagehide",n),pi("visibilitychange",n))}},t.prototype.getSender=function(){return this._sender},t.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},t}(),function(){var t=null,e=!1,n=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var r=(document||{}).currentScript;r&&(t=r.src)}catch(s){}if(t)try{var i=t.toLowerCase();if(i){for(var o="",a=0;a<n.length;a++)if(i.indexOf(n[a])!==-1){o="cdn"+(a+1),i.indexOf("/scripts/")===-1&&(i.indexOf("/next/")!==-1?o+="-next":i.indexOf("/beta/")!==-1&&(o+="-beta")),nu=o+(e?".mod":"");break}}}catch(s){}}()}),If,Ef,nm=L(()=>{ft(),be(),If=["snippet","getDefaultConfig","_hasLegacyInitializers","_queue","_processLegacyInitializers"],Ef=function(){function t(e,n){this._hasLegacyInitializers=!1,this._queue=[],this.config=t.getDefaultConfig(e.config),this.appInsightsNew=n,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return u(t,"t"),t.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=30*60*1e3,e.sessionExpirationMs=24*60*60*1e3,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=Ue(e.enableDebug),e.disableExceptionTracking=Ue(e.disableExceptionTracking),e.disableTelemetry=Ue(e.disableTelemetry),e.verboseLogging=Ue(e.verboseLogging),e.emitLineDelimitedJson=Ue(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=Ue(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=Ue(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=Ue(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=Ue(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=Ue(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=Ue(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=Ue(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=Ue(e.isRetryDisabled),e.isCookieUseDisabled=Ue(e.isCookieUseDisabled),e.isStorageUseDisabled=Ue(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Ue(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=Ue(e.enableCorsCorrelation),e},t.prototype.addTelemetryInitializers=function(e){var n=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer(function(r){n._processLegacyInitializers(r)}),this._hasLegacyInitializers=!0),this._queue.push(e)},t.prototype.getCookieMgr=function(){return this.appInsightsNew.getCookieMgr()},t.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},t.prototype.stopTrackPage=function(e,n,r,i){this.appInsightsNew.stopTrackPage(e,n,r)},t.prototype.trackPageView=function(e,n,r,i,o){var a={name:e,uri:n,properties:r,measurements:i};this.appInsightsNew.trackPageView(a)},t.prototype.trackEvent=function(e,n,r){this.appInsightsNew.trackEvent({name:e})},t.prototype.trackDependency=function(e,n,r,i,o,a,s){this.appInsightsNew.trackDependencyData({id:e,target:r,type:i,duration:o,properties:{HttpMethod:n},success:a,responseCode:s})},t.prototype.trackException=function(e,n,r,i,o){this.appInsightsNew.trackException({exception:e})},t.prototype.trackMetric=function(e,n,r,i,o,a){this.appInsightsNew.trackMetric({name:e,average:n,sampleCount:r,min:i,max:o})},t.prototype.trackTrace=function(e,n,r){this.appInsightsNew.trackTrace({message:e,severityLevel:r})},t.prototype.flush=function(e){this.appInsightsNew.flush(e)},t.prototype.setAuthenticatedUserContext=function(e,n,r){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,n,r)},t.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},t.prototype._onerror=function(e,n,r,i,o){this.appInsightsNew._onerror({message:e,url:n,lineNumber:r,columnNumber:i,error:o})},t.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,n,r){this.appInsightsNew.stopTrackEvent(e,n,r)},t.prototype.downloadAndSetup=function(e){$n("downloadAndSetup not implemented in web SKU")},t.prototype.updateSnippetDefinitions=function(e){ed(e,this,function(n){return n&&If.indexOf(n)===-1})},t.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var n=this.trackPageView;this.trackPageView=function(o,a,s){n.apply(e,[null,o,a,s])}}var r="logPageView";typeof this.snippet[r]=="function"&&(this[r]=function(o,a,s){e.trackPageView(null,o,a,s)});var i="logEvent";return typeof this.snippet[i]=="function"&&(this[i]=function(o,a,s){e.trackEvent(o,a,s)}),this},t.prototype._processLegacyInitializers=function(e){return e.tags[ho]=this._queue,e},t}()}),kf,rm=L(()=>{nm(),xf(),be(),kf=function(){function t(){}return u(t,"t"),t.getAppInsights=function(e,n){var r=new iu(e),i=n!==2;if(co(),n===2)return r.updateSnippetDefinitions(e),r.loadAppInsights(i),r;var o=new Ef(e,r);return o.updateSnippetDefinitions(e),r.loadAppInsights(i),o},t}()}),Rf={};Sc(Rf,{AppInsightsCore:()=>cl,ApplicationAnalytics:()=>$l,ApplicationInsights:()=>iu,ApplicationInsightsContainer:()=>kf,BaseCore:()=>al,BaseTelemetryPlugin:()=>fi,CoreUtils:()=>vs,DependenciesPlugin:()=>tu,DistributedTracingModes:()=>An,Event:()=>Pn,Exception:()=>Ut,LoggingSeverity:()=>q,Metric:()=>jn,NotificationManager:()=>sl,PageView:()=>Fn,PageViewPerformance:()=>mr,PerfEvent:()=>io,PerfManager:()=>Vc,PropertiesPlugin:()=>Ql,RemoteDependencyData:()=>Gn,Sender:()=>Gl,SeverityLevel:()=>oa,Telemetry:()=>_f,Trace:()=>vr,Util:()=>Rl,_InternalMessageId:()=>B,doPerf:()=>ro});var im=L(()=>{xf(),rm(),be(),ft(),of(),qh(),wf(),bf()}),wt;(function(t){t.ON="on",t.ERROR="error",t.OFF="off"})(wt||(wt={}));function So(){let t="telemetry",e="enableTelemetry";try{let n=f.env.telemetryConfiguration;return n.isUsageEnabled&&n.isErrorsEnabled&&n.isCrashEnabled?wt.ON:n.isErrorsEnabled&&n.isCrashEnabled?wt.ERROR:wt.OFF}catch(n){return f.env.isTelemetryEnabled!==void 0?f.env.isTelemetryEnabled?wt.ON:wt.OFF:f.workspace.getConfiguration(t).get(e)?wt.ON:wt.OFF}}u(So,"At");var om=u(class{constructor(t,e){this._isInstantiated=!1,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=e,this._key=t,So()!==wt.OFF&&this.instantiateAppender()}logEvent(t,e){if(!this._telemetryClient){!this._isInstantiated&&So()===wt.ON&&this._eventQueue.push({eventName:t,data:e});return}this._telemetryClient.logEvent(t,e)}logException(t,e){if(!this._telemetryClient){!this._isInstantiated&&So()!==wt.OFF&&this._exceptionQueue.push({exception:t,data:e});return}this._telemetryClient.logException(t,e)}flush(){return Oi(this,null,function*(){this._telemetryClient&&(yield this._telemetryClient.flush(),this._telemetryClient=void 0)})}_flushQueues(){this._eventQueue.forEach(({eventName:t,data:e})=>this.logEvent(t,e)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:t,data:e})=>this.logException(t,e)),this._exceptionQueue=[]}instantiateAppender(){this._isInstantiated||this._clientFactory(this._key).then(t=>{this._telemetryClient=t,this._isInstantiated=!0,this._flushQueues()}).catch(t=>{console.error(t)})}},"Fi"),am=u(class{constructor(t,e,n,r,i){this.extensionId=t,this.extensionVersion=e,this.telemetryAppender=n,this.osShim=r,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!i,this.updateUserOptStatus(),f.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(f.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(f.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(f.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let t=So();this.userOptIn=t===wt.ON,this.errorOptIn=t===wt.ERROR||this.userOptIn,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(t){if(!t)return"none";let e="other";return["ssh-remote","dev-container","attached-container","wsl","codespaces"].forEach(n=>{t.indexOf(`${n}`)===0&&(e=n)}),e}get extension(){return this._extension===void 0&&(this._extension=f.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(t,e){if(t===null||typeof t!="object"||typeof e!="function")return t;let n={};for(let r in t)n[r]=e(r,t[r]);return n}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?!(f.env.remoteName&&this.cleanRemoteName(f.env.remoteName)==="other"):!0}getCommonProperties(){let t=Object.create(null);if(t["common.os"]=this.osShim.platform,t["common.nodeArch"]=this.osShim.architecture,t["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),t["common.extname"]=this.extensionId,t["common.extversion"]=this.extensionVersion,f&&f.env){switch(t["common.vscodemachineid"]=f.env.machineId,t["common.vscodesessionid"]=f.env.sessionId,t["common.vscodeversion"]=f.version,t["common.isnewappinstall"]=f.env.isNewAppInstall?f.env.isNewAppInstall.toString():"false",t["common.product"]=f.env.appHost,f.env.uiKind){case f.UIKind.Web:t["common.uikind"]="web";break;case f.UIKind.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}t["common.remotename"]=this.cleanRemoteName(f.env.remoteName)}return t}anonymizeFilePaths(t,e){let n;if(t==null)return"";let r=[];f.env.appRoot!==""&&r.push(new RegExp(f.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&r.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let i=t;if(e){let o=[];for(let l of r)for(;(n=l.exec(t))&&n;)o.push([n.index,l.lastIndex]);let a=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,c=0;for(i="";(n=s.exec(t))&&n;)n[0]&&!a.test(n[0])&&o.every(([l,d])=>n.index<l||n.index>=d)&&(i+=t.substring(c,n.index)+"<REDACTED: user-file-path>",c=s.lastIndex);c<t.length&&(i+=t.substr(c))}for(let o of r)i=i.replace(o,"");return i}removePropertiesWithPossibleUserInfo(t){if(typeof t!="object")return;let e=Object.create(null);for(let n of Object.keys(t)){let r=t[n];if(!r)continue;let i=/@[a-zA-Z0-9-.]+/,o=/(key|token|sig|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/,a=/xox[pbaors]-[a-zA-Z0-9]+-[a-zA-Z0-9-]+?/;o.test(r.toLowerCase())?e[n]="<REDACTED: secret>":i.test(r)?e[n]="<REDACTED: email>":a.test(r)?e[n]="<REDACTED: token>":e[n]=r}return e}get telemetryLevel(){switch(So()){case wt.ON:return"all";case wt.ERROR:return"error";case wt.OFF:return"off"}}sendTelemetryEvent(t,e,n){if(this.userOptIn&&t!==""){e=Vt(Vt({},e),this.getCommonProperties());let r=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(r),measurements:n})}}sendRawTelemetryEvent(t,e,n){this.userOptIn&&t!==""&&(e=Vt(Vt({},e),this.getCommonProperties()),this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:e,measurements:n}))}sendTelemetryErrorEvent(t,e,n,r){if(this.errorOptIn&&t!==""){e=Vt(Vt({},e),this.getCommonProperties());let i=this.cloneAndChange(e,(o,a)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(a,this.firstParty):r===void 0||r.indexOf(o)!==-1?"REDACTED":this.anonymizeFilePaths(a,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(i),measurements:n})}}sendTelemetryException(t,e,n){if(this.shouldSendErrorTelemetry()&&this.errorOptIn&&t){e=Vt(Vt({},e),this.getCommonProperties());let r=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));t.stack&&(t.stack=this.anonymizeFilePaths(t.stack,this.firstParty)),this.telemetryAppender.logException(t,{properties:this.removePropertiesWithPossibleUserInfo(r),measurements:n})}}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(t=>t.dispose()))}},"ki"),sm=u(t=>Oi(void 0,null,function*(){let e;try{let n=yield Promise.resolve().then(()=>(im(),Rf)),r;t&&t.indexOf("AIF-")===0&&(r="https://vortex.data.microsoft.com/collect/v1"),e=new n.ApplicationInsights({config:{instrumentationKey:t,endpointUrl:r,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!0,disableInstrumentationKeyValidation:!0}}),e.loadAppInsights();let i=So();r&&i!==wt.OFF&&fetch(r).catch(()=>e=void 0)}catch(n){return Promise.reject(n)}return{logEvent:(n,r)=>{e==null||e.trackEvent({name:n},Vt(Vt({},r==null?void 0:r.properties),r==null?void 0:r.measurements))},logException:(n,r)=>{e==null||e.trackException({exception:n,properties:Vt(Vt({},r==null?void 0:r.properties),r==null?void 0:r.measurements)})},flush:()=>Oi(void 0,null,function*(){e==null||e.flush()})}}),"Dl"),cm=u(class extends am{constructor(t,e,n,r){let i=new om(n,sm);n&&n.indexOf("AIF-")===0&&(r=!0);super(t,e,i,{release:navigator.appVersion,platform:"web",architecture:"web"},r)}},"xu");/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */const lm="Type of classified event does not match event properties",ou=u(class{constructor(t){this.context=t,this.sharedProperties={},ou._instance=this,this.reporter=new cm(t.extension.id,t.extension.packageJSON.version,ou.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(t,e){e!==lm&&this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e})}sendEvent(t,e,n){this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e},n)}sendErrorEvent(t,e,n,r){this.reporter.sendTelemetryErrorEvent(t,{...this.sharedProperties,...e},n,r)}sendException(t,e,n){this.reporter.sendTelemetryException(t,{...this.sharedProperties,...e},n)}setSharedProperty(t,e){this.sharedProperties[t]=e}reportWorkbenchLoadResult(t){const e="_codespaces.webeditor.connectWorkspace";f.env.appHost==="github.dev"&&(U.debug(`Executing ${e}`),t={...t,errorDetail:t.errorDetail instanceof Error?t.errorDetail.name:void 0},f.commands.executeCommand(e,t).then(n=>{},n=>{U.debug(`Failed to execute ${e}`,n)}))}},"_TelemetryService");let ha=ou;ha.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function fa(t){const e=performance.now()*.001;let n=Math.floor(e),r=Math.floor(e%1*1e9);return t!==void 0&&(n=n-t[0],r=r-t[1],r<0&&(n--,r+=1e9)),[n,r]}u(fa,"hrtime");let au=0;function um(){return au===Number.MAX_SAFE_INTEGER&&(au=0),++au}u(um,"getNextInstanceId");const bi=u(class{constructor(t,e,...n){this.context=t,this.instance=`[${um().toString().padStart(5)}] `;var r,i,o,a,s,c;let l;if(typeof(e==null?void 0:e.log)=="boolean"?l=e.log?{}:void 0:l=(r=e==null?void 0:e.log)!=null?r:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:it.Info,this.time=fa(),l){if(!U.enabled(this.logLevel))return;n.length?Us(this.logLevel,`${this.instance}${(o=l.prefix)!=null?o:""}${t}${(a=l.message)!=null?a:""}`,...n):Us(this.logLevel,`${this.instance}${(s=l.prefix)!=null?s:""}${t}${(c=l.message)!=null?c:""}`)}}log(t){this.logCore(this.context,t,!1)}logStep(t,e){(!t||e)&&this.logCore(this.context,e,!1),this.step=t?{time:fa(),label:t}:void 0}restart(t){this.logCore(this.context,t,!0),this.step=void 0,this.time=fa()}stop(t){this.restart(t)}logCore(t,e,n){var r,i,o,a,s,c,l;if(!U.enabled(this.logLevel))return;let d="";if(this.step){const[y,v]=fa(this.step.time),m=y*1e3+Math.floor(v/1e6);d=`${this.step.label?`${this.step.label} took `:""}${m} ms`}if(!n){Us(this.logLevel,`${this.instance}${(r=e==null?void 0:e.prefix)!=null?r:""}${t}${(i=e==null?void 0:e.message)!=null?i:""}${d?` ${d}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[h,g]=fa(this.time),p=h*1e3+Math.floor(g/1e6);Us(p>500?it.Warn:this.logLevel,`${this.instance}${(a=e==null?void 0:e.prefix)!=null?a:""}${t}${(s=e==null?void 0:e.message)!=null?s:""}${(c=e==null?void 0:e.took)!=null?c:" took "}${p} ms${d?` (${d})`:""}${(l=e==null?void 0:e.suffix)!=null?l:""}`)}static start(t,e,...n){var r;(r=bi.watches.get(t))==null||r.log(),bi.watches.set(t,new bi(t,e,...n))}static log(t,e){var n;(n=bi.watches.get(t))==null||n.log(e)}static stop(t,e){var n;(n=bi.watches.get(t))==null||n.stop(e),bi.watches.delete(t)}},"_Stopwatch");let Pe=bi;Pe.watches=new Map;function Us(t,e,...n){switch(t){case it.Warn:U.warn(e,...n);break;case it.Info:U.log(e,...n);break;default:U.debug(e,...n);break}}u(Us,"log");class Df{constructor(e){this.providerService=e,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=f.Disposable.from(e.onDidChangeRepositories(n=>{for(const r of n.added)this.repositoryOpened(r);for(const r of n.removed)this.repositoryClosed(r)}),de.onDidChange(n=>{for(const r of this.services.values()){const i=r.service.getRepository();n.affectsConfiguration("remoteHub.richNavigation.indexMode",i.uri)&&r.service.updateIndexMode().catch(o=>{U.error(o)})}}));for(const n of this.providerService.repositories)this.repositoryOpened(n)}dispose(){this.disposable.dispose()}register(e){const n=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(n,1)}}async repositoryOpened(e){const n=N(e.uri);if(!this.handledRepositories.has(n)){this.handledRepositories.add(n);for(const r of this.providers){const i=await r.createNavigationService(this.providerService,e);if(i!==void 0){const o=i();this.services.set(n,{service:o});break}}}}repositoryClosed(e){const n=N(e.uri);this.handledRepositories.delete(n);const r=this.services.get(n);r!==void 0&&(r.service.dispose(),this.services.delete(N(e.uri)))}}u(Df,"CodeNavigationServices");const ga=globalThis.fetch;async function dm(t,e,n){const r=new AbortController;n.onCancellationRequested(()=>r.abort());try{return await globalThis.fetch(t,{...e,signal:r.signal})}catch(i){throw n.isCancellationRequested?new CancellationError:i}}u(dm,"fetchWithCancellation");async function Zw(t,e,n,r,i){if(n===0)throw new CancellationError;const o=new CancellationTokenSource;r.onCancellationRequested(()=>o.cancel());try{const a=await dm(t,e,o.token);if(a.body){const s=[];let c=0;const l=a.body.getReader();let d=3;for(;;){let{done:h,value:g}=await l.read();if(h){const y=s.reduce((C,w)=>C+w.length,0),v=new Uint8Array(y);let m=0;for(const C of s)v.set(C,m),m+=C.length;return v}g&&(s.push(g),c+=g.length);const p=Math.floor(c/(1024*1024));if(d<p){d=p;const y={message:p+" MB"};i.report(y)}if(n!==void 0&&c>n)throw l.cancel(),o.cancel(),new Error("LIMIT_HIT")}}}catch(a){throw r.isCancellationRequested?new CancellationError:a}throw new CancellationError}u(Zw,"fetchUInt8ArrayWithMaxSizeAndCancellation");/*! (c) Andrea Giammarchi - ISC */var Os={};try{(function(t,e){if(new t("q=%2B").get("q")!==e||new t({q:e}).get("q")!==e||new t([["q",e]]).get("q")!==e||new t(`q=
`).toString()!=="q=%0A"||new t({q:" &"}).toString()!=="q=+%26"||new t({q:"%zx"}).toString()!=="q=%25zx")throw t;Os.URLSearchParams=t})(URLSearchParams,"+")}catch(t){(function(e,n,r){"use strict";var i=e.create,o=e.defineProperty,a=/[!'\(\)~]|%20|%00/g,s=/%(?![0-9a-fA-F]{2})/g,c=/\+/g,l={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},d={append:function(w,_){y(this._ungap,w,_)},delete:function(w){delete this._ungap[w]},get:function(w){return this.has(w)?this._ungap[w][0]:null},getAll:function(w){return this.has(w)?this._ungap[w].slice(0):[]},has:function(w){return w in this._ungap},set:function(w,_){this._ungap[w]=[n(_)]},forEach:function(w,_){var E=this;for(var x in E._ungap)E._ungap[x].forEach(T,x);function T(W){w.call(_,W,n(x),E)}u(T,"invoke")},toJSON:function(){return{}},toString:function(){var w=[];for(var _ in this._ungap)for(var E=m(_),x=0,T=this._ungap[_];x<T.length;x++)w.push(E+"="+m(T[x]));return w.join("&")}};for(var h in d)o(g.prototype,h,{configurable:!0,writable:!0,value:d[h]});Os.URLSearchParams=g;function g(w){var _=i(null);switch(o(this,"_ungap",{value:_}),!0){case!w:break;case typeof w=="string":w.charAt(0)==="?"&&(w=w.slice(1));for(var E=w.split("&"),x=0,T=E.length;x<T;x++){var W=E[x],F=W.indexOf("=");-1<F?y(_,v(W.slice(0,F)),v(W.slice(F+1))):W.length&&y(_,v(W),"")}break;case r(w):for(var x=0,T=w.length;x<T;x++){var W=w[x];y(_,W[0],W[1])}break;case"forEach"in w:w.forEach(p,_);break;default:for(var G in w)y(_,G,w[G])}}u(g,"URLSearchParams");function p(w,_){y(this,_,w)}u(p,"addEach");function y(w,_,E){var x=r(E)?E.join(","):E;_ in w?w[_].push(x):w[_]=[x]}u(y,"appendTo");function v(w){return decodeURIComponent(w.replace(s,"%25").replace(c," "))}u(v,"decode");function m(w){return encodeURIComponent(w).replace(a,C)}u(m,"encode");function C(w){return l[w]}u(C,"replacer")})(Object,String,Array.isArray)}(function(t){var e=!1;try{e=!!Symbol.iterator}catch(r){}"forEach"in t||(t.forEach=u(function(i,o){var a=this,s=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(c){!c.length||c in s||(s[c]=a.getAll(c)).forEach(function(l){i.call(o,l,c,a)})})},"forEach")),"keys"in t||(t.keys=u(function(){return n(this,function(i,o){this.push(o)})},"keys")),"values"in t||(t.values=u(function(){return n(this,function(i,o){this.push(i)})},"values")),"entries"in t||(t.entries=u(function(){return n(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=u(function(){for(var i=this.entries(),o=i.next(),a=o.done,s=[],c=Object.create(null),l,d,h;!a;)h=o.value,d=h[0],s.push(d),d in c||(c[d]=[]),c[d].push(h[1]),o=i.next(),a=o.done;for(s.sort(),l=0;l<s.length;l++)this.delete(s[l]);for(l=0;l<s.length;l++)d=s[l],this.append(d,c[d].shift())},"sort"));function n(r,i){var o=[];return r.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var a=o.shift();return{done:a===void 0,value:a}}}}u(n,"iterator"),function(r){var i=r.defineProperty,o=r.getOwnPropertyDescriptor,a=u(function(h){function g(v,m){t.append.call(this,v,m),v=this.toString(),h.set.call(this._usp,v?"?"+v:"")}u(g,"append");function p(v){t.delete.call(this,v),v=this.toString(),h.set.call(this._usp,v?"?"+v:"")}u(p,"del");function y(v,m){t.set.call(this,v,m),v=this.toString(),h.set.call(this._usp,v?"?"+v:"")}return u(y,"set"),function(v,m){return v.append=g,v.delete=p,v.set=y,i(v,"_usp",{configurable:!0,writable:!0,value:m})}},"createSearchParamsPollute"),s=u(function(h){return function(g,p){return i(g,"_searchParams",{configurable:!0,writable:!0,value:h(p,g)}),p}},"createSearchParamsCreate"),c=u(function(h){var g=h.append;h.append=t.append,URLSearchParams.call(h,h._usp.search.slice(1)),h.append=g},"updateSearchParams"),l=u(function(h,g){if(!(h instanceof g))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+g.name)},"verifySearchParams"),d=u(function(h){var g=h.prototype,p=o(g,"searchParams"),y=o(g,"href"),v=o(g,"search"),m;!p&&v&&v.set&&(m=s(a(v)),r.defineProperties(g,{href:{get:function(){return y.get.call(this)},set:function(C){var w=this._searchParams;y.set.call(this,C),w&&c(w)}},search:{get:function(){return v.get.call(this)},set:function(C){var w=this._searchParams;v.set.call(this,C),w&&c(w)}},searchParams:{get:function(){return l(this,h),this._searchParams||m(this,new URLSearchParams(this.search.slice(1)))},set:function(C){l(this,h),m(this,C)}}}))},"upgradeClass");try{d(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&d(URL)}catch(h){}}(Object)})(Os.URLSearchParams.prototype,Object);const Tf=Os.URLSearchParams;var Hs,hm=new Uint8Array(16);function fm(){if(!Hs&&(Hs=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Hs))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Hs(hm)}u(fm,"rng");const gm=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function pm(t){return typeof t=="string"&&gm.test(t)}u(pm,"validate");const vm=pm;for(var bt=[],su=0;su<256;++su)bt.push((su+256).toString(16).substr(1));function mm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(bt[t[e+0]]+bt[t[e+1]]+bt[t[e+2]]+bt[t[e+3]]+"-"+bt[t[e+4]]+bt[t[e+5]]+"-"+bt[t[e+6]]+bt[t[e+7]]+"-"+bt[t[e+8]]+bt[t[e+9]]+"-"+bt[t[e+10]]+bt[t[e+11]]+bt[t[e+12]]+bt[t[e+13]]+bt[t[e+14]]+bt[t[e+15]]).toLowerCase();if(!vm(n))throw TypeError("Stringified UUID is invalid");return n}u(mm,"stringify");const wm=mm;function ym(t,e,n){t=t||{};var r=t.random||(t.rng||fm)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return wm(r)}u(ym,"v4");const Af=ym,ie=J.loadMessageBundle(),cu=60,lu=cu*60,pa=lu*24,Pf=pa*7,Ff=pa*30,Mf=pa*365;function _o(t,e){typeof t!="number"&&(t=t.getTime());const n=Math.round((new Date().getTime()-t)/1e3);if(n<-30)return ie("date.fromNow.in","in {0}",_o(new Date().getTime()+n*1e3,{ago:!1,short:e==null?void 0:e.short}));if(n<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?ie("date.fromNow.seconds.short.ago","secs ago"):ie("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?ie("date.fromNow.now.short","now"):ie("date.fromNow.now","Just now");let r;return n<cu?(r=n,(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.seconds.singular.short.ago","{0} sec ago",r):ie("date.fromNow.seconds.singular.ago","{0} second ago",r):(e==null?void 0:e.short)?ie("date.fromNow.seconds.plural.short.ago","{0} secs ago",r):ie("date.fromNow.seconds.plural.ago","{0} seconds ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.seconds.singular.short","{0} sec",r):ie("date.fromNow.seconds.singular","{0} second",r):(e==null?void 0:e.short)?ie("date.fromNow.seconds.plural.short","{0} secs",r):ie("date.fromNow.seconds.plural","{0} seconds",r)):n<lu?(r=Math.floor(n/cu),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.minutes.singular.short.ago","{0} min ago",r):ie("date.fromNow.minutes.singular.ago","{0} minute ago",r):(e==null?void 0:e.short)?ie("date.fromNow.minutes.plural.short.ago","{0} mins ago",r):ie("date.fromNow.minutes.plural.ago","{0} minutes ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.minutes.singular.short","{0} min",r):ie("date.fromNow.minutes.singular","{0} minute",r):(e==null?void 0:e.short)?ie("date.fromNow.minutes.plural.short","{0} mins",r):ie("date.fromNow.minutes.plural","{0} minutes",r)):n<pa?(r=Math.floor(n/lu),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.hours.singular.short.ago","{0} hr ago",r):ie("date.fromNow.hours.singular.ago","{0} hour ago",r):(e==null?void 0:e.short)?ie("date.fromNow.hours.plural.short.ago","{0} hrs ago",r):ie("date.fromNow.hours.plural.ago","{0} hours ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.hours.singular.short","{0} hr",r):ie("date.fromNow.hours.singular","{0} hour",r):(e==null?void 0:e.short)?ie("date.fromNow.hours.plural.short","{0} hrs",r):ie("date.fromNow.hours.plural","{0} hours",r)):n<Pf?(r=Math.floor(n/pa),(e==null?void 0:e.ago)?r===1?ie("date.fromNow.days.singular.ago","{0} day ago",r):ie("date.fromNow.days.plural.ago","{0} days ago",r):r===1?ie("date.fromNow.days.singular","{0} day",r):ie("date.fromNow.days.plural","{0} days",r)):n<Ff?(r=Math.floor(n/Pf),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.weeks.singular.short.ago","{0} wk ago",r):ie("date.fromNow.weeks.singular.ago","{0} week ago",r):(e==null?void 0:e.short)?ie("date.fromNow.weeks.plural.short.ago","{0} wks ago",r):ie("date.fromNow.weeks.plural.ago","{0} weeks ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.weeks.singular.short","{0} wk",r):ie("date.fromNow.weeks.singular","{0} week",r):(e==null?void 0:e.short)?ie("date.fromNow.weeks.plural.short","{0} wks",r):ie("date.fromNow.weeks.plural","{0} weeks",r)):n<Mf?(r=Math.floor(n/Ff),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.months.singular.short.ago","{0} mo ago",r):ie("date.fromNow.months.singular.ago","{0} month ago",r):(e==null?void 0:e.short)?ie("date.fromNow.months.plural.short.ago","{0} mos ago",r):ie("date.fromNow.months.plural.ago","{0} months ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.months.singular.short","{0} mo",r):ie("date.fromNow.months.singular","{0} month",r):(e==null?void 0:e.short)?ie("date.fromNow.months.plural.short","{0} mos",r):ie("date.fromNow.months.plural","{0} months",r)):(r=Math.floor(n/Mf),(e==null?void 0:e.ago)?r===1?(e==null?void 0:e.short)?ie("date.fromNow.years.singular.short.ago","{0} yr ago",r):ie("date.fromNow.years.singular.ago","{0} year ago",r):(e==null?void 0:e.short)?ie("date.fromNow.years.plural.short.ago","{0} yrs ago",r):ie("date.fromNow.years.plural.ago","{0} years ago",r):r===1?(e==null?void 0:e.short)?ie("date.fromNow.years.singular.short","{0} yr",r):ie("date.fromNow.years.singular","{0} year",r):(e==null?void 0:e.short)?ie("date.fromNow.years.plural.short","{0} yrs",r):ie("date.fromNow.years.plural","{0} years",r))}u(_o,"fromNow");var Nf,Dt;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Dt||(Dt={}));class Lf{constructor(){this[Nf]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,n=Dt.None){const r=this._map.get(e);if(!!r)return n!==Dt.None&&this.touch(r,n),r.value}set(e,n,r=Dt.None){let i=this._map.get(e);if(i)i.value=n,r!==Dt.None&&this.touch(i,r);else{switch(i={key:e,value:n,next:void 0,previous:void 0},r){case Dt.None:this.addItemLast(i);break;case Dt.First:this.addItemFirst(i);break;case Dt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const n=this._map.get(e);if(!!n)return this._map.delete(e),this.removeItem(n),this._size--,n.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,n){const r=this._state;let i=this._head;for(;i;){if(n?e.bind(n)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const i={value:n.key,done:!1};return n=n.next,i}return{value:void 0,done:!0}}};return r}values(){const e=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const i={value:n.value,done:!1};return n=n.next,i}return{value:void 0,done:!0}}};return r}entries(){const e=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(n){const i={value:[n.key,n.value],done:!1};return n=n.next,i}return{value:void 0,done:!0}}};return r}[(Nf=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let n=this._head,r=this.size;for(;n&&r>e;)this._map.delete(n.key),n=n.next,r--;this._head=n,this._size=r,n&&(n.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const n=e.next,r=e.previous;if(!n||!r)throw new Error("Invalid list");n.previous=r,r.next=n}e.next=void 0,e.previous=void 0,this._state++}touch(e,n){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(n!==Dt.First&&n!==Dt.Last)){if(n===Dt.First){if(e===this._head)return;const r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(n===Dt.Last){if(e===this._tail)return;const r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((n,r)=>{e.push([r,n])}),e}fromJSON(e){this.clear();for(const[n,r]of e)this.set(n,r)}}u(Lf,"LinkedMap");class Cr extends Lf{constructor(e,n=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,n),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,n=Dt.AsNew){return super.get(e,n)}peek(e){return super.get(e,Dt.None)}set(e,n){return super.set(e,n,Dt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}u(Cr,"LRUCache");class Uf{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await f.commands.executeCommand(this.menuItem.command,e)}}u(Uf,"ContinueOnCommandQuickPickItem");var uu;(function(t){async function e(n,r,i){const o=Cm(n).map(c=>new Uf(c)),a=f.window.createQuickPick(),s=[];try{return await new Promise(l=>{s.push(a.onDidHide(()=>l(void 0)),a.onDidAccept(()=>{if(a.activeItems.length!==0){const[d]=a.activeItems;l(d)}})),a.title=i,a.placeholder=r,a.items=o,a.show()})}finally{a.dispose(),s.forEach(c=>void c.dispose())}}u(e,"show"),t.show=e})(uu||(uu={}));function Cm(t){var e,n,r,i,o;const a=new Map,[,s]=t.split(".");for(const l of f.extensions.all){const{name:d,displayName:h,contributes:g}=l.packageJSON;if(!g)continue;const p=(n=(e=g.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:n.continueOn;if(p==null?void 0:p.length){const y=new Map(((r=g.commands)!=null?r:[]).map(v=>[v.command,v]));for(const v of p){if(!v.command)continue;if(a.has(v.command)){U.warn(`Duplicate 'continueOn' menu command: ${v.command}`);continue}const m=y.get(v.command);if(!m){U.warn(`Unable to find 'continueOn' menu command: ${v.command}`);continue}if(!bm(v.when))continue;const C=(o=(i=v.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;a.set(v.command,{extension:{id:d,name:h,builtin:d===s},command:m.command,title:m.title,icon:typeof m.icon=="string"?m.icon:void 0,group:C>0?v.group.substr(0,C):v.group,order:C>0?Number(v.group.substr(C+1)):0,category:m.category})}}}function c(l,d){const h=l.group,g=d.group;if(h!==g){if(!h)return 1;if(!g||h==="navigation")return-1;if(g==="navigation")return 1;const p=h.localeCompare(g);if(p!==0)return p}return l.order<d.order?-1:l.order>d.order?1:l.title.localeCompare(d.title)}return u(c,"compareMenuItems"),[...a.values()].sort(c)}u(Cm,"getContinueOnContributions");function bm(t){return t?t.split("&&").every(e=>{const n=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!n)return!0;const[,r,i,o,a,s]=n;if(i){if(i==="false")return!1;if(!Hn(i))return!0;const c=Mr(i);return r?!c:c}if(o&&a&&s)switch(a){case"==":return!Hn(o)||!Hn(s)||Mr(o)==Mr(s);case"!=":return!Hn(o)||!Hn(s)||Mr(o)!=Mr(s);case"=~":{if(!Hn(o))return!0;const c=Mr(o);try{return new RegExp(s.slice(1,-1)).test(String(c!=null?c:""))}catch{return!1}}}return!0}):!0}u(bm,"evaluateWhenClause");function Sm(t){return t!==void 0&&typeof t.then=="function"}u(Sm,"isPromise");const _m="";function xm(...t){if(t.length===1){const e=t[0];return e===void 0?_m:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof f.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}u(xm,"defaultResolver");function br(t){return(e,n,r)=>{let i;if(typeof r.value=="function"?i=r.value:typeof r.get=="function"&&(i=r.get),i===void 0)throw new Error("Not supported");const o=`$gate$${n}`;r.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:xm)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let c=this[s];if(c===void 0){let l;try{if(l=i.apply(this,a),l==null||!Sm(l))return l;this[s]=c=l.then(d=>(this[s]=void 0,d)).catch(d=>{throw this[s]=void 0,d})}catch(d){throw this[s]=void 0,d}}return c}}}u(br,"gate");var Im=Object.defineProperty,Em=Object.getOwnPropertyDescriptor,Ws=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Em(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Im(e,n,i),i},"__decorateClass");const pn=J.loadMessageBundle();class xo{showGitHubStatus500Message(){return f.window.showErrorMessage(pn("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),pn("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void f.window.showErrorMessage(pn("401 error notification","The provided credentials are either invalid or expired."),pn("ok","OK"));const n=pn("401 error notification confirm","Reauthenticate");await f.window.showErrorMessage(pn("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),n)===n&&e()}async showStatus403Message(e){if(!e)return void f.window.showErrorMessage(pn("403 error notification","The provided credentials do not have the required access."),pn("ok","OK"));const n=pn("403 error notification confirm","Reauthenticate"),r=pn("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?");await f.window.showErrorMessage(r,n)===n&&e()}async showProviderNotFoundMessage(e){const n=km.get(e.id);if(n&&f.extensions.getExtension(n[0])===void 0){const r=pn("provider extension missing install","Install");if(await f.window.showInformationMessage(pn("provider extension not installed","Extension '{0}' is not installed. Would you like to install the extension and reload the window to open this workspace?",n[1]),{modal:!0},r)!==r)return;await f.commands.executeCommand("workbench.extensions.installExtension",n[0]),await f.commands.executeCommand("workbench.action.reloadWindow")}}}u(xo,"Messages"),Ws([br(()=>"")],xo.prototype,"showGitHubStatus500Message",1),Ws([br(()=>"")],xo.prototype,"showStatus401Message",1),Ws([br(()=>"")],xo.prototype,"showStatus403Message",1),Ws([br()],xo.prototype,"showProviderNotFoundMessage",1);const km=new Map([["github",["GitHub.remotehub","GitHub Repositories"]],["azurerepos",["ms-vscode.azure-repos","Azure Repos"]]]),du=new xo,Bs=J.loadMessageBundle();async function Mn(t,e,n){var r,i,o,a,s;if(ha.instance.sendEvent("openWorkspace",{location:e.location}),e.location===Ke.AddToWorkspace){const l=(i=(r=f.workspace.workspaceFolders)==null?void 0:r.length)!=null?i:0;return void f.workspace.updateWorkspaceFolders(l,0,{uri:e.uri,name:e.name})}if(e.location===Ke.CurrentWindow&&!(n==null?void 0:n.skipChangesPrompt)){const l=await t.getWorkspaceProvidersWithChanges();if(l.length){const d={title:Bs("continue","Continue")},h={title:Bs("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showWarningMessage(Sn?Bs("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(p=>p.name).join(", ")):Bs("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(p=>p.name).join(", ")),{modal:!0},d,h)!==d){ha.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const c=f.env.remoteName?!0:void 0;return e.filesToOpen&&(e.location===Ke.CurrentWindow&&c===void 0&&((o=f.workspace.workspaceFolders)==null?void 0:o.length)===1&&f.workspace.workspaceFolders[0].uri.toString()===e.uri.toString()?await((a=lc())==null?void 0:a.openPendingFiles(e.uri,e.filesToOpen)):await((s=lc())==null?void 0:s.setPendingFilesToOpen(e.uri,e.filesToOpen))),ha.instance.sendEvent("openWorkspace.success",{location:e.location,forceLocalWindow:String(c)}),void f.commands.executeCommand("vscode.openFolder",e.uri,{forceNewWindow:e.location===Ke.NewWindow,forceLocalWindow:c})}u(Mn,"openWorkspace");const ze=J.loadMessageBundle();function Rm(t,e,n){let r=!1;async function i(){var a;if(await Qt(t,void 0),!r){const c=t.getRemoteSourceProviders(),l=await((a=f.extensions.getExtension("vscode.git-base"))==null?void 0:a.activate()),d=l==null?void 0:l.getAPI(1);if(!d)return;c.map(h=>d.registerRemoteSourceProvider(h)),r=!0}const s=await f.commands.executeCommand("git-base.api.getRemoteSources",{title:ze("open remote repository","Open Remote Repository"),placeholder:ze("open repo placeholder","Enter a remote url, or select a remote provider"),showRecentSources:!0,providerLabel:c=>{var l;return(l=c.label)!=null?l:`Open Repository from ${c.name}`},urlLabel:c=>{const l=t.canOpenRemoteUrl(c);if(l){const{provider:d,urlType:h}=l;switch(h){case rr.Branch:return ze("remote url picker open branch","Open Branch from {0} Repository",d.name);case rr.Tag:return ze("remote url picker open tag","Open Tag from {0} Repository",d.name);case rr.Commit:return ze("remote url picker open commit","Open Commit from {0} Repository",d.name);case rr.File:return ze("remote url picker open file","Open File from {0} Repository",d.name);case rr.PullRequest:return ze("remote url picker open pull request","Open Pull Request from {0} Repository",d.name);default:return ze("remote url picker open repository","Open {0} Repository",d.name)}}return ze("remote url picker open unknown","Enter a Remote Url")}});if(!!s)try{const l=f.workspace.getConfiguration("window").get("openFoldersInNewWindow")==="on"?Ke.NewWindow:Ke.CurrentWindow,d=await t.createWorkspaceForRemoteUrl(s,void 0,l);if(!d)return;await Mn(t,d)}catch(c){if(n.sendException(c),nt.asVirtualProviderErrorCode(c)===Qe.InvalidCredentialsError){const{action:l}=c;if(l){du.showStatus401Message(()=>l());return}}U.error(c)}}u(i,"openRepository");async function o(a,s,c){if(c==null?void 0:c.workspaceFolder){const d=t.getRepository(c.workspaceFolder,s);if(d!==void 0)return d}const l=s?t.repositories.filter(d=>d.provider.id===s):t.repositories;if(l.length!==0){if(l.length>1){const d=await f.window.showQuickPick(l.map(h=>({label:h.name,description:h.provider.name,repository:h})),{placeHolder:a});return d?d.repository:void 0}return l[0]}}return u(o,"getRepository"),[f.commands.registerCommand("remoteHub.openRepository",()=>(n.sendEvent("command.openRepository"),i())),f.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(n.sendEvent("command.continueOn.openRepository"),i())),f.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{n.sendEvent("command.continueOn.openRepository")}),f.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{n.sendEvent("command.continueOn.openRepository")}),f.commands.registerCommand("remoteHub.continueOn",async()=>{var a;const s=await o(ze("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(s===void 0)return;n.sendEvent("command.continueOn");const c=await uu.show(e,ze("continue on placeholder","Choose how you would like to continue working"),ze("continue on title","Continue '{0}' on",s.name));if(!c){n.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await t.changeStoreHasChanges(s.uri)){const d={title:ze("continue","Continue")},h={title:ze("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showWarningMessage(ze("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0},d,h)!==d){n.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const{HEAD:l}=await s.getMetadata();if(((a=l.branch)==null?void 0:a.remote)!==void 0){const h=t.getRemoteUri(s.provider.id,{repo:l.branch.remote.repo}).toString(!0),g=await t.createWorkspaceForRemoteUrl(h);if(!g)throw new Error(`Unable to create workspace for URL: ${h}`);await c.execute({provider:s.provider,workspaceFolder:g.uri,name:l.branch.remote.name,url:h,ref:l.branch.name})}else{const d=t.getRemoteUri(s.provider.id,{repo:s.id});await c.execute({provider:s.provider,workspaceFolder:s.uri,name:s.name,url:d==null?void 0:d.toString(!0),ref:l.name})}}),f.commands.registerCommand("remoteHub.openOnDesktop",async a=>{if(!Sn)return;const s=await o(ze("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,a);if(s===void 0)return;const c=await t.getBestRemoteUri(s.uri);c!==void 0&&(n.sendEvent("command.openOnDesktop"),f.env.openExternal(f.Uri.parse(`${f.env.uriScheme}://${e}/open?url=${encodeURIComponent(c.toString(!0))}`)))}),f.commands.registerCommand("remoteHub.openOnWeb",async a=>{if(Sn)return;const s=await o(ze("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,a);if(s===void 0)return;const c=await t.getBestRemoteUri(s.uri);c!==void 0&&(n.sendEvent("command.openOnWeb"),f.env.openExternal(c))}),f.commands.registerCommand("remoteHub.goToRepository",async()=>{var a,s;n.sendEvent("command.goToRepository");const c=await o(ze("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!c)return;const l=await t.getMetadata(c.uri);let d;const h={provider:c.provider,repo:c.id,path:((a=f.window.activeTextEditor)==null?void 0:a.document.uri)&&f.window.activeTextEditor.document.uri.scheme===ce.scheme?t.getRelativeFilePath(f.window.activeTextEditor.document.uri):void 0};return l.HEAD.type===ye.Branch&&(((s=f.window.activeTextEditor)==null?void 0:s.document)||l.defaultBranch.name!==l.HEAD.name)?d={...h,branch:l.HEAD.name}:l.HEAD.type===ye.Tag?d={...h,tag:l.HEAD.name}:l.HEAD.type===ye.Commit?d={...h,sha:l.HEAD.sha}:d={...h},f.commands.executeCommand("remoteHub.openOnRemote",d)}),f.commands.registerCommand("remoteHub.openOnRemote",async a=>{n.sendEvent("command.openOnRemote");const{provider:s,...c}=a,l=t.getRemoteUri(s.id,c);if(l){await f.env.openExternal(l);return}f.window.showErrorMessage(ze("open on remote command provider not supported","Unable to open the resource on {0}",a.provider.name))}),f.commands.registerCommand("remoteHub.clone",async a=>{const s=await o(ze("clone placeholder","Choose which repository to clone"),void 0,a);if(s!==void 0){if(n.sendEvent("command.clone"),a===void 0&&await t.changeStoreHasChanges(s.uri)){const c={title:ze("continue","Continue")},l={title:ze("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showWarningMessage(ze("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0},c,l)!==c){n.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await t.clone(s.uri)}}),f.commands.registerCommand("remoteHub.refresh",()=>void t.refresh()),f.commands.registerCommand("remoteHub.enableDebugLogging",()=>de.updateEffective("logLevel",it.Debug)),f.commands.registerCommand("remoteHub.disableDebugLogging",()=>de.updateEffective("logLevel",it.Warn)),f.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{t.changeStoreExportDebugInfo()}),f.commands.registerCommand("remoteHub.setContext",async(a,s)=>{if(!a.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await _n(a,s)}),f.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const a={title:ze("continue on","Continue Working On...")};await f.window.showInformationMessage(ze("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},a)===a&&await f.commands.executeCommand("remoteHub.continueOn")}),f.commands.registerCommand("remoteHub.remoteHelp.getStarted",()=>Sn?"https://aka.ms/vscode-web-docs":"https://aka.ms/vscode-remote/remote-repositories/getting-started")]}u(Rm,"registerCommands");function Nn(t){return t}u(Nn,"command");async function Of(t,e){return f.commands.executeCommand(t,e)}u(Of,"executeCommand");function Dm(t,e){return t.reduce((r,i)=>{const o=e(i),a=r.get(o);return a===void 0?r.set(o,[i]):a.push(i),r},new Map)}u(Dm,"groupBy");function e0(t){let e=0;for(const n of t){if(n===0)return!0;if(e++,e>8e3)break}return!1}u(e0,"isBinary");function Tm(t,e,n=r=>r){return[...t.reduce((i,o)=>{const a=e(o),s=i.get(a);if(s===void 0)i.set(a,o);else{const c=n(s,o);c!==void 0&&i.set(a,c)}return i},new Map).values()]}u(Tm,"uniqueBy");function $s(t,e){switch(t){case ye.Branch:case ye.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case ye.Tag:return"$(tag)";case ye.Commit:return"$(git-commit)"}}u($s,"headTypeToCodicon");function Hf(t){switch(t){case bn.Active:return"$(layers-active)";case bn.Match:return"$(layers-dot)";case bn.Indexed:return"$(layers)"}}u(Hf,"indexTypeToCodicon");function Am(t,e){switch(t){case ye.Branch:case ye.RemoteBranch:return e?new f.ThemeIcon("git-pull-request"):new f.ThemeIcon("git-branch");case ye.Tag:return new f.ThemeIcon("tag");case ye.Commit:return new f.ThemeIcon("git-commit")}}u(Am,"headTypeToThemeIcon");function*Pm(t,e){for(const n of t)yield*e(n)}u(Pm,"flatMap");function*Fm(t,e){for(const n of t)e(n)&&(yield n)}u(Fm,"filter");function*t0(t,e){for(const n of t){const r=e(n);r!=null&&(yield r)}}u(t0,"filterMap");function n0(t,e){for(const n of t)if(e(n))return n}u(n0,"find");function Mm(t,e){let n="";const r=t[Symbol.iterator]();let i=r.next();if(i.done)return n;for(;;){const o=i.value.toString();if(i=r.next(),i.done){n+=o;break}n+=o,n+=e}return n}u(Mm,"join");function*hu(t,e){for(const n of t)yield e(n)}u(hu,"map");function r0(t,e){for(const n of t)if(e(n))return!0;return!1}u(r0,"some");function*i0(...t){for(const e of t)for(const n of e)yield n}u(i0,"union");function*Nm(t){const e=new Set;for(const n of t)e.has(n)||(e.add(n),yield n)}u(Nm,"unique");const Lm="";function Um(...t){if(t.length===1){const e=t[0];return e===void 0?Lm:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof f.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}u(Um,"serialize_defaultResolver");function Vs(t){return(e,n,r)=>{let i;if(typeof r.value=="function"?i=r.value:typeof r.get=="function"&&(i=r.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${n}`;r.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:Um)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let c=this[s];const l=u(()=>i.apply(this,a),"run");return c===void 0?c=l():c=c.then(l,l),this[s]=c,c}}}u(Vs,"serialize");let fu=0;function Om(){return fu===Number.MAX_SAFE_INTEGER&&(fu=0),String(++fu)}u(Om,"getNextLockId");class Wf{constructor(){this.id=Om()}async synchronize(e){let n;const r=this.promise;this.promise=new Promise(i=>n=i),await r;try{return await e()}finally{n()}}}u(Wf,"Lock");class va{constructor(e){this.lock=new Wf,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,n){let r;const i=new Pe(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:n?` \u2022 ${n}`:""},logLevel:it.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(a=>r=a),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:n?` \u2022 ${n}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:n?` \u2022 ${n}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),r()}}async synchronizeWrite(e,n){let r;const i=new Pe(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:n?` \u2022 ${n}`:""},logLevel:it.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>r=o)}),i.restart({prefix:"(L) ",suffix:n?` \u2022 ${n}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:n?` \u2022 ${n}`:"",took:" locked for "}),r(),this.writer=void 0}}}u(va,"ReaderWriterLock");class Bf{constructor(){this.locks=new Map}async synchronizeRead(e,n,r){let i=this.locks.get(e);return i===void 0&&(i=new va(String(e)),this.locks.set(e,i)),i.synchronizeRead(n,r)}async synchronizeWrite(e,n,r){let i=this.locks.get(e);return i===void 0&&(i=new va(String(e)),this.locks.set(e,i)),i.synchronizeWrite(n,r)}}u(Bf,"KeyedReaderWriterLock");const rn=J.loadMessageBundle(),ma=u(class{constructor(t,e,n,r){this.providerService=t,this.storageService=e,this.changeStore=n,this.workspaceId=r,this._onDidChange=new f.EventEmitter,this.cache=new Map,this.lock=new va("WorkspaceRepositories"),this.disposable=f.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const t=await f.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void f.window.showTextDocument(t)}onChangeStoreChanged(t){const e=Tm(t.map(n=>n.rootUri),n=>N(n)).map(n=>this.providerService.getRepository(n)).filter(n=>Boolean(n));this.addOrUpdate(e)}onRepositoriesChanged(t){this.addOrUpdate(t.added)}onRepositoryChanged(t){this.addOrUpdate([t.repository])}async get(t){let e=await this.lock.synchronizeRead(async()=>{let n=this.cache.get("workspaceRepositories");return n===void 0&&(n=[...(await this.getCore()).values()].sort((r,i)=>i.timestamp-r.timestamp),this.cache.set("workspaceRepositories",n)),n},"WorkspaceRepositories.get");if(t){const n=N(t);e=e.filter(r=>N(r.canonicalUri)===n)}return e}async getCore(){return this.fromStorage(await this.storageService.get(ma.storageKey))}async getRecents(t=10){return(await this.get()).slice(0,t)}async getRemoteWorkspaceSourceProvider(t){const e=await this.getRecents();if(e.length!==0)return e.filter(n=>n.provider.id===t)}refresh(){this.cache.clear()}async remove(t){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),n=`${t.workspaceId}/${N(t.uri)}`,r=e.get(n);if(r===void 0)return;const i=this.changeStore.getScopedChangeStore(r),o=await i.getChanges(r.uri);if(o.length!==0){const a={title:rn("remove remote repo prompt confirm","Yes")},s={title:rn("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await f.window.showWarningMessage(o.length===1?rn("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):rn("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0},a,s)!==a)return;await i.discardAll(r.uri)}this.cache.clear(),e.delete(n);try{await this.storageService.store(ma.storageKey,this.toStorage(e))}catch(a){throw U.error(a,"Failed to save workspace repositories"),a}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(t){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const n of t){const[{HEAD:r,pullRequest:i},o]=await Promise.all([n.getMetadata(),n.getIndexMetadata()]),a=await this.changeStore.getChanges(n.uri);e.set(`${this.workspaceId}/${N(n.uri)}`,{workspaceId:this.workspaceId,uri:n.uri,canonicalUri:n.canonicalUri,name:n.name,provider:n.provider,ref:{type:r.type,name:r.name},idx:(o==null?void 0:o.type)&&bn.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:Wm(a),timestamp:Date.now()})}try{await this.storageService.store(ma.storageKey,this.toStorage(e))}catch(n){throw U.error(n,"Failed to save workspace repositories"),n}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(t){if(!t)return new Map;try{const e=JSON.parse(t,(n,r)=>(n==="uri"||n.endsWith("Uri"))&&Ar(r)?f.Uri.from(r):r);return new Map(e.workspaceRepositories)}catch(e){return U.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(t){const e={schemaVersion:ma.storageSchemaVersion,workspaceRepositories:[...t]};return JSON.stringify(e)}},"_WorkspaceRepositories");let $f=ma;$f.storageKey="workspaceRepositories",$f.storageSchemaVersion=1;function Vf(t){return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}u(Vf,"hasChanges");function Hm(t){return Vf(t.changes)}u(Hm,"hasUncommittedChanges");function Wm(t){let e=0,n=0,r=0;for(const i of t)switch(i.type){case D.Created:e++;break;case D.Changed:n++;break;case D.Deleted:r++;break}return e||n||r?{added:e,changed:n,deleted:r,timestamp:Date.now()}:void 0}u(Wm,"toChangesSummary");function gu(t,{compact:e=!0,preamble:n,separator:r=", ",short:i=!1,single:o=!1}={}){if(!Vf(t))return rn("no changes","Everything up to date");const{added:a,changed:s,deleted:c}=t;if(o){const d=a+s+c;return d===1?rn("summary change","{0} change",d):rn("changes changes","{0} changes",d)}let l=`${n!=null?n:""}`;return(a||!e)&&(l+=i?`+${a}`:a===1?rn("file added","{0} file added",a):rn("files added","{0} files added",a),(s||c||!e)&&(l+=r)),(s||!e)&&(l+=i?`~${s}`:s===1?rn("file changed","{0} file changed",s):rn("files changed","{0} files changed",s),(c||!e)&&(l+=r)),(c||!e)&&(l+=i?`-${c}`:c===1?rn("file deleted","{0} file deleted",c):rn("files deleted","{0} files deleted",c)),l}u(gu,"formatChangesSummary");class Ht extends Error{constructor(e){var n;const r=typeof e=="string"?e:Wt.getProviderId(e);super(`No provider registered with ${r}`);this.id=r,(n=Error.captureStackTrace)==null||n.call(Error,this,Ht)}}u(Ht,"ProviderNotFoundError");class qf{constructor(e,n,r,i,o){this.providerService=e,this.uri=n,this.id=r,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}u(qf,"VirtualRepository");var on;(function(t){t[t.Clone=-1]="Clone",t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.Tag=4]="Tag"})(on||(on={}));var De;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(De||(De={})),function(t){function e(n){return n!==void 0&&(n===t.Indexed||n===t.Match||n===t.Active)}u(e,"hasIndex"),t.hasIndex=e}(De||(De={}));var pu;(function(t){function e(n){return n!==void 0&&n.type===3}u(e,"isActive"),t.isActive=e})(pu||(pu={}));var an;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(an||(an={}));var Si;(function(t){function e(n){const r=ce.decodeAuthority(n).metadata;if(!(r===void 0||r.idx===void 0)){if(r.idx==="latest")return{type:1};if(rt(r.idx))return{type:2,sha:r.idx}}}u(e,"decode"),t.decode=e})(Si||(Si={}));var o0=et(724),Bm=Object.defineProperty,$m=Object.getOwnPropertyDescriptor,Vm=u((t,e,n,r)=>{for(var i=r>1?void 0:r?$m(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Bm(e,n,i),i},"providers_decorateClass");const qm=J.loadMessageBundle(),Gt=u(class{constructor(t){this.telemetryService=t,this._providers=new Map,this._indexProviders=new Map,this._onDidChangeProviders=new f.EventEmitter,this._onDidChangeChangeStore=new f.EventEmitter,this._onDidChangeWorkspaceRepositories=new f.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new f.EventEmitter,this._onDidChangeRepository=new f.EventEmitter,this._onDidSyncRepository=new f.EventEmitter,this._onDidRefresh=new f.EventEmitter,this._onWillRefresh=new f.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=f.Disposable.from(f.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeChangeStore(){return this._onDidChangeChangeStore.event}get onDidChangeWorkspaceRepositories(){return this._onDidChangeWorkspaceRepositories.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(t){const e=this._repositories.get(N(t.uri));!e||(U.log(`VirtualProviderService.onMetadataChanged(${t.uri.toString()}, reason=${t.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:t.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(t){if(t.added.length)for(const e of t.added){const n=N(e.uri);if(e.uri.scheme!==Gt.scheme||this._repositories.has(n))continue;const r=this.getProvider(e.uri);if(!r)continue;this._repositories.set(n,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),a=new qf(this,e.uri,i,o,r);this._repositories.set(n,a),this._onDidChangeRepositories.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:r.id,repositories:this._repositories.size.toString()})}if(t.removed.length)for(const e of t.removed){const n=N(e.uri);if(e.uri.scheme!==Gt.scheme||!this._repositories.has(n))continue;const r=this._repositories.get(n);this._repositories.delete(n),r&&(this._onDidChangeRepositories.fire({added:[],removed:[r]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}_n(ar.HasVirtualFolders,this._repositories.size!==0),_n(ar.VirtualFolderProviders,Mm(Nm(hu(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...hu(this._providers.values(),t=>({id:t.id,name:t.name}))]}get repositories(){return[...this.getRepositories()]}registerVirtualIndexProvider(t,e){if(this._indexProviders.has(t))throw new Error(`Virtual index provider '${t}' has already been registered`);return this._indexProviders.set(t,e),{dispose:()=>{this._indexProviders.delete(t)}}}register(t,e,n,r,i,o,a,s){var c;if(this._providers.has(t))throw new Error(`Provider '${t}' has already been registered`);const l={id:t,name:e,provider:n,fs:r,storage:i,changeStore:o,metadataStore:a,workspaceRepositories:s};this._providers.set(t,l);const d=f.Disposable.from(l.metadataStore.onDidChange(h=>this.onMetadataChanged(h)),l.changeStore.onDidChange(h=>this._onDidChangeChangeStore.fire(h)),l.workspaceRepositories.onDidChange(async()=>{const h=await this.workspaceRepositoriesGetRepositories();_n(ar.HasRecentRepositories,h.length>0),this._onDidChangeWorkspaceRepositories.fire()}));return this._onDidChangeProviders.fire({added:[l],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:t}),this.onWorkspaceFoldersChanged({added:(c=f.workspace.workspaceFolders)!=null?c:[],removed:[]}),{dispose:()=>{this._providers.delete(t);const h=[];for(const[g,p]of[...this._repositories])(p==null?void 0:p.provider.id)===t&&(this._repositories.delete(g),h.push(p));this._onDidChangeRepositories.fire({added:[],removed:h}),this._onDidChangeProviders.fire({added:[],removed:[l]}),d.dispose()}}}refresh(){if(this._providers.size===0)return;const t=[],e=[];for(const n of this._providers.values()){t.push(...hu(this.getRepositories(n.id),i=>i.uri));const r=this._indexProviders.get(n.id);r!==void 0&&e.push(r)}this._onWillRefresh.fire(t),t.forEach(n=>this.getMetadataStore(n).refresh()),e.forEach(n=>n.refresh(t)),this._onDidRefresh.fire(t)}getRegisteredProvider(t){const e=this.getProvider(t);return e?{id:e.id,name:e.name}:void 0}getRepository(t,e){const n=f.workspace.getWorkspaceFolder(t);if(!n||n.uri.scheme!==Gt.scheme)return;const r=this._repositories.get(N(n.uri));if(!(e!==void 0&&(r==null?void 0:r.provider.id)!==e))return r!=null?r:void 0}getRepositories(t){return Fm(this._repositories.values(),e=>e!==null&&(!t||e.provider.id===t))}hasProvider(t,e){const n=typeof t=="string"?t:Gt.getProviderId(t),r=this._providers.get(n);return e!==void 0&&(r==null?void 0:r.id)!==e?!1:r!==void 0}getProvider(t){const e=typeof t=="string"?t:Gt.getProviderId(t);return this._providers.get(e)}getRepositoryProvider(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.provider;if(n)return n;throw new Ht(t)}getChangeStore(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.changeStore;if(n)return n;throw new Ht(t)}getMetadataStore(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.metadataStore;if(n)return n;throw new Ht(t)}getWorkspaceRepositories(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.workspaceRepositories;if(n)return n;throw new Ht(t)}getFileSystemProvider(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.fs;if(n)return n;throw new Ht(t)}getStorageService(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.storage;if(n)return n;throw new Ht(t)}async getRecentRemoteSourceProviders(){return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:qm("pick","Choose a recent repository"),getRemoteSources:async()=>{const t=[];for(const[,e]of this._providers.entries()){const n=await e.workspaceRepositories.getRemoteWorkspaceSourceProvider(e.id);t.push(...n!=null?n:[])}if(t.length!==0)return Promise.all(t.sort((e,n)=>n.timestamp-e.timestamp).map(async e=>({providerId:e.provider.id,name:e.name,icon:"repo",description:_o(e.timestamp,{ago:!0}),detail:`${e.provider.name}${e.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${e.pullRequest.id}`:""}${ce.isCanonicalUri(e.uri)?"":`\xA0\xA0\u2022\xA0\xA0${$s(e.ref.type)} ${e.ref.name}`}\xA0\xA0\u2022\xA0\xA0${gu(e.changes)}${e.idx?`\xA0\xA0\u2022\xA0\xA0${Hf(e.idx.type)}`:""}`,url:(await this.getBestRemoteUri(e.uri)).toString()})))}}}getRemoteSourceProviders(t){const e=u(n=>n.provider.getRemoteSourceProviders().map(i=>{var o;return{...i,getRecentRemoteSources:(o=i.getRecentRemoteSources)!=null?o:async()=>{var a;const s=(a=await n.workspaceRepositories.getRemoteWorkspaceSourceProvider(n.id))!=null?a:[];return Promise.all(s.map(async c=>({providerId:c.provider.id,name:c.name,icon:"repo",timestamp:c.timestamp,description:_o(c.timestamp,{ago:!0}),detail:`${c.provider.name}${c.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${c.pullRequest.id}`:""}${ce.isCanonicalUri(c.uri)?"":`\xA0\xA0\u2022\xA0\xA0${$s(c.ref.type)} ${c.ref.name}`}\xA0\xA0\u2022\xA0\xA0${gu(c.changes)}${c.idx?`\xA0\xA0\u2022\xA0\xA0${Hf(c.idx.type)}`:""}`,url:(await this.getBestRemoteUri(c.uri)).toString()})))}}}),"createRemoteSourceProviders");if(t){const n=this.getProvider(t);return n?e(n):[]}return[...Pm(this._providers.values(),n=>{var r;return(r=e(n))!=null?r:[]})]}async getWorkspaceProvidersWithChanges(){var t,e;const n=new Map;for(const r of(t=f.workspace.workspaceFolders)!=null?t:[])if(r.uri.scheme===ce.scheme&&await this.getChangeStore(r.uri).hasChanges(r.uri)){const i=(e=this.getRepository(r.uri))==null?void 0:e.provider;if(!i)continue;n.set(i.id,i)}return[...n.values()]}isInWorkspace(t){return this.getVirtualWorkspaceUri(t)!==void 0}getAuthentication(t){const e=this.getProvider(t);if(!e)throw new Ht(t);return e==null?void 0:e.provider.getAuthentication(t)}canOpenRemoteUrl(t,e){if(e){const n=this.getProvider(e),r=n==null?void 0:n.provider.canOpenRemoteUrl(t);return r!==void 0?{provider:n,urlType:r}:void 0}for(const n of this._providers.values()){const r=n.provider.canOpenRemoteUrl(t);if(r!==void 0)return{provider:n,urlType:r}}}async createWorkspaceForRemoteUrl(t,e,n=Ke.CurrentWindow){var r;const i=this.canOpenRemoteUrl(t,e);return(r=i==null?void 0:i.provider)==null?void 0:r.provider.createWorkspaceForRemoteUrl(t,n)}async openWorkspace(t,e){return Mn(this,t,e)}createProviderUri(t,e,n){return ce.getProviderUri(this.getRepositoryProvider(t).createVirtualUri(Gt.baseVirtualWorkspaceUri,e,n))}createRelativeProviderUri(t,e){return ce.getProviderUri(this.createRelativeUri(t,e))}createRelativeUri(t,e){const n=this.getProviderRootUri(t);let r=`${n.path}/`;r.endsWith("/")&&(r=r.slice(0,-1));const i=n.with({path:`${n.path}/${e.startsWith("/")?e.substr(1):e}`});return t.scheme===Gt.scheme?ce.getVirtualUri(i):i}createRelativeVirtualUri(t,e){return ce.getVirtualUri(this.createRelativeUri(t,e))}createVirtualUri(t,e,n){return this.getRepositoryProvider(t).createVirtualUri(Gt.baseVirtualWorkspaceUri,e,n)}async getBestRemoteUri(t,e){const{provider:n,repo:r,ref:i}=this.getVirtualUriMetadata(t);if(e===on.Repository)return this.getRemoteUri(n.id,{repo:r});if(e===on.Clone)return this.getRemoteUri(n.id,{repo:r,clone:!0});if(e===on.PullRequest||e===void 0&&(i==null?void 0:i.type)===Me.PullRequest){if((i==null?void 0:i.type)===Me.PullRequest)return this.getRemoteUri(n.id,{repo:r,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(t);if(e===on.PullRequest&&o)return this.getRemoteUri(n.id,{repo:r,pullRequest:{id:o.id}})}if(e===on.Branch||e===void 0&&(i==null?void 0:i.type)===Me.Branch){if((i==null?void 0:i.type)===Me.Branch)return this.getRemoteUri(n.id,{repo:r,branch:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===ye.Branch||o.type===ye.RemoteBranch&&e===on.Branch)return this.getRemoteUri(n.id,{repo:r,branch:o.branch.name})}if(e===on.Tag||e===void 0&&(i==null?void 0:i.type)===Me.Tag){if((i==null?void 0:i.type)===Me.Tag)return this.getRemoteUri(n.id,{repo:r,tag:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===ye.Tag)return this.getRemoteUri(n.id,{repo:r,tag:o.detached.name})}if(e===on.Commit||e===void 0&&((i==null?void 0:i.type)===Me.Commit||(i==null?void 0:i.type)===Me.Tree&&rt(i.id))){if((i==null?void 0:i.type)===Me.Commit||(i==null?void 0:i.type)===Me.Tree&&rt(i.id))return this.getRemoteUri(n.id,{repo:r,sha:i.id});const{HEAD:o}=await this.getMetadata(t);if(e===on.Commit||o.type===ye.Commit)return this.getRemoteUri(n.id,{repo:r,sha:o.sha})}if(e===void 0)return this.getRemoteUri(n.id,{repo:r})}getCanonicalUri(t){let{authority:e}=t;const n=e.indexOf(Gt.authoritySeparator);return n!==-1&&(e=e.substr(0,n)),t.with({authority:e})}getRemoteUri(t,e){var n,r;return(r=(n=this.getRepositoryProvider(t)).getRemoteUri)==null?void 0:r.call(n,e)}getProviderRootUri(t){return t=ce.getProviderUri(t),this.getRepositoryProvider(t).getProviderRootUri(t)}getRelativeFilePath(t,e){return e=ce.getProviderUri(e!=null?e:t),this.getRepositoryProvider(e).getRelativeFilePath(t,e)}getVirtualUriMetadata(t){return this.getRepositoryProvider(t).getVirtualUriMetadata(t)}getVirtualCanonicalRootUri(t){const e=ce.getVirtualUri(this.getProviderRootUri(t));let{authority:n}=e;const r=n.indexOf(Gt.authoritySeparator);return r!==-1&&(n=n.substr(0,r)),e.with({authority:n})}getVirtualRootUri(t){return ce.getVirtualUri(this.getProviderRootUri(t))}getVirtualWorkspaceUri(t){var e;return(e=f.workspace.getWorkspaceFolder(ce.getVirtualUri(t)))==null?void 0:e.uri}createIGitRepository(t,e,n){var r,i;const o=this.getChangeStore(t);return(i=(r=this.getRepositoryProvider(t)).createIGitRepository)==null?void 0:i.call(r,t,e,n,o)}async getCommitOperations(t,e){const n=this.getChangeStore(t);let r;return(e==null?void 0:e.staged)?(r=await n.getStagedChanges(t),r.length===0&&e.staged==="auto"&&(r=await n.getChanges(t))):r=await n.getChanges(t),r.map(o=>{const a=this.getRelativeFilePath(t,o.uri);switch(o.type){case D.Created:case D.Changed:return{type:o.type,path:a,fileType:o.fileType,content:n.readFile(o.uri).then(async s=>{if(!s)throw this.telemetryService.sendErrorEvent("changeStore.readFailed",{reason:"content undefined"}),new Error("No working content for created or changed commit operation");if(await ti(s)!==o.hash)throw this.telemetryService.sendErrorEvent("changeStore.readFailed",{reason:"content hash mismatch"}),new Error("Working file content hash does not match expected file content hash");return s})};case D.Deleted:return{type:o.type,path:a,fileType:o.fileType,content:void 0}}})}async getMetadata(t,e){return{...await this.getMetadataCore(this.getVirtualRootUri(t),e),path:this.getRelativeFilePath(t,t)}}async getIndexMetadata(t){const e=this.getIndexProvider(t);return e?e.getIndexMetadata(t):void 0}getModeConfig(t,e,n){return de.getMode(this.getVirtualRootUri(t),e,Boolean(n))}async getModeRefType(t,e){return t=this.getVirtualRootUri(t),this.getRepositoryProvider(t).getModeRefType(t,e)}getIndexProvider(t){var e;const n=(e=this.getProvider(t))==null?void 0:e.id;return n?this._indexProviders.get(n):void 0}async getMetadataCore(t,e){const n=N(t);let r=this.pendingMetadataRequests.get(n);if(r)return r;let i;if(!(e==null?void 0:e.forceNew)){let s;if({revision:i,cachedMetadata:s}=await this.getMetadataStore(t).get(t),s!==void 0)return s}const o=this.getProvider(t);if(!o)throw new Ht(t);const a=Si.decode(t);(a==null?void 0:a.type)===an.SHA&&(i=a.sha),r=o.provider.createMetadata(t,i),this.pendingMetadataRequests.set(n,r);try{const s=await r;return await this.updateMetadataCore(t,s,{silent:!0}),s}finally{this.pendingMetadataRequests.delete(n)}}async updateMetadata(t,e){const n=new Pe(`VirtualProviderService.updateMetadata(${t.toString()})`,{},e.HEAD.sha);try{await this.getMetadataStore(t).set(ce.getVirtualUri(t),e.HEAD.sha,e)}finally{n.stop()}}updateMetadataCore(t,e,n){return this.getMetadataStore(t).set(ce.getVirtualUri(t),e.HEAD.sha,e,n)}async clone(t){const e=await this.getBestRemoteUri(t,on.Clone);if(!e)throw new Error("No url found for clone");if(Sn)return void f.env.openExternal(f.Uri.parse(`${f.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(e.toString(!0))}`));const n=u(async r=>{try{await r.activate(),await f.commands.executeCommand("git.clone",e.toString(!0))}catch(i){U.error(i,"Unable to clone repository")}},"cloneRepository");if(f.workspace.isTrusted){const r=f.extensions.getExtension("vscode.git");if(r)await n(r);else throw new Error("Git extension not found")}else{const r=f.extensions.onDidChange(async()=>{const o=f.extensions.getExtension("vscode.git");o&&(await n(o),r.dispose())});await f.workspace.requestWorkspaceTrust()||r.dispose()}}createBranch(t,e,n,r){return this.getRepositoryProvider(t).createBranch(t,e,n,r)}createAndPushCommit(t,e,n,r,i,o){return this.getRepositoryProvider(t).createAndPushCommit(t,e,n,r,i,o)}createPullRequest(t,e,n,r,i){return this.getRepositoryProvider(t).createPullRequest(t,e,n,r,i)}fetch(t,e){return this.getRepositoryProvider(t).fetch(t,e)}async fetchOrSync(t){await this.getChangeStore(t).hasChanges(t)?await this.fetch(t):await this.sync(t,{reason:"invoked"})}fork(t){return this.getRepositoryProvider(t).fork(t)}getBranches(t,e){return this.getRepositoryProvider(t).getBranches(t,e)}getCommit(t,e){return this.getRepositoryProvider(t).getCommit(t,e)}getCommits(t,e){var n;return(n=this.getRepositoryProvider(t))==null?void 0:n.getCommits(t,e)}compareCommits(t,e){var n;return(n=this.getRepositoryProvider(t))==null?void 0:n.compareCommits(t,e)}getFileContent(t,e,n){return this.getRepositoryProvider(t).getFileContent(t,e,n)}getFork(t){return this.getRepositoryProvider(t).getFork(t)}async getIncomingChanges(t){var e,n,r;return(r=(n=(e=this.getRepositoryProvider(t)).getIncomingChanges)==null?void 0:n.call(e,t))!=null?r:[]}getPullRequest(t,e){return this.getRepositoryProvider(t).getPullRequest(t,e)}getTags(t,e){return this.getRepositoryProvider(t).getTags(t,e)}getSnapshots(t,e){var n,r;return(r=(n=this.getIndexProvider(t))==null?void 0:n.getSnapshots(t,e))!=null?r:Promise.resolve([])}async getTarGz(t,e,n){var r,i;return(i=(r=this.getRepositoryProvider(t)).getTarGz)==null?void 0:i.call(r,t,e,n)}async loadWorkspaceContents(t){return this.getRepositoryProvider(t).loadWorkspaceContents(t)}switchTo(t,e,n){return this.getRepositoryProvider(t).switchTo(t,e,n)}async sync(t,e){const n=this._repositories.get(N(t));n&&this._onDidSyncRepository.fire({repository:n,syncing:!0});try{const r=this.getProvider(t),i=this.getIndexProvider(t);if(r===void 0)throw new Ht(t);let{to:o,reason:a,...s}=e!=null?e:{};o===void 0&&i&&(o=await i.resolveIndexRef(t,a==="user"));const c=this.getChangeStore(t);if(await c.hasMergeConflicts(t))throw nt.UnresolvedConflictsError();return await r.provider.sync(t,c,{conflictResolution:ei.Abort,...s,to:o})}finally{n&&this._onDidSyncRepository.fire({repository:n,syncing:!1})}}stat(t){return this.getFileSystemProvider(t).stat(t)}readDirectory(t){return this.getFileSystemProvider(t).readDirectory(t)}readFile(t){return this.getFileSystemProvider(t).readFile(t)}watch(t,e){return this.getFileSystemProvider(t).watch(t,e)}changeStoreApplyChangeset(t,e,n){return this.getChangeStore(t).applyChangeset(t,e,n)}changeStoreCreateFile(t,e){return this.getChangeStore(t).createFile(t,e)}changeStoreCreateDirectory(t){return this.getChangeStore(t).createDirectory(t)}changeStoreDeleteDirectory(t){return this.getChangeStore(t).deleteDirectory(t)}changeStoreDeleteFile(t){return this.getChangeStore(t).deleteFile(t)}changeStoreExportDebugInfo(){var t;for(const e of(t=f.workspace.workspaceFolders)!=null?t:[])this.getChangeStore(e.uri).exportDebugInfo(e.uri)}changeStoreGetChange(t){return this.getChangeStore(t).getChange(t)}changeStoreGetChanges(t,e){return this.getChangeStore(t).getChanges(this.stripUriScope(t),e)}changeStoreGetScopedChangeStore(t,e){const n=typeof e=="string"?e:e.workspaceId;return this.getChangeStore(t).getScopedChangeStore(n)}changeStoreGetScopedUri(t,e){const n=typeof e=="string"?e:e.workspaceId;return this.getChangeStore(t).getScopedUri(t,n)}changeStoreHasChanges(t){return this.getChangeStore(t).hasChanges(this.stripUriScope(t))}changeStoreMaybeHasChanges(t,e){return this.getChangeStore(t).maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}changeStoreReadFile(t){return this.getChangeStore(t).readFile(t)}changeStoreResolveDiffCommand(t,e,n,r){return this.getChangeStore(t).resolveDiffCommand(t,e,n,r)}changeStoreStat(t){return this.getChangeStore(t).stat(t)}changeStoreUpdateDirectoryEntries(t,e){return this.getChangeStore(t).updateDirectoryEntries(t,e)}changeStoreWriteFile(t,e,n,r){return this.getChangeStore(t).writeFile(t,e,n,r)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}getFromStorage(t,e){return this.getStorageService(t).get(e)}async storeInStorage(t,e,n){return this.getStorageService(t).store(e,n)}async deleteFromStorage(t,e){return this.getStorageService(t).delete(e)}async workspaceRepositoriesGetRepositoriesByCanonicalUri(){const t=await this.workspaceRepositoriesGetRepositories();return Dm(t.sort((e,n)=>n.timestamp-e.timestamp),e=>N(e.canonicalUri))}workspaceRepositoriesRemoveRepository(t){return this.getWorkspaceRepositories(t.uri).remove(t)}workspaceRepositoriesRefresh(){for(const[,t]of this._providers.entries())t.workspaceRepositories.refresh()}async workspaceRepositoriesGetRepositories(){const t=[];for(const[,e]of this._providers.entries()){const n=await e.workspaceRepositories.get();t.push(...n.filter(r=>r.provider.id===e.id))}return t}provideFileSearchResults(t,e,n){return this.getFileSystemProvider(e.folder).provideFileSearchResults(t,e,n)}provideTextSearchResults(t,e,n,r){return this.getFileSystemProvider(e.folder).provideTextSearchResults(t,e,n,r)}static getProviderId(t){const{authority:e}=t,n=e.indexOf(Gt.authoritySeparator);return n!==-1?e.substr(0,n):e}static isCanonicalUri(t){return t.authority.indexOf(Gt.authoritySeparator)===-1}},"_VirtualProviderService");let Wt=Gt;Wt.scheme="vscode-vfs",Wt.authoritySeparator="+",Wt.baseVirtualWorkspaceUri=f.Uri.parse(`${Gt.scheme}://`),Vm([Vs()],Wt.prototype,"getMetadataCore",1);function zm(t,e,n){return new Qr(new vu(t),new vu(e)).ComputeDiff(n).changes}u(zm,"stringDiff");class Sr{constructor(e,n,r,i){this.originalStart=e,this.originalLength=n,this.modifiedStart=r,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}u(Sr,"DiffChange");var zf;(function(t){t[t.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",t[t.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",t[t.MAX_UINT_8=255]="MAX_UINT_8",t[t.MAX_UINT_16=65535]="MAX_UINT_16",t[t.MAX_UINT_32=4294967295]="MAX_UINT_32",t[t.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(zf||(zf={}));function jf(t,e){return(e<<5)-e+t|0}u(jf,"numberHash");function jm(t,e){e=jf(149417,e);for(let n=0,r=t.length;n<r;n++)e=jf(t.charCodeAt(n),e);return e}u(jm,"stringHash");class vu{constructor(e){this.source=e}getElements(){const e=this.source,n=new Int32Array(e.length);for(let r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n}}u(vu,"StringDiffSequence");class _i{static Assert(e,n){if(!e)throw new Error(n)}}u(_i,"Debug");class xi{static Copy(e,n,r,i,o){for(let a=0;a<o;a++)r[i+a]=e[n+a]}static Copy2(e,n,r,i,o){for(let a=0;a<o;a++)r[i+a]=e[n+a]}}u(xi,"MyArray");var Gf;(function(t){t[t.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(Gf||(Gf={}));class mu{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Sr(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,n){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,n),this.m_originalCount++}AddModifiedElement(e,n){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,n),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}u(mu,"DiffChangeHelper");class Qr{constructor(e,n,r=null){this.ContinueProcessingPredicate=r,this._originalSequence=e,this._modifiedSequence=n;const[i,o,a]=Qr._getElements(e),[s,c,l]=Qr._getElements(n);this._hasStrings=a&&l,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=c,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const n=e.getElements();if(Qr._isStringArray(n)){const r=new Int32Array(n.length);for(let i=0,o=n.length;i<o;i++)r[i]=jm(n[i],0);return[n,r,!0]}return n instanceof Int32Array?[[],n,!1]:[[],new Int32Array(n),!1]}ElementsAreEqual(e,n){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[n]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[n]:!0}ElementsAreStrictEqual(e,n){if(!this.ElementsAreEqual(e,n))return!1;const r=Qr._getStrictElement(this._originalSequence,e),i=Qr._getStrictElement(this._modifiedSequence,n);return r===i}static _getStrictElement(e,n){return typeof e.getStrictElement=="function"?e.getStrictElement(n):null}OriginalElementsAreEqual(e,n){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[n]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[n]:!0}ModifiedElementsAreEqual(e,n){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[n]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[n]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,n,r,i,o){const a=[!1];let s=this.ComputeDiffRecursive(e,n,r,i,a);return o&&(s=this.PrettifyChanges(s)),{quitEarly:a[0],changes:s}}ComputeDiffRecursive(e,n,r,i,o){for(o[0]=!1;e<=n&&r<=i&&this.ElementsAreEqual(e,r);)e++,r++;for(;n>=e&&i>=r&&this.ElementsAreEqual(n,i);)n--,i--;if(e>n||r>i){let h;return r<=i?(_i.Assert(e===n+1,"originalStart should only be one more than originalEnd"),h=[new Sr(e,0,r,i-r+1)]):e<=n?(_i.Assert(r===i+1,"modifiedStart should only be one more than modifiedEnd"),h=[new Sr(e,n-e+1,r,0)]):(_i.Assert(e===n+1,"originalStart should only be one more than originalEnd"),_i.Assert(r===i+1,"modifiedStart should only be one more than modifiedEnd"),h=[]),h}const a=[0],s=[0],c=this.ComputeRecursionPoint(e,n,r,i,a,s,o),l=a[0],d=s[0];if(c!==null)return c;if(!o[0]){const h=this.ComputeDiffRecursive(e,l,r,d,o);let g=[];return o[0]?g=[new Sr(l+1,n-(l+1)+1,d+1,i-(d+1)+1)]:g=this.ComputeDiffRecursive(l+1,n,d+1,i,o),this.ConcatenateChanges(h,g)}return[new Sr(e,n-e+1,r,i-r+1)]}WALKTRACE(e,n,r,i,o,a,s,c,l,d,h,g,p,y,v,m,C,w){let _=null,E=null,x=new mu,T=n,W=r,F=p[0]-m[0]-i,G=-1073741824,Z=this.m_forwardHistory.length-1;do{const ee=F+e;ee===T||ee<W&&l[ee-1]<l[ee+1]?(h=l[ee+1],y=h-F-i,h<G&&x.MarkNextChange(),G=h,x.AddModifiedElement(h+1,y),F=ee+1-e):(h=l[ee-1]+1,y=h-F-i,h<G&&x.MarkNextChange(),G=h-1,x.AddOriginalElement(h,y+1),F=ee-1-e),Z>=0&&(l=this.m_forwardHistory[Z],e=l[0],T=1,W=l.length-1)}while(--Z>=-1);if(_=x.getReverseChanges(),w[0]){let ee=p[0]+1,Q=m[0]+1;if(_!==null&&_.length>0){const se=_[_.length-1];ee=Math.max(ee,se.getOriginalEnd()),Q=Math.max(Q,se.getModifiedEnd())}E=[new Sr(ee,g-ee+1,Q,v-Q+1)]}else{x=new mu,T=a,W=s,F=p[0]-m[0]-c,G=1073741824,Z=C?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const ee=F+o;ee===T||ee<W&&d[ee-1]>=d[ee+1]?(h=d[ee+1]-1,y=h-F-c,h>G&&x.MarkNextChange(),G=h+1,x.AddOriginalElement(h+1,y+1),F=ee+1-o):(h=d[ee-1],y=h-F-c,h>G&&x.MarkNextChange(),G=h,x.AddModifiedElement(h+1,y+1),F=ee-1-o),Z>=0&&(d=this.m_reverseHistory[Z],o=d[0],T=1,W=d.length-1)}while(--Z>=-1);E=x.getChanges()}return this.ConcatenateChanges(_,E)}ComputeRecursionPoint(e,n,r,i,o,a,s){let c=0,l=0,d=0,h=0,g=0,p=0;e--,r--,o[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const y=n-e+(i-r),v=y+1,m=new Int32Array(v),C=new Int32Array(v),w=i-r,_=n-e,E=e-r,x=n-i,W=(_-w)%2==0;m[w]=e,C[_]=n,s[0]=!1;for(let F=1;F<=y/2+1;F++){let G=0,Z=0;d=this.ClipDiagonalBound(w-F,F,w,v),h=this.ClipDiagonalBound(w+F,F,w,v);for(let Q=d;Q<=h;Q+=2){Q===d||Q<h&&m[Q-1]<m[Q+1]?c=m[Q+1]:c=m[Q-1]+1,l=c-(Q-w)-E;const se=c;for(;c<n&&l<i&&this.ElementsAreEqual(c+1,l+1);)c++,l++;if(m[Q]=c,c+l>G+Z&&(G=c,Z=l),!W&&Math.abs(Q-_)<=F-1&&c>=C[Q])return o[0]=c,a[0]=l,se<=C[Q]&&1447>0&&F<=1447+1?this.WALKTRACE(w,d,h,E,_,g,p,x,m,C,c,n,o,l,i,a,W,s):null}const ee=(G-e+(Z-r)-F)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(G,ee))return s[0]=!0,o[0]=G,a[0]=Z,ee>0&&1447>0&&F<=1447+1?this.WALKTRACE(w,d,h,E,_,g,p,x,m,C,c,n,o,l,i,a,W,s):(e++,r++,[new Sr(e,n-e+1,r,i-r+1)]);g=this.ClipDiagonalBound(_-F,F,_,v),p=this.ClipDiagonalBound(_+F,F,_,v);for(let Q=g;Q<=p;Q+=2){Q===g||Q<p&&C[Q-1]>=C[Q+1]?c=C[Q+1]-1:c=C[Q-1],l=c-(Q-_)-x;const se=c;for(;c>e&&l>r&&this.ElementsAreEqual(c,l);)c--,l--;if(C[Q]=c,W&&Math.abs(Q-w)<=F&&c<=m[Q])return o[0]=c,a[0]=l,se>=m[Q]&&1447>0&&F<=1447+1?this.WALKTRACE(w,d,h,E,_,g,p,x,m,C,c,n,o,l,i,a,W,s):null}if(F<=1447){let Q=new Int32Array(h-d+2);Q[0]=w-d+1,xi.Copy2(m,d,Q,1,h-d+1),this.m_forwardHistory.push(Q),Q=new Int32Array(p-g+2),Q[0]=_-g+1,xi.Copy2(C,g,Q,1,p-g+1),this.m_reverseHistory.push(Q)}}return this.WALKTRACE(w,d,h,E,_,g,p,x,m,C,c,n,o,l,i,a,W,s)}PrettifyChanges(e){for(let n=0;n<e.length;n++){const r=e[n],i=n<e.length-1?e[n+1].originalStart:this._originalElementsOrHash.length,o=n<e.length-1?e[n+1].modifiedStart:this._modifiedElementsOrHash.length,a=r.originalLength>0,s=r.modifiedLength>0;for(;r.originalStart+r.originalLength<i&&r.modifiedStart+r.modifiedLength<o&&(!a||this.OriginalElementsAreEqual(r.originalStart,r.originalStart+r.originalLength))&&(!s||this.ModifiedElementsAreEqual(r.modifiedStart,r.modifiedStart+r.modifiedLength));){const l=this.ElementsAreStrictEqual(r.originalStart,r.modifiedStart);if(this.ElementsAreStrictEqual(r.originalStart+r.originalLength,r.modifiedStart+r.modifiedLength)&&!l)break;r.originalStart++,r.modifiedStart++}let c=[null];if(n<e.length-1&&this.ChangesOverlap(e[n],e[n+1],c)){e[n]=c[0],e.splice(n+1,1),n--;continue}}for(let n=e.length-1;n>=0;n--){const r=e[n];let i=0,o=0;if(n>0){const h=e[n-1];i=h.originalStart+h.originalLength,o=h.modifiedStart+h.modifiedLength}const a=r.originalLength>0,s=r.modifiedLength>0;let c=0,l=this._boundaryScore(r.originalStart,r.originalLength,r.modifiedStart,r.modifiedLength);for(let h=1;;h++){const g=r.originalStart-h,p=r.modifiedStart-h;if(g<i||p<o||a&&!this.OriginalElementsAreEqual(g,g+r.originalLength)||s&&!this.ModifiedElementsAreEqual(p,p+r.modifiedLength))break;const v=(g===i&&p===o?5:0)+this._boundaryScore(g,r.originalLength,p,r.modifiedLength);v>l&&(l=v,c=h)}r.originalStart-=c,r.modifiedStart-=c;const d=[null];if(n>0&&this.ChangesOverlap(e[n-1],e[n],d)){e[n-1]=d[0],e.splice(n,1),n++;continue}}if(this._hasStrings)for(let n=1,r=e.length;n<r;n++){const i=e[n-1],o=e[n],a=o.originalStart-i.originalStart-i.originalLength,s=i.originalStart,c=o.originalStart+o.originalLength,l=c-s,d=i.modifiedStart,h=o.modifiedStart+o.modifiedLength,g=h-d;if(a<5&&l<20&&g<20){const p=this._findBetterContiguousSequence(s,l,d,g,a);if(p){const[y,v]=p;(y!==i.originalStart+i.originalLength||v!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=y-i.originalStart,i.modifiedLength=v-i.modifiedStart,o.originalStart=y+a,o.modifiedStart=v+a,o.originalLength=c-o.originalStart,o.modifiedLength=h-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,n,r,i,o){if(n<o||i<o)return null;const a=e+n-o+1,s=r+i-o+1;let c=0,l=0,d=0;for(let h=e;h<a;h++)for(let g=r;g<s;g++){const p=this._contiguousSequenceScore(h,g,o);p>0&&p>c&&(c=p,l=h,d=g)}return c>0?[l,d]:null}_contiguousSequenceScore(e,n,r){let i=0;for(let o=0;o<r;o++){if(!this.ElementsAreEqual(e+o,n+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,n){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(n>0){const r=e+n;if(this._OriginalIsBoundary(r-1)||this._OriginalIsBoundary(r))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,n){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(n>0){const r=e+n;if(this._ModifiedIsBoundary(r-1)||this._ModifiedIsBoundary(r))return!0}return!1}_boundaryScore(e,n,r,i){const o=this._OriginalRegionIsBoundary(e,n)?1:0,a=this._ModifiedRegionIsBoundary(r,i)?1:0;return o+a}ConcatenateChanges(e,n){let r=[];if(e.length===0||n.length===0)return n.length>0?n:e;if(this.ChangesOverlap(e[e.length-1],n[0],r)){const i=new Array(e.length+n.length-1);return xi.Copy(e,0,i,0,e.length-1),i[e.length-1]=r[0],xi.Copy(n,1,i,e.length,n.length-1),i}else{const i=new Array(e.length+n.length);return xi.Copy(e,0,i,0,e.length),xi.Copy(n,0,i,e.length,n.length),i}}ChangesOverlap(e,n,r){if(_i.Assert(e.originalStart<=n.originalStart,"Left change is not less than or equal to right change"),_i.Assert(e.modifiedStart<=n.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=n.originalStart||e.modifiedStart+e.modifiedLength>=n.modifiedStart){const i=e.originalStart;let o=e.originalLength;const a=e.modifiedStart;let s=e.modifiedLength;return e.originalStart+e.originalLength>=n.originalStart&&(o=n.originalStart+n.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=n.modifiedStart&&(s=n.modifiedStart+n.modifiedLength-e.modifiedStart),r[0]=new Sr(i,o,a,s),!0}else return r[0]=null,!1}ClipDiagonalBound(e,n,r,i){if(e>=0&&e<i)return e;const o=r,a=i-r-1,s=n%2==0;if(e<0){const c=o%2==0;return s===c?0:1}else{const c=a%2==0;return s===c?i-1:i-2}}}u(Qr,"LcsDiff");var wu;(function(t){function e(r,i){return r instanceof Io?i:new f.Position(i.line,i.character)}u(e,"makePosition"),t.makePosition=e;function n(r,i){return r instanceof Io?i:new f.Range(i.start.line,i.start.character,i.end.line,i.end.character)}u(n,"makeRange"),t.makeRange=n})(wu||(wu={}));var Kf;(function(t){t[t.index2code=1]="index2code",t[t.code2Index=2]="code2Index"})(Kf||(Kf={}));const Qf=u(class{constructor(t,e,n,r){this.diffCache=new Cr(32),this.indexDocumentCache=new Cr(32),this.codeDocumentCache=new Cr(32),this.providerService=t,this.rootUri=e,this.index=n,this.code=r,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const t=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return t===void 0?new Map:new Map(t.map(e=>[e.uri.toString(),e.type]))}async needsMapping(t){const e=t.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,t).length!==0}async mapPositionFromCodeToIndex(t,e){const n=t.uri;if(!n.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(n.toString());if(i===D.Created||i===D.Deleted)return;const o=await this.getIndexDocument(n);if(o===void 0)return;const a=this.getDiff(2,o,t);if(a.length===0)return e;const s=t.offsetAt(new f.Position(e.line,e.character));let c=s;for(const g of a){if(g.modifiedStart<=s&&s<g.modifiedStart+g.modifiedLength)return;if(c<g.modifiedStart)break;c=c-(g.modifiedLength-g.originalLength)}const l=o.positionAt(c),d=this.getWordAtOffset(o.lineAt(l.line).text,l.character),h=this.getWordAtOffset(t.lineAt(e.line).text,e.character);if(!(d===void 0||h===void 0||d!==h))return new f.Position(l.line,l.character)}async mapRangeFromIndexToCode(t,e){const n=t instanceof f.Uri?t:t.uri;if(!n.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(n.toString());if(i===D.Created||i===D.Deleted)return;const[o,a]=await Promise.all([this.getIndexDocument(n),this.getCodeDocument(t)]);if(o===void 0||a===void 0)return;const s=this.getDiff(1,o,a);if(s.length===0)return e;const c=o.offsetAt(e.start);let l=c;const d=o.offsetAt(e.end);let h=d;for(const m of s){if(h<m.originalStart)break;const C=m.modifiedLength-m.originalLength;if(m.originalStart<=c){if(c<m.originalStart+m.originalLength)return;l+=C}else if(d<m.originalStart+m.originalLength)return;if(m.originalStart<=d){if(d<m.originalStart+m.originalLength)return;h+=C}}const g=a.positionAt(l),p=a.positionAt(h),y=o.getText(e),v=a.getText(wu.makeRange(a,{start:g,end:p}));if(y===v)return new f.Range(g.line,g.character,p.line,p.character)}async getIndexDocument(t){return this.getDocument(this.indexDocumentCache,t,this.index)}async getCodeDocument(t){return t instanceof f.Uri?this.getDocument(this.codeDocumentCache,t,this.code):t}async getDocument(t,e,n){let r=t.get(e.toString());if(r!==null)return r!==void 0||(r=this._getDocument(e,n),t.set(e.toString(),r),r.then(i=>{i===void 0&&t.set(e.toString(),null)},void 0)),r}async _getDocument(t,e){const n=t.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,n).then(r=>new Io(t,Number.MAX_VALUE,Qf.textDecoder.decode(r)),()=>{})}getDiff(t,e,n){if(e.uri.toString()!==n.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${n.uri.toString()}) are pointing to a different document`);const r=`${t}${e.uri.toString()}`;let i=this.diffCache.get(r);return i!==void 0&&i.original===e.version&&i.modified===n.version||(i={original:e.version,modified:n.version,changes:zm(e.getText(),n.getText(),!0)},this.diffCache.set(r,i)),i.changes}getWordAtOffset(t,e){let n="findStart",r=0,i=t.length,o=0;for(;o<t.length&&n!=="endFound";){switch(o===e&&(n="findEnd"),t[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(n){case"findStart":r=o+1;break;case"findEnd":i=o,n="endFound";break}break}o++}return n==="endFound"?t.substring(r,i):void 0}},"_DiffMapper");let Xf=Qf;Xf.textDecoder=new TextDecoder("utf8");var Jf;(function(t){t[t.LineFeed=10]="LineFeed",t[t.CarriageReturn=13]="CarriageReturn"})(Jf||(Jf={}));class Io{static computeLineOffsets(e,n,r=0){const i=n?[r]:[];for(let o=0;o<e.length;o++){const a=e.charCodeAt(o);(a===13||a===10)&&(a===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(r+o+1))}return i}constructor(e,n,r){this._content=r,this.uri=e,this.version=n,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Io.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content}lineAt(e){const n=this.getLineOffsets();if(e>=n.length)return{lineNumber:e,text:""};const r=n[e],i=n[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(r)};const o=this._content.substring(r,i);let a=o.length-1;for(;a>=0&&(o[a]===`
`||o[a]==="\r");)a--;return{lineNumber:e,text:o.substr(0,a+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const n=this.getLineOffsets();let r=0,i=n.length;if(i===0)return{line:0,character:e};for(;r<i;){const a=Math.floor((r+i)/2);n[a]>e?i=a:r=a+1}const o=r-1;return{line:o,character:e-n[o]}}offsetAt(e){const n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;const r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)}get lineCount(){return this.getLineOffsets().length}}u(Io,"TextDocument");var Yf;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647})(Yf||(Yf={}));var qs;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647})(qs||(qs={}));var Qn;(function(t){function e(r,i){return r===Number.MAX_VALUE&&(r=qs.MAX_VALUE),i===Number.MAX_VALUE&&(i=qs.MAX_VALUE),{line:r,character:i}}u(e,"create"),t.create=e;function n(r){var i=r;return A.objectLiteral(i)&&A.uinteger(i.line)&&A.uinteger(i.character)}u(n,"is"),t.is=n})(Qn||(Qn={}));var St;(function(t){function e(r,i,o,a){if(A.uinteger(r)&&A.uinteger(i)&&A.uinteger(o)&&A.uinteger(a))return{start:Qn.create(r,i),end:Qn.create(o,a)};if(Qn.is(r)&&Qn.is(i))return{start:r,end:i};throw new Error("Range#create called with invalid arguments["+r+", "+i+", "+o+", "+a+"]")}u(e,"create"),t.create=e;function n(r){var i=r;return A.objectLiteral(i)&&Qn.is(i.start)&&Qn.is(i.end)}u(n,"is"),t.is=n})(St||(St={}));var yu;(function(t){function e(r,i){return{uri:r,range:i}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&St.is(i.range)&&(A.string(i.uri)||A.undefined(i.uri))}u(n,"is"),t.is=n})(yu||(yu={}));var zs;(function(t){function e(r,i,o,a){return{targetUri:r,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&St.is(i.targetRange)&&A.string(i.targetUri)&&(St.is(i.targetSelectionRange)||A.undefined(i.targetSelectionRange))&&(St.is(i.originSelectionRange)||A.undefined(i.originSelectionRange))}u(n,"is"),t.is=n})(zs||(zs={}));var Cu;(function(t){function e(r,i,o,a){return{red:r,green:i,blue:o,alpha:a}}u(e,"create"),t.create=e;function n(r){var i=r;return A.numberRange(i.red,0,1)&&A.numberRange(i.green,0,1)&&A.numberRange(i.blue,0,1)&&A.numberRange(i.alpha,0,1)}u(n,"is"),t.is=n})(Cu||(Cu={}));var Zf;(function(t){function e(r,i){return{range:r,color:i}}u(e,"create"),t.create=e;function n(r){var i=r;return St.is(i.range)&&Cu.is(i.color)}u(n,"is"),t.is=n})(Zf||(Zf={}));var eg;(function(t){function e(r,i,o){return{label:r,textEdit:i,additionalTextEdits:o}}u(e,"create"),t.create=e;function n(r){var i=r;return A.string(i.label)&&(A.undefined(i.textEdit)||Xr.is(i))&&(A.undefined(i.additionalTextEdits)||A.typedArray(i.additionalTextEdits,Xr.is))}u(n,"is"),t.is=n})(eg||(eg={}));var wa;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(wa||(wa={}));var tg;(function(t){function e(r,i,o,a,s){var c={startLine:r,endLine:i};return A.defined(o)&&(c.startCharacter=o),A.defined(a)&&(c.endCharacter=a),A.defined(s)&&(c.kind=s),c}u(e,"create"),t.create=e;function n(r){var i=r;return A.uinteger(i.startLine)&&A.uinteger(i.startLine)&&(A.undefined(i.startCharacter)||A.uinteger(i.startCharacter))&&(A.undefined(i.endCharacter)||A.uinteger(i.endCharacter))&&(A.undefined(i.kind)||A.string(i.kind))}u(n,"is"),t.is=n})(tg||(tg={}));var bu;(function(t){function e(r,i){return{location:r,message:i}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&yu.is(i.location)&&A.string(i.message)}u(n,"is"),t.is=n})(bu||(bu={}));var Eo;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(Eo||(Eo={}));var js;(function(t){t.Unnecessary=1,t.Deprecated=2})(js||(js={}));var Su;(function(t){function e(n){var r=n;return r!=null&&A.string(r.href)}u(e,"is"),t.is=e})(Su||(Su={}));var Gs;(function(t){function e(r,i,o,a,s,c){var l={range:r,message:i};return A.defined(o)&&(l.severity=o),A.defined(a)&&(l.code=a),A.defined(s)&&(l.source=s),A.defined(c)&&(l.relatedInformation=c),l}u(e,"create"),t.create=e;function n(r){var i,o=r;return A.defined(o)&&St.is(o.range)&&A.string(o.message)&&(A.number(o.severity)||A.undefined(o.severity))&&(A.integer(o.code)||A.string(o.code)||A.undefined(o.code))&&(A.undefined(o.codeDescription)||A.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(A.string(o.source)||A.undefined(o.source))&&(A.undefined(o.relatedInformation)||A.typedArray(o.relatedInformation,bu.is))}u(n,"is"),t.is=n})(Gs||(Gs={}));var ya;(function(t){function e(r,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s={title:r,command:i};return A.defined(o)&&o.length>0&&(s.arguments=o),s}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&A.string(i.title)&&A.string(i.command)}u(n,"is"),t.is=n})(ya||(ya={}));var Xr;(function(t){function e(o,a){return{range:o,newText:a}}u(e,"replace"),t.replace=e;function n(o,a){return{range:{start:o,end:o},newText:a}}u(n,"insert"),t.insert=n;function r(o){return{range:o,newText:""}}u(r,"del"),t.del=r;function i(o){var a=o;return A.objectLiteral(a)&&A.string(a.newText)&&St.is(a.range)}u(i,"is"),t.is=i})(Xr||(Xr={}));var ko;(function(t){function e(r,i,o){var a={label:r};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i!==void 0&&A.objectLiteral(i)&&A.string(i.label)&&(A.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(A.string(i.description)||i.description===void 0)}u(n,"is"),t.is=n})(ko||(ko={}));var Tt;(function(t){function e(n){var r=n;return typeof r=="string"}u(e,"is"),t.is=e})(Tt||(Tt={}));var Jr;(function(t){function e(o,a,s){return{range:o,newText:a,annotationId:s}}u(e,"replace"),t.replace=e;function n(o,a,s){return{range:{start:o,end:o},newText:a,annotationId:s}}u(n,"insert"),t.insert=n;function r(o,a){return{range:o,newText:"",annotationId:a}}u(r,"del"),t.del=r;function i(o){var a=o;return Xr.is(a)&&(ko.is(a.annotationId)||Tt.is(a.annotationId))}u(i,"is"),t.is=i})(Jr||(Jr={}));var Ca;(function(t){function e(r,i){return{textDocument:r,edits:i}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&Qs.is(i.textDocument)&&Array.isArray(i.edits)}u(n,"is"),t.is=n})(Ca||(Ca={}));var Ro;(function(t){function e(r,i,o){var a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i&&i.kind==="create"&&A.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||A.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||A.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Tt.is(i.annotationId))}u(n,"is"),t.is=n})(Ro||(Ro={}));var Do;(function(t){function e(r,i,o,a){var s={kind:"rename",oldUri:r,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(s.options=o),a!==void 0&&(s.annotationId=a),s}u(e,"create"),t.create=e;function n(r){var i=r;return i&&i.kind==="rename"&&A.string(i.oldUri)&&A.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||A.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||A.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Tt.is(i.annotationId))}u(n,"is"),t.is=n})(Do||(Do={}));var To;(function(t){function e(r,i,o){var a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i&&i.kind==="delete"&&A.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||A.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||A.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Tt.is(i.annotationId))}u(n,"is"),t.is=n})(To||(To={}));var _u;(function(t){function e(n){var r=n;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(function(i){return A.string(i.kind)?Ro.is(i)||Do.is(i)||To.is(i):Ca.is(i)}))}u(e,"is"),t.is=e})(_u||(_u={}));var Ks=function(){function t(e,n){this.edits=e,this.changeAnnotations=n}return u(t,"TextEditChangeImpl"),t.prototype.insert=function(e,n,r){var i,o;if(r===void 0?i=Xr.insert(e,n):Tt.is(r)?(o=r,i=Jr.insert(e,n,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=Jr.insert(e,n,o)),this.edits.push(i),o!==void 0)return o},t.prototype.replace=function(e,n,r){var i,o;if(r===void 0?i=Xr.replace(e,n):Tt.is(r)?(o=r,i=Jr.replace(e,n,r)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(r),i=Jr.replace(e,n,o)),this.edits.push(i),o!==void 0)return o},t.prototype.delete=function(e,n){var r,i;if(n===void 0?r=Xr.del(e):Tt.is(n)?(i=n,r=Jr.del(e,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=Jr.del(e,i)),this.edits.push(r),i!==void 0)return i},t.prototype.add=function(e){this.edits.push(e)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),ng=function(){function t(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return u(t,"ChangeAnnotations"),t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(e,n){var r;if(Tt.is(e)?r=e:(r=this.nextId(),n=e),this._annotations[r]!==void 0)throw new Error("Id "+r+" is already in use.");if(n===void 0)throw new Error("No annotation provided for id "+r);return this._annotations[r]=n,this._size++,r},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),a0=function(){function t(e){var n=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new ng(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(r){if(Ca.is(r)){var i=new Ks(r.edits,n._changeAnnotations);n._textEditChanges[r.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(r){var i=new Ks(e.changes[r]);n._textEditChanges[r]=i})):this._workspaceEdit={}}return u(t,"WorkspaceChange"),Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(e){if(Qs.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var n={uri:e.uri,version:e.version},r=this._textEditChanges[n.uri];if(!r){var i=[],o={textDocument:n,edits:i};this._workspaceEdit.documentChanges.push(o),r=new Ks(i,this._changeAnnotations),this._textEditChanges[n.uri]=r}return r}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var r=this._textEditChanges[e];if(!r){var i=[];this._workspaceEdit.changes[e]=i,r=new Ks(i),this._textEditChanges[e]=r}return r}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new ng,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(e,n,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;ko.is(n)||Tt.is(n)?i=n:r=n;var o,a;if(i===void 0?o=Ro.create(e,r):(a=Tt.is(i)?i:this._changeAnnotations.manage(i),o=Ro.create(e,r,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t.prototype.renameFile=function(e,n,r,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;ko.is(r)||Tt.is(r)?o=r:i=r;var a,s;if(o===void 0?a=Do.create(e,n,i):(s=Tt.is(o)?o:this._changeAnnotations.manage(o),a=Do.create(e,n,i,s)),this._workspaceEdit.documentChanges.push(a),s!==void 0)return s},t.prototype.deleteFile=function(e,n,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;ko.is(n)||Tt.is(n)?i=n:r=n;var o,a;if(i===void 0?o=To.create(e,r):(a=Tt.is(i)?i:this._changeAnnotations.manage(i),o=To.create(e,r,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t}(),rg;(function(t){function e(r){return{uri:r}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&A.string(i.uri)}u(n,"is"),t.is=n})(rg||(rg={}));var ig;(function(t){function e(r,i){return{uri:r,version:i}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&A.string(i.uri)&&A.integer(i.version)}u(n,"is"),t.is=n})(ig||(ig={}));var Qs;(function(t){function e(r,i){return{uri:r,version:i}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&A.string(i.uri)&&(i.version===null||A.integer(i.version))}u(n,"is"),t.is=n})(Qs||(Qs={}));var og;(function(t){function e(r,i,o,a){return{uri:r,languageId:i,version:o,text:a}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&A.string(i.uri)&&A.string(i.languageId)&&A.integer(i.version)&&A.string(i.text)}u(n,"is"),t.is=n})(og||(og={}));var _r;(function(t){t.PlainText="plaintext",t.Markdown="markdown"})(_r||(_r={})),function(t){function e(n){var r=n;return r===t.PlainText||r===t.Markdown}u(e,"is"),t.is=e}(_r||(_r={}));var xu;(function(t){function e(n){var r=n;return A.objectLiteral(n)&&_r.is(r.kind)&&A.string(r.value)}u(e,"is"),t.is=e})(xu||(xu={}));var ag;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(ag||(ag={}));var sg;(function(t){t.PlainText=1,t.Snippet=2})(sg||(sg={}));var cg;(function(t){t.Deprecated=1})(cg||(cg={}));var lg;(function(t){function e(r,i,o){return{newText:r,insert:i,replace:o}}u(e,"create"),t.create=e;function n(r){var i=r;return i&&A.string(i.newText)&&St.is(i.insert)&&St.is(i.replace)}u(n,"is"),t.is=n})(lg||(lg={}));var ug;(function(t){t.asIs=1,t.adjustIndentation=2})(ug||(ug={}));var dg;(function(t){function e(n){return{label:n}}u(e,"create"),t.create=e})(dg||(dg={}));var hg;(function(t){function e(n,r){return{items:n||[],isIncomplete:!!r}}u(e,"create"),t.create=e})(hg||(hg={}));var Xs;(function(t){function e(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}u(e,"fromPlainText"),t.fromPlainText=e;function n(r){var i=r;return A.string(i)||A.objectLiteral(i)&&A.string(i.language)&&A.string(i.value)}u(n,"is"),t.is=n})(Xs||(Xs={}));var fg;(function(t){function e(n){var r=n;return!!r&&A.objectLiteral(r)&&(xu.is(r.contents)||Xs.is(r.contents)||A.typedArray(r.contents,Xs.is))&&(n.range===void 0||St.is(n.range))}u(e,"is"),t.is=e})(fg||(fg={}));var gg;(function(t){function e(n,r){return r?{label:n,documentation:r}:{label:n}}u(e,"create"),t.create=e})(gg||(gg={}));var pg;(function(t){function e(n,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a={label:n};return A.defined(r)&&(a.documentation=r),A.defined(i)?a.parameters=i:a.parameters=[],a}u(e,"create"),t.create=e})(pg||(pg={}));var ba;(function(t){t.Text=1,t.Read=2,t.Write=3})(ba||(ba={}));var vg;(function(t){function e(n,r){var i={range:n};return A.number(r)&&(i.kind=r),i}u(e,"create"),t.create=e})(vg||(vg={}));var Iu;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(Iu||(Iu={}));var Eu;(function(t){t.Deprecated=1})(Eu||(Eu={}));var mg;(function(t){function e(n,r,i,o,a){var s={name:n,kind:r,location:{uri:o,range:i}};return a&&(s.containerName=a),s}u(e,"create"),t.create=e})(mg||(mg={}));var wg;(function(t){function e(r,i,o,a,s,c){var l={name:r,detail:i,kind:o,range:a,selectionRange:s};return c!==void 0&&(l.children=c),l}u(e,"create"),t.create=e;function n(r){var i=r;return i&&A.string(i.name)&&A.number(i.kind)&&St.is(i.range)&&St.is(i.selectionRange)&&(i.detail===void 0||A.string(i.detail))&&(i.deprecated===void 0||A.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}u(n,"is"),t.is=n})(wg||(wg={}));var Xn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(Xn||(Xn={}));var yg;(function(t){function e(r,i){var o={diagnostics:r};return i!=null&&(o.only=i),o}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&A.typedArray(i.diagnostics,Gs.is)&&(i.only===void 0||A.typedArray(i.only,A.string))}u(n,"is"),t.is=n})(yg||(yg={}));var Cg;(function(t){function e(r,i,o){var a={title:r},s=!0;return typeof i=="string"?(s=!1,a.kind=i):ya.is(i)?a.command=i:a.edit=i,s&&o!==void 0&&(a.kind=o),a}u(e,"create"),t.create=e;function n(r){var i=r;return i&&A.string(i.title)&&(i.diagnostics===void 0||A.typedArray(i.diagnostics,Gs.is))&&(i.kind===void 0||A.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||ya.is(i.command))&&(i.isPreferred===void 0||A.boolean(i.isPreferred))&&(i.edit===void 0||_u.is(i.edit))}u(n,"is"),t.is=n})(Cg||(Cg={}));var bg;(function(t){function e(r,i){var o={range:r};return A.defined(i)&&(o.data=i),o}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&St.is(i.range)&&(A.undefined(i.command)||ya.is(i.command))}u(n,"is"),t.is=n})(bg||(bg={}));var Sg;(function(t){function e(r,i){return{tabSize:r,insertSpaces:i}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&A.uinteger(i.tabSize)&&A.boolean(i.insertSpaces)}u(n,"is"),t.is=n})(Sg||(Sg={}));var _g;(function(t){function e(r,i,o){return{range:r,target:i,data:o}}u(e,"create"),t.create=e;function n(r){var i=r;return A.defined(i)&&St.is(i.range)&&(A.undefined(i.target)||A.string(i.target))}u(n,"is"),t.is=n})(_g||(_g={}));var xg;(function(t){function e(r,i){return{range:r,parent:i}}u(e,"create"),t.create=e;function n(r){var i=r;return i!==void 0&&St.is(i.range)&&(i.parent===void 0||t.is(i.parent))}u(n,"is"),t.is=n})(xg||(xg={}));var s0=null,Ig;(function(t){function e(o,a,s,c){return new Gm(o,a,s,c)}u(e,"create"),t.create=e;function n(o){var a=o;return!!(A.defined(a)&&A.string(a.uri)&&(A.undefined(a.languageId)||A.string(a.languageId))&&A.uinteger(a.lineCount)&&A.func(a.getText)&&A.func(a.positionAt)&&A.func(a.offsetAt))}u(n,"is"),t.is=n;function r(o,a){for(var s=o.getText(),c=i(a,function(y,v){var m=y.range.start.line-v.range.start.line;return m===0?y.range.start.character-v.range.start.character:m}),l=s.length,d=c.length-1;d>=0;d--){var h=c[d],g=o.offsetAt(h.range.start),p=o.offsetAt(h.range.end);if(p<=l)s=s.substring(0,g)+h.newText+s.substring(p,s.length);else throw new Error("Overlapping edit");l=g}return s}u(r,"applyEdits"),t.applyEdits=r;function i(o,a){if(o.length<=1)return o;var s=o.length/2|0,c=o.slice(0,s),l=o.slice(s);i(c,a),i(l,a);for(var d=0,h=0,g=0;d<c.length&&h<l.length;){var p=a(c[d],l[h]);p<=0?o[g++]=c[d++]:o[g++]=l[h++]}for(;d<c.length;)o[g++]=c[d++];for(;h<l.length;)o[g++]=l[h++];return o}u(i,"mergeSort")})(Ig||(Ig={}));var Gm=function(){function t(e,n,r,i){this._uri=e,this._languageId=n,this._version=r,this._content=i,this._lineOffsets=void 0}return u(t,"FullTextDocument"),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(e){if(e){var n=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(n,r)}return this._content},t.prototype.update=function(e,n){this._content=e.text,this._version=n,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],n=this._content,r=!0,i=0;i<n.length;i++){r&&(e.push(i),r=!1);var o=n.charAt(i);r=o==="\r"||o===`
`,o==="\r"&&i+1<n.length&&n.charAt(i+1)===`
`&&i++}r&&n.length>0&&e.push(n.length),this._lineOffsets=e}return this._lineOffsets},t.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var n=this.getLineOffsets(),r=0,i=n.length;if(i===0)return Qn.create(0,e);for(;r<i;){var o=Math.floor((r+i)/2);n[o]>e?i=o:r=o+1}var a=r-1;return Qn.create(a,e-n[a])},t.prototype.offsetAt=function(e){var n=this.getLineOffsets();if(e.line>=n.length)return this._content.length;if(e.line<0)return 0;var r=n[e.line],i=e.line+1<n.length?n[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,i),r)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),A;(function(t){var e=Object.prototype.toString;function n(p){return typeof p!="undefined"}u(n,"defined"),t.defined=n;function r(p){return typeof p=="undefined"}u(r,"undefined"),t.undefined=r;function i(p){return p===!0||p===!1}u(i,"boolean"),t.boolean=i;function o(p){return e.call(p)==="[object String]"}u(o,"string"),t.string=o;function a(p){return e.call(p)==="[object Number]"}u(a,"number"),t.number=a;function s(p,y,v){return e.call(p)==="[object Number]"&&y<=p&&p<=v}u(s,"numberRange"),t.numberRange=s;function c(p){return e.call(p)==="[object Number]"&&-2147483648<=p&&p<=2147483647}u(c,"integer"),t.integer=c;function l(p){return e.call(p)==="[object Number]"&&0<=p&&p<=2147483647}u(l,"uinteger"),t.uinteger=l;function d(p){return e.call(p)==="[object Function]"}u(d,"func"),t.func=d;function h(p){return p!==null&&typeof p=="object"}u(h,"objectLiteral"),t.objectLiteral=h;function g(p,y){return Array.isArray(p)&&p.every(y)}u(g,"typedArray"),t.typedArray=g})(A||(A={}));var Sa;(function(t){function e(r){return typeof r=="string"||r instanceof String}u(e,"string"),t.string=e;function n(r){return typeof r=="number"||r instanceof Number}u(n,"number"),t.number=n})(Sa||(Sa={}));var ku;(function(t){function e(n){const r=n;return r!=null&&(Sa.number(r.value)||Sa.string(r.value))&&Sa.string(r.target)}u(e,"is"),t.is=e})(ku||(ku={}));class Eg extends f.Diagnostic{constructor(e,n,r,i){super(e,n,r);this.data=i,this.hasDiagnosticCode=!1}}u(Eg,"ProtocolDiagnostic");var Jn;(function(t){const e=Object.prototype.toString;function n(d){return typeof d!="undefined"}u(n,"defined"),t.defined=n;function r(d){return d===!0||d===!1}u(r,"boolean"),t.boolean=r;function i(d){return e.call(d)==="[object String]"}u(i,"string"),t.string=i;function o(d){return e.call(d)==="[object Number]"}u(o,"number"),t.number=o;function a(d){return d!==null&&typeof d=="object"}u(a,"objectLiteral"),t.objectLiteral=a;function s(d){return Array.isArray(d)}u(s,"array"),t.array=s;function c(d){return s(d)&&d.every(h=>i(h))}u(c,"stringArray"),t.stringArray=c;function l(d,h){return Array.isArray(d)&&d.every(h)}u(l,"typedArray"),t.typedArray=l})(Jn||(Jn={}));var Js;(function(t){function e(n){const r=n;return r&&Jn.string(r.language)&&Jn.string(r.value)}u(e,"is"),t.is=e})(Js||(Js={}));function Km(t){const e=u(S=>f.Uri.parse(S),"nullConverter"),n=t!=null?t:e;function r(S){return n(S)}u(r,"asUri");function i(S){return S.map(o)}u(i,"asDiagnostics");function o(S){const $=new Eg(h(S.range),S.message,p(S.severity),S.data);return S.code!==void 0&&(Su.is(S.codeDescription)?$.code={value:S.code,target:r(S.codeDescription.href)}:ku.is(S.code)?($.hasDiagnosticCode=!0,$.code={value:S.code.value,target:r(S.code.target)}):$.code=S.code),S.source&&($.source=S.source),S.relatedInformation&&($.relatedInformation=a(S.relatedInformation)),Array.isArray(S.tags)&&($.tags=c(S.tags)),$}u(o,"asDiagnostic");function a(S){return S.map(s)}u(a,"asRelatedInformation");function s(S){return new f.DiagnosticRelatedInformation(F(S.location),S.message)}u(s,"asDiagnosticRelatedInformation");function c(S){if(!S)return;const $=[];for(const we of S){const _t=l(we);_t!==void 0&&$.push(_t)}return $.length>0?$:void 0}u(c,"asDiagnosticTags");function l(S){switch(S){case js.Unnecessary:return f.DiagnosticTag.Unnecessary;case js.Deprecated:return f.DiagnosticTag.Deprecated;default:return}}u(l,"asDiagnosticTag");function d(S){if(!!S)return new f.Position(S.line,S.character)}u(d,"asPosition");function h(S){if(!!S)return new f.Range(d(S.start),d(S.end))}u(h,"asRange");function g(S){return S.map($=>h($))}u(g,"asRanges");function p(S){if(S==null)return f.DiagnosticSeverity.Error;switch(S){case Eo.Error:return f.DiagnosticSeverity.Error;case Eo.Warning:return f.DiagnosticSeverity.Warning;case Eo.Information:return f.DiagnosticSeverity.Information;case Eo.Hint:return f.DiagnosticSeverity.Hint}return f.DiagnosticSeverity.Error}u(p,"asDiagnosticSeverity");function y(S){if(Jn.string(S))return new f.MarkdownString(S);if(Js.is(S))return new f.MarkdownString().appendCodeblock(S.value,S.language);if(Array.isArray(S)){const we=[];for(const _t of S){const Fa=new f.MarkdownString;Js.is(_t)?Fa.appendCodeblock(_t.value,_t.language):Fa.appendMarkdown(_t),we.push(Fa)}return we}let $;switch(S.kind){case _r.Markdown:return new f.MarkdownString(S.value);case _r.PlainText:return $=new f.MarkdownString,$.appendText(S.value),$;default:return $=new f.MarkdownString,$.appendText(`Unsupported Markup content received. Kind is: ${S.kind}`),$}}u(y,"asHoverContent");function v(S){if(Jn.string(S))return S;switch(S.kind){case _r.Markdown:return new f.MarkdownString(S.value);case _r.PlainText:return S.value;default:return`Unsupported Markup content received. Kind is: ${S.kind}`}}u(v,"asDocumentation");function m(S){if(!!S)return new f.Hover(y(S.contents),h(S.range))}u(m,"asHover");function C(S){if(!!S)return new f.TextEdit(h(S.range),S.newText)}u(C,"asTextEdit");function w(S){if(!!S)return S.map(C)}u(w,"asTextEdits");function _(S){if(!S)return;const $=new f.SignatureHelp;return Jn.number(S.activeSignature)?$.activeSignature=S.activeSignature:$.activeSignature=0,Jn.number(S.activeParameter)?$.activeParameter=S.activeParameter:$.activeParameter=0,S.signatures&&($.signatures=E(S.signatures)),$}u(_,"asSignatureHelp");function E(S){return S.map(x)}u(E,"asSignatureInformations");function x(S){const $=new f.SignatureInformation(S.label);return S.documentation!==void 0&&($.documentation=v(S.documentation)),S.parameters!==void 0&&($.parameters=T(S.parameters)),S.activeParameter!==void 0&&($.activeParameter=S.activeParameter),$}u(x,"asSignatureInformation");function T(S){return S.map(W)}u(T,"asParameterInformations");function W(S){const $=new f.ParameterInformation(S.label);return S.documentation&&($.documentation=v(S.documentation)),$}u(W,"asParameterInformation");function F(S){if(!!S)return new f.Location(n(S.uri),h(S.range))}u(F,"asLocation");function G(S){if(!!S)return Q(S)}u(G,"asDeclarationResult");function Z(S){if(!!S)return Q(S)}u(Z,"asDefinitionResult");function ee(S){if(!S)return;const $={targetUri:n(S.targetUri),targetRange:h(S.targetSelectionRange),originSelectionRange:h(S.originSelectionRange),targetSelectionRange:h(S.targetSelectionRange)};if(!$.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return $}u(ee,"asLocationLink");function Q(S){if(!!S)return Jn.array(S)?S.length===0?[]:zs.is(S[0])?S.map(_t=>ee(_t)):S.map(we=>F(we)):zs.is(S)?[ee(S)]:F(S)}u(Q,"asLocationResult");function se(S){if(!!S)return S.map($=>F($))}u(se,"asReferences");function R(S){if(!!S)return S.map(O)}u(R,"asDocumentHighlights");function O(S){const $=new f.DocumentHighlight(h(S.range));return Jn.number(S.kind)&&($.kind=j(S.kind)),$}u(O,"asDocumentHighlight");function j(S){switch(S){case ba.Text:return f.DocumentHighlightKind.Text;case ba.Read:return f.DocumentHighlightKind.Read;case ba.Write:return f.DocumentHighlightKind.Write}return f.DocumentHighlightKind.Text}u(j,"asDocumentHighlightKind");function z(S,$){if(!!S)return S.map(we=>Se(we,$))}u(z,"asSymbolInformations");function te(S){return S<=Iu.TypeParameter?S-1:f.SymbolKind.Property}u(te,"asSymbolKind");function oe(S){switch(S){case Eu.Deprecated:return f.SymbolTag.Deprecated;default:return}}u(oe,"asSymbolTag");function fe(S){if(S==null)return;const $=[];for(const we of S){const _t=oe(we);_t!==void 0&&$.push(_t)}return $.length===0?void 0:$}u(fe,"asSymbolTags");function Se(S,$){const we=new f.SymbolInformation(S.name,te(S.kind),h(S.location.range),S.location.uri?n(S.location.uri):$);return M(we,S),S.containerName&&(we.containerName=S.containerName),we}u(Se,"asSymbolInformation");function Oe(S){if(S!=null)return S.map(mn)}u(Oe,"asDocumentSymbols");function mn(S){var $;const we=new f.DocumentSymbol(S.name,($=S.detail)!=null?$:"",te(S.kind),h(S.range),h(S.selectionRange));if(M(we,S),S.children!==void 0&&S.children.length>0){const _t=[];for(const Fa of S.children)_t.push(mn(Fa));we.children=_t}return we}u(mn,"asDocumentSymbol");function M(S,$){S.tags=fe($.tags),$.deprecated&&(S.tags?S.tags.includes(f.SymbolTag.Deprecated)||(S.tags=S.tags.concat(f.SymbolTag.Deprecated)):S.tags=[f.SymbolTag.Deprecated])}u(M,"fillTags");function V(S){const $={title:S.title,command:S.command};return S.arguments&&($.arguments=S.arguments),$}u(V,"asCommand");function X(S){if(!!S)return S.map(V)}u(X,"asCommands");const K=new Map;K.set(Xn.Empty,f.CodeActionKind.Empty),K.set(Xn.QuickFix,f.CodeActionKind.QuickFix),K.set(Xn.Refactor,f.CodeActionKind.Refactor),K.set(Xn.RefactorExtract,f.CodeActionKind.RefactorExtract),K.set(Xn.RefactorInline,f.CodeActionKind.RefactorInline),K.set(Xn.RefactorRewrite,f.CodeActionKind.RefactorRewrite),K.set(Xn.Source,f.CodeActionKind.Source),K.set(Xn.SourceOrganizeImports,f.CodeActionKind.SourceOrganizeImports);function ne(S){if(S==null)return;let $=K.get(S);if($)return $;const we=S.split(".");$=f.CodeActionKind.Empty;for(const _t of we)$=$.append(_t);return $}u(ne,"asCodeActionKind");function he(S){if(S!=null)return S.map($=>ne($))}u(he,"asCodeActionKinds");function ue(S){if(S==null)return;const $=new f.CodeAction(S.title);return S.kind!==void 0&&($.kind=ne(S.kind)),S.diagnostics&&($.diagnostics=i(S.diagnostics)),S.edit&&($.edit=_e(S.edit)),S.command&&($.command=V(S.command)),S.isPreferred!==void 0&&($.isPreferred=S.isPreferred),$}u(ue,"asCodeAction");function _e(S){if(!S)return;const $=new f.WorkspaceEdit;return S.documentChanges?S.documentChanges.forEach(we=>{if(Ro.is(we))$.createFile(n(we.uri),we.options);else if(Do.is(we))$.renameFile(n(we.oldUri),n(we.newUri),we.options);else if(To.is(we))$.deleteFile(n(we.uri),we.options);else if(Ca.is(we))$.set(n(we.textDocument.uri),w(we.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(we,void 0,4)}`)}):S.changes&&Object.keys(S.changes).forEach(we=>{$.set(n(we),w(S.changes[we]))}),$}u(_e,"asWorkspaceEdit");function $e(S){return new f.Color(S.red,S.green,S.blue,S.alpha)}u($e,"asColor");function Ze(S){return new f.ColorInformation(h(S.range),$e(S.color))}u(Ze,"asColorInformation");function At(S){if(Array.isArray(S))return S.map(Ze)}u(At,"asColorInformations");function Rr(S){const $=new f.ColorPresentation(S.label);return $.additionalTextEdits=w(S.additionalTextEdits),S.textEdit&&($.textEdit=C(S.textEdit)),$}u(Rr,"asColorPresentation");function dc(S){if(Array.isArray(S))return S.map(Rr)}u(dc,"asColorPresentations");function Mo(S){if(S)switch(S){case wa.Comment:return f.FoldingRangeKind.Comment;case wa.Imports:return f.FoldingRangeKind.Imports;case wa.Region:return f.FoldingRangeKind.Region}}u(Mo,"asFoldingRangeKind");function wn(S){return new f.FoldingRange(S.startLine,S.endLine,Mo(S.kind))}u(wn,"asFoldingRange");function Xu(S){if(Array.isArray(S))return S.map(wn)}u(Xu,"asFoldingRanges");function Ju(S){return new f.SelectionRange(h(S.range),S.parent?Ju(S.parent):void 0)}u(Ju,"asSelectionRange");function Jw(S){if(!Array.isArray(S))return[];const $=[];for(const we of S)$.push(Ju(we));return $}return u(Jw,"asSelectionRanges"),{asUri:r,asDiagnostics:i,asDiagnostic:o,asRange:h,asRanges:g,asPosition:d,asDiagnosticSeverity:p,asDiagnosticTag:l,asHover:m,asTextEdit:C,asTextEdits:w,asSignatureHelp:_,asSignatureInformations:E,asSignatureInformation:x,asParameterInformations:T,asParameterInformation:W,asDeclarationResult:G,asDefinitionResult:Z,asLocation:F,asReferences:se,asDocumentHighlights:R,asDocumentHighlight:O,asDocumentHighlightKind:j,asSymbolKind:te,asSymbolTag:oe,asSymbolTags:fe,asSymbolInformations:z,asSymbolInformation:Se,asDocumentSymbols:Oe,asDocumentSymbol:mn,asCommand:V,asCommands:X,asCodeAction:ue,asCodeActionKind:ne,asCodeActionKinds:he,asWorkspaceEdit:_e,asFoldingRangeKind:Mo,asFoldingRange:wn,asFoldingRanges:Xu,asColor:$e,asColorInformation:Ze,asColorInformations:At,asColorPresentation:Rr,asColorPresentations:dc,asSelectionRange:Ju,asSelectionRanges:Jw}}u(Km,"createConverter");const ct=J.loadMessageBundle();var Yn;(function(t){function e(r,i){const{provider:o,repo:a}=i instanceof f.Uri?r.getVirtualUriMetadata(i):i;return r.getRemoteUri(o.id,{repo:a})}u(e,"externalUri"),t.externalUri=e;function n(r,i){const{provider:o,repo:a}=i instanceof f.Uri?r.getVirtualUriMetadata(i):i;return r.getRemoteUri(o.id,{repo:a})}u(n,"externalIndexUri"),t.externalIndexUri=n})(Yn||(Yn={}));var Yr;(function(t){function e(i){if(i.HEAD.type===ye.Branch||i.HEAD.type===ye.RemoteBranch)return i.HEAD.name}u(e,"getBranchName"),t.getBranchName=e;function n(i){if(i.HEAD.type!==ye.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}u(n,"getIndexBranchName"),t.getIndexBranchName=n;async function r(i,o,a=pt.timeout){const s=await i.getMetadata(o),c=Yn.externalIndexUri(i,s),l=t.getIndexBranchName(s);if(!(c===void 0||l===void 0))return pt.getIndexedTip(c,l,{authentication:i.getAuthentication(o)},a)}u(r,"getIndexedTip"),t.getIndexedTip=r})(Yr||(Yr={}));var _a;(function(t){const e=new Cr(1024);function n(a,s,c){let l=e.get(c);return l!==void 0||(l=a.getCommit(s,c),e.set(c,l)),l}u(n,"get"),t.get=n;async function r(a,s,c){const l=[];for(const h of c)l.push(n(a,s,h));const d=[];for(const h of await Promise.all(l))h!==void 0&&d.push(h);return d}u(r,"all"),t.all=r;function i(a,s){const c=a.commitDate,l=s.commitDate;return c===void 0&&l===void 0?0:c===void 0?1:l===void 0?-1:c<l?1:c>l?-1:0}u(i,"sort"),t.sort=i;function o(a){const s=a.authorName!==void 0?`  \u2022  ${a.authorName}`:"",c=a.commitDate!==void 0?`  \u2022  ${_o(a.commitDate,{ago:!0})}`:"",l=a.branchName!==void 0?` - ${a.branchName}`:"",d=a.tags!==void 0?typeof a.tags=="string"?`  \u2022  ${a.tags}`:`  \u2022  ${a.tags.join(" ")}`:"";return{author:s,date:c,branch:l,tag:d}}u(o,"getCommitInfo"),t.getCommitInfo=o})(_a||(_a={}));var kg;(function(t){t[t.Unknown=0]="Unknown",t[t.New=1]="New",t[t.Failed=2]="Failed",t[t.Partial=3]="Partial",t[t.InProgress=4]="InProgress",t[t.Complete=5]="Complete",t[t.PartialIndex=6]="PartialIndex",t[t.CompleteIndex=7]="CompleteIndex"})(kg||(kg={}));var Ys;(function(t){function e(r){return{workspaceId:r.WorkspaceId,snapshotId:r.SnapshotId,state:r.State,commitId:r.commitId.toLowerCase(),branchName:n(r.BranchName),creationDate:new Date(r._ts*1e3)}}u(e,"asWorkspaceSnapshot"),t.asWorkspaceSnapshot=e;function n(r){if(r!==null)return r.startsWith("refs/heads/")?r.substr(11):r}u(n,"getBranchName")})(Ys||(Ys={}));var pt;(function(t){t.timeout=5*60*1e3;const e=new Cr(32),n=new Cr(32);async function r(h,g,p,y=t.timeout){const v=await i(h,g,p,y);if(!(v===void 0||v.length===0))return v[0]}u(r,"getIndexedTip"),t.getIndexedTip=r;async function i(h,g,p,y=t.timeout){const v=s(h,g);let m=e.get(v);if(m===void 0||m!==void 0&&Date.now()-m.time>y){const C=sn.getAllWorkspaceSnapshots(h,p,g);m={time:Date.now(),promise:C,snapshots:void 0},e.set(v,m)}if(m.snapshots!==null){if(m.snapshots===void 0){let C=await m.promise;if(C===void 0){m.snapshots=null;return}C.sort((w,_)=>_.creationDate.getTime()-w.creationDate.getTime()),C=C.filter(w=>w.state===5||w.state===3),m.snapshots=C}return m.snapshots}}u(i,"all"),t.all=i;async function o(h,g,p,y,v=t.timeout){const m=a(h,g);let C=n.get(m);if(C===null)return;if(C!==void 0)return C;const w=s(h,p),_=e.get(w);if(_!==void 0&&Date.now()-_.time<=v){if(_.snapshots===null)return;const E=_.snapshots!==void 0?_.snapshots:await i(h,p,y);if(E!==void 0){for(const x of E)if(x.commitId===g)return n.set(m,x),x}return}if(C=await sn.getWorkspaceSnapshot(g,y),C===void 0){n.set(m,null);return}return n.set(m,C),C}u(o,"single"),t.single=o;function a(h,g){return`${h.toString()}/${g}`}u(a,"getSingleCacheKey");function s(h,g){return g!==void 0?`${g}\\${h.toString()}`:h.toString()}u(s,"getAllCacheKey");async function c(h,g,p,y=t.timeout){return await o(h,g,void 0,p,y)!==void 0}u(c,"exists"),t.exists=c;async function l(h,g,p,y=t.timeout){return await i(h,g,p,y)!==void 0}u(l,"branch"),t.branch=l;async function d(h,g,p){const y=new Map(p.map(C=>[C.commitId,C])),v=await _a.all(h,g.uri,p.map(C=>C.commitId));if(v.length===0)return;const m=[];for(const C of v){const w=y.get(C.hash);w!==void 0&&m.push({...w,commit:C})}if(m.length!==0)return m}u(d,"resolve"),t.resolve=d})(pt||(pt={}));var Zn;(function(t){function e(n=!1){return{hoverProvider:n,declarationProvider:n,definitionProvider:n,typeDefinitionProvider:n,referencesProvider:n,documentSymbolProvider:n,foldingRangeProvider:n,diagnosticProvider:n,workspaceSymbolProvider:n}}u(e,"create"),t.create=e})(Zn||(Zn={}));var sn;(function(t){const e="v0.1",n="https://prod.richnav.vsengsaas.visualstudio.com/api";async function r(w,_,E){var x;const T=await ga(w,{method:"POST",body:JSON.stringify(_),headers:{"Content-Type":"application/json",...(await E.authentication).getRichNavigationHeaders(),"x-correlation-id":(x=E.correlationId)!=null?x:Af()}});if(!!T.ok)return T.json()}u(r,"postRequest");async function i(w,_,E){const x=await ga(w,{method:"POST",body:_,headers:(await E.authentication).getRichNavigationHeaders()});if(!!x.ok)return await x.json()}u(i,"postForm");function o(w,_){return`${n}/${e}/HttpLanguageService/${w}/${_}`}u(o,"makeRequestUrl");async function a(w,_){const E=await ga(`${n}/${e}/WorkspaceSnapshot?commitId=${w}`,{headers:(await _.authentication).getRichNavigationHeaders()});if(E.ok){const x=await E.json();return{workspaceId:x.workspaceId,snapshotId:x.snapshotId,state:x.state,commitId:w.toLowerCase(),branchName:void 0,creationDate:new Date}}}u(a,"getWorkspaceSnapshot"),t.getWorkspaceSnapshot=a;async function s(w,_,E){const x=new Tf;x.append("uriString",w.toString(!0)),E!==void 0&&x.append("branchName",E);try{const T=await i(`${n}/${e}/WorkspaceSnapshot/all`,x,_);return T===void 0?void 0:T.map(Ys.asWorkspaceSnapshot)}catch(T){U.error(T);return}}u(s,"getAllWorkspaceSnapshots"),t.getAllWorkspaceSnapshots=s;async function c(w,_,E){const x=new Tf;x.append("uriString",w.toString(!0)),E!==void 0&&x.append("branchName",E);try{const T=await i(`${n}/${e}/WorkspaceSnapshot/latest`,x,_);return T===void 0?void 0:Ys.asWorkspaceSnapshot(T)}catch(T){U.error(T);return}}u(c,"getLatestWorkspaceSnapshot"),t.getLatestWorkspaceSnapshot=c;async function l(w,_,E){try{return r(o(w,"textDocument/capabilities"),_,E)}catch(x){U.error(x);return}}u(l,"capabilities"),t.capabilities=l;async function d(w,_,E){try{return r(o(w,"textDocument/hover"),_,E)}catch(x){U.error(x);return}}u(d,"provideHover"),t.provideHover=d;async function h(w,_,E){try{return r(o(w,"textDocument/definition"),_,E)}catch(x){U.error(x);return}}u(h,"provideDefinition"),t.provideDefinition=h;async function g(w,_,E){try{return r(o(w,"textDocument/declaration"),_,E)}catch(x){U.error(x);return}}u(g,"provideDeclaration"),t.provideDeclaration=g;async function p(w,_,E){try{return r(o(w,"textDocument/typeDefinition"),_,E)}catch(x){U.error(x);return}}u(p,"provideTypeDefinition"),t.provideTypeDefinition=p;async function y(w,_,E){try{return r(o(w,"textDocument/references"),_,E)}catch(x){U.error(x);return}}u(y,"provideReferences"),t.provideReferences=y;async function v(w,_,E){try{return r(o(w,"textDocument/foldingRange"),_,E)}catch(x){U.error(x);return}}u(v,"providerFoldingRanges"),t.providerFoldingRanges=v;async function m(w,_,E){if(_=="")return;const x=await ga(`${n}/${e}/Search/${w}/${_}`,{headers:(await E.authentication).getRichNavigationHeaders()});if(x.ok)return await x.json()}u(m,"provideWorkspaceSymbols"),t.provideWorkspaceSymbols=m;async function C(w,_,E){const x=f.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${w}/${_}/assets/designtime`,query:`id=${E}`});try{const T=await ga(x.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return T.ok?T.text():void 0}catch(T){U.error(T);return}}u(C,"getDesignTimeFileContent"),t.getDesignTimeFileContent=C})(sn||(sn={}));class Rg{constructor(e,n){this.providerService=e,this.telemetryService=n,this.metadata=new Map;const r=[];r.push(this.providerService.onDidChangeRepositories(i=>{var o;for(const a of i.added){const s=a.uri,c=de.getIndexMemento(s);if(c!==void 0){const l=Yn.externalIndexUri(this.providerService,s);l!==void 0&&(typeof((o=c.branch)==null?void 0:o.name)=="string"?pt.all(l,c.branch.name,{authentication:this.providerService.getAuthentication(s)}).catch(void 0):typeof c.ref=="string"&&rt(c.ref)&&pt.single(l,c.ref,void 0,{authentication:this.providerService.getAuthentication(s)}).catch(void 0))}this.providerService.getMetadata(s).then(l=>{const d={},h=l.pullRequest===void 0?Yr.getIndexBranchName(l):void 0;h!==void 0?d.branch={name:h}:d.ref=l.HEAD.sha,de.setIndexMemento(s,d).then(void 0,void 0)},void 0)}})),r.push(this.providerService.onDidChangeRepository(i=>{const o=i.repository.uri,a=N(o);this.metadata.delete(a),this.getIndexMetadata(o).catch(void 0)})),this.disposable=f.Disposable.from(...r)}dispose(){this.disposable.dispose()}async resolveIndexRef(e,n){const r=await this.providerService.getModeRefType(e),i=Si.decode(e);if(i!==void 0){if(i.type===an.Latest)return r===Re.Branch?this.getIndexedTip(e,n?0:pt.timeout):void 0;if(i.type===an.SHA){const a=Yn.externalIndexUri(this.providerService,e);return a===void 0?void 0:await pt.exists(a,i.sha,{authentication:this.providerService.getAuthentication(e)},n?0:pt.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,r).index===pe.Latest)return this.getIndexedTip(e,n?0:pt.timeout)}refresh(e){for(const n of e)this.metadata.delete(n.toString())}getIndexMetadata(e){const n=this.providerService.getVirtualRootUri(e),r=N(n);let i=this.metadata.get(r);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(r,i)),i}async getIndexedTip(e,n=pt.timeout){const r=await Yr.getIndexedTip(this.providerService,e,n);return r!==void 0?r.commitId:void 0}async createIndexMetadata(e){const n=new Pe(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const r=Yn.externalIndexUri(this.providerService,e);if(r===void 0)return;n.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),a=await i;n.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const s=this.providerService.getAuthentication(e),c=a.pullRequest===void 0?Yr.getIndexBranchName(a):void 0,l=await pt.single(r,a.HEAD.sha,c,{authentication:this.providerService.getAuthentication(e)});if(a.HEAD.type===ye.Branch||a.HEAD.type===ye.RemoteBranch){const p=Si.decode(e);if(p!==void 0)return n.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),l===void 0?p.type===an.Latest?(n.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),c!==void 0&&await pt.branch(r,c,{authentication:this.providerService.getAuthentication(e)})?{type:De.Indexed}:{type:De.NotIndexed}):{type:De.NotIndexed}:p.type===an.Latest||p.type===an.SHA?{type:De.Active,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}}:{type:De.Match,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}}}n.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const h=this.providerService.getModeConfig(e,await o),g=this.providerService.getVirtualUriMetadata(e);if((h.index===pe.Latest||h.index===pe.Match)&&l!==void 0)return{type:De.Active,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}};if(h.index===pe.TipPlusLatest&&g.provider.id==="github"){if(l!==void 0&&l.commitId===a.HEAD.sha)return{type:De.Active,sha:Promise.resolve(l.commitId),branch:{name:l.branchName}};if(a.HEAD.type===ye.Branch&&c!==void 0){n.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const p=await pt.all(r,c,{authentication:s});if(p!==void 0&&p.length>0)return{type:De.Active,sha:this.computeClosestIndex(e,a.HEAD.sha,p),branch:{name:c}}}}return l!==void 0?{type:De.Indexed}:a.HEAD.type===ye.Branch&&(n.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),c!==void 0&&await pt.branch(r,c,{authentication:s}))?{type:De.Indexed}:{type:De.NotIndexed}}finally{n.stop()}}async computeClosestIndex(e,n,r){if(r.length===0)throw new Error("At least on snapshot should exist");const i=new Set(r.map(d=>d.commitId)),o=await this.providerService.getCommits(e,{ref:n,limit:100});if(o===void 0)return;let a;for(const d of o.commits)if(d.hash===n){a=d;break}if(a===void 0)return;const s=new Map(o.commits.map(d=>[d.hash,d])),c=[a];let l;for(;c.length>0;){for(l=c.shift();l!==void 0&&!i.has(l.hash);)if(l.parents.length>0){for(let d=1;d<l.parents.length;d++){const h=s.get(l.parents[d]);h!==void 0&&c.push(h)}l=s.get(l.parents[0])}if(l!==void 0)break}return l!==void 0?l.hash:void 0}async getSnapshots(e,n){const r=Yn.externalIndexUri(this.providerService,e);if(r===void 0)return[];const i=await pt.all(r,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const a of i)a.branchName!==void 0&&o.push({workspaceId:a.workspaceId,snapshotId:a.snapshotId,hash:a.commitId,branch:{name:a.branchName}});return o}async getStatusBarContributions(e){const n=await this.providerService.getMetadata(e),[r,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,n)]),o=this.providerService.getModeConfig(e,i);if(r===void 0)return[];const{HEAD:a}=n,s=[];if(r!==void 0){let c;const l=[`${Fe(a.sha)}`];if(r.type===De.Active){const d=await r.sha;o.index===pe.Latest||o.index===pe.Match?(c=o.display===ve.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",l.push(ct("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===pe.TipPlusLatest&&(c="$(layers-dot)",d!==n.HEAD.sha?l.push(ct("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):l.push(ct("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else r.type===De.Match?(c="$(layers)",l.push(ct("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):r.type===De.Indexed&&(c="$(layers)",l.push(ct("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));c&&s.push(Nn({command:"remoteHub.indexMode.select",title:c,tooltip:l.join(`
`),arguments:[{uri:e}]}))}return s}}u(Rg,"RichNavIndexProvider");var Ii;(function(t){let e;function n(){return e=f.window.createStatusBarItem(f.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,f.window.onDidChangeActiveTextEditor(()=>{c()}),f.commands.registerCommand("remoteHub.indexMode.select",d=>{l(d).catch(h=>U.log("Selecting index mode failed.",h))})]}u(n,"create"),t.create=n;const r=new Map;function i(d){r.set(d.key(),d)}u(i,"addService"),t.addService=i;function o(d){r.delete(d.key())}u(o,"removeService"),t.removeService=o;function a(d){return r.get(N(d))}u(a,"getService");async function s(d){for(const h of r.values())if(await h.handles(d))return h}u(s,"getServiceForDocument");async function c(){try{let d=u(function(y){const v=y.lastIndexOf("/");return v<=0?y:y.substr(v+1)},"basename");const h=f.window.activeTextEditor;if(h===void 0){e.hide();return}const g=await s(h.document);if(g===void 0){e.hide();return}const p=await g.isDocumentIndexed(h.document);p===Zs.Indexed?(e.text="$(compass)",e.tooltip=new f.MarkdownString(ct("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",d(h.document.uri.path))),e.show()):p===Zs.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new f.MarkdownString(ct("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",d(h.document.uri.path))),e.show()):e.hide()}catch(d){e.hide()}}u(c,"updateStatusBarItem"),t.updateStatusBarItem=c;async function l(d){var h;const g=d.uri,p=a(g);if(p===void 0)return;const[y,v,m,C]=await Promise.all([p.getBranchName(),p.getMetadata(),p.getIndexMetadata(),p.getModeRefType(g)]);if(m===void 0||!De.hasIndex(m.type))return;let w,_=!1;const E=Si.decode(g);(E==null?void 0:E.type)===an.Latest||(E==null?void 0:E.type)===an.SHA?(_=!0,w={display:ve.Browse,index:E.type===an.Latest?pe.Latest:pe.Match}):w=(h=p.getCurrentIndexMode())!=null?h:p.getModeConfig(g,C);const x=p.getUriMetadata(),T=ct("current item","{0} current","$(check)"),W={indexKind:"disable",label:ct("RichNavStatus.disable.label","Disable"),description:w.index===pe.None?`  \u2022  ${T}`:void 0,detail:ct("RichNavStatus.disable.detail","Disable rich navigation.")};let F,G;if(C===Re.PullRequestBranch||C===Re.PullRequestRemoteBranch||C===Re.Commit||C===Re.Tag){const Z={indexKind:"match",label:ct("RichNavStatus.match.label","Current indexed commit - readonly"),description:w.index===pe.Match&&w.display===ve.Browse?`  \u2022  ${T}`:void 0,detail:ct("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},ee={indexKind:"match+writeable",label:ct("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:w.index===pe.Match&&w.display===ve.Edit?`  \u2022  ${T}`:void 0,detail:ct("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let Q=x.provider.id==="github";Q&&(Q=v.HEAD.type===ye.RemoteBranch?v.HEAD.branch.remote.accessLevel>=$t.Write:!0);const se=Q?[Z,ee,W]:[Z,W];G=await f.window.showQuickPick(se,{placeHolder:"Pick a rich navigation mode"})}else if(C===Re.Branch||C===Re.RemoteBranch){const Z={indexKind:"latest",label:ct("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:w.index===pe.Latest?`  \u2022  ${T}`:void 0,detail:ct("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},ee={indexKind:"tip+latest",label:ct("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:w.index===pe.TipPlusLatest?`  \u2022  ${T}`:void 0,detail:ct("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},Q=x.provider.id==="github"?[Z,ee,W]:[Z,W];G=await f.window.showQuickPick(Q,{placeHolder:ct("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",y)})}if(G!==void 0&&(G.indexKind==="disable"?F={display:ve.Edit,index:pe.None}:G.indexKind==="match"?F={display:ve.Browse,index:pe.Match}:G.indexKind==="match+writeable"?F={display:ve.Edit,index:pe.Match}:G.indexKind==="tip+latest"?F={display:ve.Edit,index:pe.TipPlusLatest}:G.indexKind==="latest"&&(F={display:ve.Browse,index:pe.Latest}),F!==void 0&&!Pi.equals(w,F))){if(await p.hasChanges()&&F.display===ve.Browse){await f.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0});return}if(await p.updateIndexMode(F),_){const Z=await p.getNonIndexedWorkspaceDescriptor();Z!==void 0&&Mn(p.getProviderService(),Z)}}}u(l,"toggleIndexMode")})(Ii||(Ii={}));class Ru{constructor(e){this.telemetryService=e}static createStatus(){return Ii.create()}async createNavigationService(e,n){const r=await e.getIndexMetadata(n.uri);if(!(r===void 0||r.type===De.NotIndexed))return()=>new Tu(e,n,this.telemetryService)}}u(Ru,"RichNavServiceProvider");var xa;(function(t){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function n(i){const o=e.exec(i);if(o===null||o.length!==5)return;const a={v:1,w:o[1],s:o[2],a:o[3]};return f.Uri.from({scheme:xr.scheme,authority:Bt(JSON.stringify(a)),path:o[4]})}u(n,"toVSCode"),t.toVSCode=n;function r(i){if(i.scheme!==xr.scheme)return;let o;try{return o=JSON.parse(Jt(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}u(r,"toRichNavComponents"),t.toRichNavComponents=r})(xa||(xa={}));const Du=u(class{constructor(){this._onDidChangeFile=new f.EventEmitter,this.cache=new Cr(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(t,e){return Du.emptyDisposable}async stat(t){const e=await this.getFile(t);if(e===void 0)throw f.FileSystemError.FileNotFound();return{type:f.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:f.FilePermission.Readonly}}readDirectory(t){return[]}createDirectory(t){throw f.FileSystemError.NoPermissions()}async readFile(t){const e=await this.getFile(t);if(e===void 0)throw f.FileSystemError.FileNotFound();return e.content}writeFile(t,e,n){throw f.FileSystemError.NoPermissions()}delete(t,e){throw f.FileSystemError.NoPermissions()}rename(t,e,n){throw f.FileSystemError.NoPermissions()}async getFile(t){let e=this.cache.get(t.toString());if(e!==void 0)return e;if(t.scheme!==Du.scheme)return;const n=xa.toRichNavComponents(t);if(n===void 0)return;const r=await sn.getDesignTimeFileContent(n.workspaceId,n.snapshotId,n.assetId);if(r!==void 0)return e={content:this.textEncoder.encode(r),time:Date.now()},this.cache.set(t.toString(),e),e}},"_RichNavFileSystemProvider");let xr=Du;xr.scheme="vsck-fs",xr.emptyDisposable={dispose:()=>{}};var Zs;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.IndexMapped=1]="IndexMapped",t[t.Indexed=2]="Indexed"})(Zs||(Zs={}));const Ln=u(class{static registerCapability(t,e,n){var r;const i=this.disabledCapabilities.get(t);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(t);return(o==null?void 0:o[e])?!1:(r=n[e])!=null?r:!1}constructor(t,e,n){this.providerService=t,this.repository=e,this.telemetryService=n,this.repositoryRoot=`${e.uri.toString()}/`;const r=u((o=!1)=>{const a=this.repository.uri;o||(this.metadata=this.providerService.getMetadata(a),this.indexMetadata=this.providerService.getIndexMetadata(a)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(a,this.metadata)]).then(async s=>{var c,l;const[d,h,g]=this.currentlyResolved,[p,y,v]=s,m=this.providerService.getModeConfig(a,v);if(d!==void 0&&h!==void 0&&g!==void 0&&d.HEAD.sha===p.HEAD.sha&&y!==void 0&&h.type===y.type&&g.index===m.index&&g.display===m.display){const w=(h==null?void 0:h.type)===De.Active?await h.sha:void 0,_=(y==null?void 0:y.type)===De.Active?await y.sha:void 0;if(w===_)return}const C={newDisplayMode:m.display,newIndexMode:m.index,newIndexType:(y==null?void 0:y.type)===void 0?"undefined":De[y==null?void 0:y.type],currentDisplayMode:(c=g==null?void 0:g.display)!=null?c:"undefined",currentIndexMode:(l=g==null?void 0:g.index)!=null?l:"undefined",currentIndexType:(h==null?void 0:h.type)===void 0?"undefined":De[h==null?void 0:h.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",C),this.currentlyResolved=[p,y,m];for(const w of this.registeredFeatures.values())w.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,pu.isActive(y)){const w=Yn.externalIndexUri(this.providerService,p),_=await y.sha;if(w!==void 0&&_!==void 0){const E=await pt.single(w,_,Yr.getIndexBranchName(p),{authentication:this.providerService.getAuthentication(a)});E!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:E.snapshotId}),this.workspaceSnapshot=E,this.documentListeners=this.installDocumentListeners(),((m==null?void 0:m.display)===ve.Edit||p.HEAD.sha!==_)&&(this.mapper=new Xf(this.providerService,a,_,p.HEAD.sha)))}}await Ii.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new Cr(2048),this.knownDesignTimeFiles=new Set;const i=[];i.push(this.providerService.onDidChangeRepository(o=>{N(o.repository.uri)===N(this.repository.uri)&&r()})),i.push(this.providerService.onDidRefresh(o=>{for(const a of o)if(N(a)===N(this.repository.uri)){r();break}})),this.environmentListeners=f.Disposable.from(...i),r(!0),Ii.addService(this),this.indexMetadata.then(async o=>{var a;const s=this.repository.uri;let c=!1;const l=Si.decode(this.repository.uri);if(l!==void 0&&o!==void 0&&(l.type===an.Latest&&o.type!==De.Active||l.type===an.SHA&&(o.type!==De.Active||await o.sha!==l.sha))&&(c=!0),!c){await this.metadata;const d=await this.providerService.getModeRefType(s,this.metadata),h=(a=this.currentlyResolved[2])!=null?a:this.providerService.getModeConfig(s,d,!0);h!==void 0&&h.display===ve.Browse&&o!==void 0&&h.index!==pe.None&&o.type!==De.Active?c=!0:(o==null?void 0:o.type)===De.Active&&await o.sha===void 0&&((h==null?void 0:h.display)===ve.Browse,c=!0)}c&&f.window.showWarningMessage(ct("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),Ln.fileSystemProvider===void 0&&(Ln.fileSystemProvider=new xr,f.workspace.registerFileSystemProvider(xr.scheme,Ln.fileSystemProvider))}getRepository(){return this.repository}async updateIndexMode(t){const e=this.currentlyResolved[2],n=t!==void 0;if(t===void 0){const r=this.repository.uri,i=await this.providerService.getModeRefType(r,this.metadata);t=this.providerService.getModeConfig(r,i),await new Promise(o=>setTimeout(o,1e3))}if(e===void 0||e.index!==t.index||e.display!==t.display){if(t.index===pe.Latest){await Promise.all([this.metadata,this.indexMetadata]);const r=await this.getIndexedTip();if(r===void 0)return;await this.sync(r.hash)}else t.index===pe.TipPlusLatest&&(await Promise.all([this.metadata,this.indexMetadata]),await this.sync());n&&await de.setMode(this.repository.uri,t),this.refresh()}}getCurrentIndexMode(){return this.currentlyResolved[2]}key(){return N(this.repository.uri)}dispose(){for(const t of this.registeredFeatures.values())t.dispose();this.registeredFeatures.clear(),Ii.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(t){return t.uri.scheme!==Wt.scheme?Promise.resolve(!1):Promise.resolve(t.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return Yr.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getProviderService(){return this.providerService}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(t,e){return this.providerService.getModeConfig(t,e)}getModeRefType(t){return this.providerService.getModeRefType(t)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:t,repo:e}=await this.metadata,{ref:n}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:t,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:n}),location:Ke.CurrentWindow}}async isDocumentIndexed(t){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===De.NotIndexed||this.workspaceSnapshot===void 0)return 0;const n=this.pendingCapabilitiesRequests.get(t.uri.toString());return n!==void 0&&await n,this.registeredFeatures.has(t.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(t)?1:2:0}async getIndexedTip(){const t=await this.metadata,e=Yn.externalIndexUri(this.providerService,t),n=Yr.getIndexBranchName(t);if(e===void 0||n===void 0)return;const r=await pt.getIndexedTip(e,n,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(r===void 0)return;const i=await _a.get(this.providerService,this.repository.uri,r.commitId);if(i!==void 0)return{...i,branchName:n}}hasChanges(){return this.providerService.getChangeStore(this.repository.uri).hasChanges(this.repository.uri)}sync(t){return this.providerService.sync(this.repository.uri,{to:t,reason:"user"})}async getCommit(t){const e=await this.metadata,n=Yn.externalIndexUri(this.providerService,e);if(n===void 0)return;const[r,i]=await Promise.all([_a.get(this.providerService,this.repository.uri,t),pt.single(n,t,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(r===void 0||i===void 0))return{...r,branchName:i.branchName}}installDocumentListeners(){const t=[],e=u(async n=>{const r=n.uri.scheme;if(Wt.scheme!==r&&xr.scheme!==r)return;const i=n.uri.toString();if(r===Wt.scheme&&!i.startsWith(this.repositoryRoot)||r===xr.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let a=this.capabilitiesCache.get(i);if(a!==null){if(a===void 0){const s=this.capabilities(n.uri);this.pendingCapabilitiesRequests.set(i,s),a=await s,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,a===void 0?null:a)}a===void 0||!f.workspace.textDocuments.some(s=>s===n)||this.registerProviders(n,a,o)}},"openHandler");return t.push(f.workspace.onDidOpenTextDocument(e)),f.workspace.textDocuments.forEach(e),t.push(f.workspace.onDidCloseTextDocument(n=>{const r=n.uri.toString(),i=this.registeredFeatures.get(r);i!==void 0&&(this.registeredFeatures.delete(n.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(r)})),f.Disposable.from(...t)}registerProviders(t,e,n){if(this.workspaceSnapshot===void 0)return;const r=this.workspaceSnapshot,i=t.languageId,a=[{scheme:this.repository.uri.scheme,pattern:t.uri.fsPath,language:t.languageId,exclusive:!0}],s=[],c=new Promise((v,m)=>{const C=`/${r.snapshotId}/source/`;this.metadata.then(w=>{v(Km(_=>{const E=f.Uri.parse(_);if(w===void 0)return E;try{if(E.scheme==="vsck"&&E.authority===r.workspaceId&&E.path.startsWith(C))return this.repository.createRelativeUri(E.path.substr(C.length));const x=xa.toVSCode(_);return x!==void 0?(this.knownDesignTimeFiles.add(x.toString()),x):E}catch(x){return E}}))},m)}),l=new RegExp(`^vsck:\\/\\/${r.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function d(v){const m=l.exec(v);return m===null||m.length===2}u(d,"designTimeFilter");function h(v){if(v==null)return v;if(Array.isArray(v)){if(v.length===0)return[];const m=v[0];return typeof m.uri=="string"?v.filter(_=>d(_.uri)):typeof m.targetUri=="string"?v.filter(_=>d(_.targetUri)):[]}return l.exec(v.uri)===null?v:void 0}u(h,"filterDesignTimeFiles");async function g(v,m,C){var w,_,E;if(C==null||v===void 0)return C;const x=new Map(f.workspace.textDocuments.map(W=>[W.uri.toString(!0),W]));if(Array.isArray(C)){const W=[],F=[];if(C.length===0)return[];for(const G of C){const Z=G;if(Z.uri instanceof f.Uri){const ee=await v.mapRangeFromIndexToCode((w=x.get(Z.uri.toString()))!=null?w:Z.uri,Z.range);ee!==void 0&&W.push(new f.Location(Z.uri,ee))}else{const ee=G,Q=(_=x.get(ee.targetUri.toString()))!=null?_:ee.targetUri,se=ee.originSelectionRange?await v.mapRangeFromIndexToCode(m,ee.originSelectionRange):void 0;if(se!==void 0||ee.originSelectionRange===void 0){const R=await v.mapRangeFromIndexToCode(Q,ee.targetRange);if(R!==void 0){const O=ee.targetSelectionRange?await v.mapRangeFromIndexToCode(Q,ee.targetSelectionRange):void 0;(O!==void 0||ee.targetSelectionRange===void 0)&&F.push({targetUri:ee.targetUri,targetRange:R,targetSelectionRange:O,originSelectionRange:se})}}}}return W.length>0?W:F}const T=await v.mapRangeFromIndexToCode((E=x.get(C.uri.toString()))!=null?E:C.uri,C.range);if(T!==void 0)return new f.Location(C.uri,T)}u(g,"mapLocations");const p=u(v=>({authentication:this.providerService.getAuthentication(v.uri),correlationId:Af()}),"getRestApiOptions"),y=u((v,m)=>{const C={method:v,correlationId:m.correlationId};this.telemetryService.publicLog2("codex.restAPICall",C)},"sendTelemetry");Ln.registerCapability(i,"hoverProvider",e)&&s.push(f.languages.registerHoverProvider(a,{provideHover:async(v,m)=>{const C=await this.createTextDocumentPositionParams(v,m);if(C===void 0)return;const w=p(v);return y("codex.provideHover",w),(await c).asHover(await sn.provideHover(n,C,w))}})),Ln.registerCapability(i,"definitionProvider",e)&&s.push(f.languages.registerDefinitionProvider(a,{provideDefinition:async(v,m)=>{const C=await this.createTextDocumentPositionParams(v,m);if(C===void 0)return;const w=p(v);return y("codex.provideDefinition",w),g(this.mapper,v,(await c).asDefinitionResult(h(await sn.provideDefinition(n,C,w))))}})),Ln.registerCapability(i,"declarationProvider",e)&&s.push(f.languages.registerDeclarationProvider(a,{provideDeclaration:async(v,m)=>{const C=await this.createTextDocumentPositionParams(v,m);if(C===void 0)return;const w=p(v);return y("codex.provideDeclaration",w),g(this.mapper,v,(await c).asDeclarationResult(h(await sn.provideDeclaration(n,C,w))))}})),Ln.registerCapability(i,"typeDefinitionProvider",e)&&s.push(f.languages.registerTypeDefinitionProvider(a,{provideTypeDefinition:async(v,m)=>{const C=await this.createTextDocumentPositionParams(v,m);if(C===void 0)return;const w=p(v);return y("codex.provideTypeDefinition",w),g(this.mapper,v,(await c).asDefinitionResult(h(await sn.provideTypeDefinition(n,C,w))))}})),Ln.registerCapability(i,"referencesProvider",e)&&s.push(f.languages.registerReferenceProvider(a,{provideReferences:async(v,m,C)=>{const w=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(v,m):m;if(w===void 0)return;const _={position:{line:w.line,character:w.character},textDocument:{uri:this.createRichNavDocumentUri(v.uri).toString(!0)},context:{includeDeclaration:C.includeDeclaration}},E=p(v);return y("codex.provideReferences",E),g(this.mapper,v,(await c).asReferences(h(await sn.provideReferences(n,_,E))))}})),Ln.registerCapability(i,"foldingRangeProvider",e)&&s.push(f.languages.registerFoldingRangeProvider(a,{provideFoldingRanges:async v=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(v))return;const m=p(v);return y("codex.provideFoldingRanges",m),(await c).asFoldingRanges(await sn.providerFoldingRanges(n,this.createTextDocumentParams(v.uri),m))}})),Ln.registerCapability(i,"workspaceSymbolProvider",e)&&s.push(f.languages.registerWorkspaceSymbolProvider({provideWorkspaceSymbols:async v=>{const m=p(t),C=await sn.provideWorkspaceSymbols(n,v,m);if(C!==void 0)return(await c).asSymbolInformations(C)}})),this.registeredFeatures.set(t.uri.toString(),f.Disposable.from(...s)),Ii.updateStatusBarItem()}async capabilities(t){var e;const n=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(n!==void 0)return(e=await sn.capabilities(n,this.createTextDocumentParams(t),{authentication:this.providerService.getAuthentication(t)}))!=null?e:void 0}createTextDocumentParams(t){return{textDocument:{uri:this.createRichNavDocumentUri(t).toString(!0)}}}async createTextDocumentPositionParams(t,e){const n=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(t,e):e;if(n!==void 0)return{position:{line:n.line,character:n.character},textDocument:{uri:this.createRichNavDocumentUri(t.uri).toString(!0)}}}createRichNavDocumentUri(t){if(t.scheme===xr.scheme){const r=xa.toRichNavComponents(t);return r===void 0?t:f.Uri.file(r.assetId)}const e=this.repository.uri.toString(!0),n=t.toString(!0);return f.Uri.file(n.substr(e.length))}},"_RichNavService");let Tu=Ln;Tu.localCapabilities=new Map([["javascript",Object.assign(Zn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(Zn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(Zn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(Zn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),Tu.disabledCapabilities=new Map([["javascript",Object.assign(Zn.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(Zn.create(),{declarationProvider:!0})],["typescript",Object.assign(Zn.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(Zn.create(),{declarationProvider:!0})]]);var Dg=u((t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},"__accessCheck"),Zr=u((t,e,n)=>(Dg(t,e,"read from private field"),n?n.call(t):e.get(t)),"__privateGet"),Qm=u((t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},"__privateAdd"),Xm=u((t,e,n,r)=>(Dg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),"__privateSet"),Un;class Tg{constructor(e){Qm(this,Un,void 0),Xm(this,Un,e)}async getMetadata(e){const n=Zr(this,Un).getVirtualUriMetadata(e);if(n===void 0)return;const{provider:r,repo:i}=n;return{provider:{id:r.id,name:r.name},repo:i,getRevision:async()=>{const{HEAD:o}=await Zr(this,Un).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return Zr(this,Un).getRegisteredProvider(e)}getProviderUri(e){return ce.getProviderUri(e)}getProviderRootUri(e){return Zr(this,Un).getProviderRootUri(e)}isProviderUri(e,n){return e.scheme!==Wt.scheme&&Zr(this,Un).hasProvider(e,n)}getVirtualUri(e){return ce.getVirtualUri(e)}getVirtualWorkspaceUri(e){return Zr(this,Un).getVirtualWorkspaceUri(e)}async loadWorkspaceContents(e){if(e.scheme!==ce.scheme)return!1;const n=Zr(this,Un).getProviderRootUri(e);return n.scheme!=="github"?!1:Zr(this,Un).loadWorkspaceContents(n)}}u(Tg,"ExtensionApi"),Un=new WeakMap;var Jm=Object.defineProperty,Ym=Object.getOwnPropertyDescriptor,Au=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Ym(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Jm(e,n,i),i},"fs_decorateClass");const Pu=f.FileSystemError.FileNotFound().code;class Ia{constructor(e){this.providerService=e,this._onDidChangeFile=new f.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=f.Disposable.from(f.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),f.workspace.registerFileSearchProvider(this.scheme,this),f.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n)),e.onDidChangeChangeStore(n=>{const r=n.map(i=>{switch(i.type){case D.Created:return{type:f.FileChangeType.Created,uri:i.uri};case D.Changed:return{type:f.FileChangeType.Changed,uri:i.uri};case D.Deleted:return{type:f.FileChangeType.Deleted,uri:i.uri}}});setTimeout(()=>this._onDidChangeFile.fire(r),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return Wt.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(n=>n.scheme===this.scheme),e.length!==0&&(U.log(`fs.onRefreshOrRepositoryChanged(${e.map(n=>n.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const n=ce.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>Tr(o,a))&&(this.implicitlyWatchedUris.delete(i),n.set(i,o));U.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${n.size}`);for(const i of e)n.set(N(i),i);const r=[...n.values()].map(i=>({type:f.FileChangeType.Changed,uri:i}));setTimeout(()=>{U.debug(`fs.updateOpenOrWatchedUris: Firing events=${r.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(r)},0)}watch(e,n){const r=N(e);this.watchedUris.set(r,e);const i=Qt(this.providerService,e).then(()=>this.providerService.watch(ce.getProviderUri(e),n));return{dispose:async()=>{this.watchedUris.delete(r),(await i).dispose()}}}async stat(e){const n=new Pe(`fs.stat(${e.toString()})`);await Qt(this.providerService,e);let r;try{if(this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(n.logStep("ChangeStore query"),r=await this.providerService.changeStoreStat(e),r!==void 0)return r;n.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else n.logStep("Provider query"),this.implicitlyWatchedUris.set(N(e),e);return r=await this.providerService.stat(ce.getProviderUri(e)),r}finally{r===void 0&&this.implicitlyWatchedUris.delete(N(e)),n.stop()}}async readDirectory(e){const n=new Pe(`fs.readDirectory(${e.toString()})`);await Qt(this.providerService,e),this.implicitlyWatchedUris.set(N(e),e);try{n.logStep("Provider query");let r=await this.providerService.readDirectory(ce.getProviderUri(e));return this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(n.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),r=await this.providerService.changeStoreUpdateDirectoryEntries(e,r)),r}finally{n.stop()}}async createDirectory(e){const n=new Pe(`fs.createDirectory(${e.toString()})`);await Qt(this.providerService,e);try{await this.providerService.changeStoreCreateDirectory(e)}catch(r){throw U.error(r,n.context),r}finally{n.stop()}}async readFile(e){const n=new Pe(`fs.readFile(${e.toString()})`),r=N(e);let i;await Qt(this.providerService,e);try{if(this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){n.logStep("ChangeStore query");const o=await this.providerService.changeStoreReadFile(e);if(o!==void 0)return o;n.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else n.logStep("Provider query"),this.implicitlyWatchedUris.set(r,e);return i=await this.providerService.readFile(ce.getProviderUri(e)),i}catch(o){throw o instanceof Ht&&du.showProviderNotFoundMessage(o),o}finally{i===void 0&&this.implicitlyWatchedUris.delete(r),n.stop()}}async writeFile(e,n,r){const i=new Pe(`fs.writeFile(${e.toString()})`,{},n.length,r);await Qt(this.providerService,e);try{let o;try{if(o=await this.stat(e),!r.overwrite)throw f.FileSystemError.FileExists()}catch(a){if(a instanceof f.FileSystemError&&a.code===Pu){if(!r.create)throw f.FileSystemError.FileNotFound(e)}else throw a}try{if(o===void 0)await this.providerService.changeStoreCreateFile(e,n);else{i.logStep("Provider original query");let a;try{a=await this.providerService.readFile(ce.getProviderUri(e))}catch(s){if(s instanceof f.FileSystemError&&s.code===Pu)a=new Uint8Array;else throw s}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.providerService.changeStoreWriteFile(e,n,a)}}catch(a){throw U.error(a,i.context),a}}catch(o){throw o instanceof Ht&&du.showProviderNotFoundMessage(o),o}finally{i.stop()}}async delete(e,n){const r=new Pe(`fs.delete(${e.toString()})`,{},n);await Qt(this.providerService,e);try{switch((await this.stat(e)).type){case f.FileType.File:await this.providerService.changeStoreDeleteFile(e);break;case f.FileType.Directory:{await this.deleteDirectory(e,n);break}default:throw f.FileSystemError.NoPermissions()}}catch(i){throw U.error(i,r.context),i}finally{r.stop()}}async deleteDirectory(e,n){const r=new Pe(`fs.deleteDirectory(${e.toString()})`,{},n);try{const i=await this.readDirectory(e);if(i.length!==0){if(!n.recursive&&i.some(([,o])=>o===f.FileType.Directory))throw f.FileSystemError.NoPermissions();for(const[o,a]of i)a===f.FileType.Directory?await this.deleteDirectory(f.Uri.joinPath(e,o),n):await this.providerService.changeStoreDeleteFile(f.Uri.joinPath(e,o))}await this.providerService.changeStoreDeleteDirectory(e)}catch(i){throw U.error(i,r.context),i}finally{r.stop()}}async rename(e,n,r){const i=new Pe(`fs.rename(${e.toString()} -> ${n.toString()})`,{},r);await Qt(this.providerService,e);try{switch((await this.stat(e)).type){case f.FileType.File:{const a=await this.readFile(e);await this.writeFile(n,a,{create:!0,overwrite:r.overwrite}),await this.delete(e,{recursive:!1});break}case f.FileType.Directory:{await this.renameDirectory(e,n,r);break}default:throw f.FileSystemError.NoPermissions()}}catch(o){throw U.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,n,r){const i=new Pe(`fs.renameDirectory(${e.toString()} -> ${n.toString()})`,{},r);try{await this.copyDirectory(e,n,r),await this.delete(e,{recursive:!0})}catch(o){throw U.error(o,i.context),o}finally{i.stop()}}async copy(e,n,r){const i=new Pe(`fs.copy(${e.toString()} -> ${n.toString()})`,{},r);try{switch((await this.stat(e)).type){case f.FileType.File:{const a=await this.readFile(e);await this.writeFile(n,a,{create:!0,overwrite:r.overwrite});break}case f.FileType.Directory:{await this.copyDirectory(e,n,r);break}default:throw f.FileSystemError.NoPermissions()}}catch(o){throw U.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,n,r){const i=new Pe(`fs.copyDirectory(${e.toString()} -> ${n.toString()})`,{},r);try{if(await this.exists(n))throw f.FileSystemError.FileExists();try{await this.createDirectory(n);const o=await this.readDirectory(e);for(const[a,s]of o)s===f.FileType.Directory?await this.copyDirectory(f.Uri.joinPath(e,a),f.Uri.joinPath(n,a),r):await this.copy(f.Uri.joinPath(e,a),f.Uri.joinPath(n,a),r)}catch(o){throw U.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(n){if(n instanceof f.FileSystemError&&n.code===Pu)return!1;throw n}}async provideFileSearchResults(e,n,r){var i;const o=new Pe(`fs.provideFileSearchResults(${e.pattern}, ${n.folder.toString()})`,{logLevel:it.Debug});await Qt(this.providerService,n.folder);let a;try{return a=await this.providerService.provideFileSearchResults(e,{...n,folder:ce.getProviderUri(n.folder)},r),a==null?void 0:a.map(s=>ce.getVirtualUri(s))}catch(s){throw U.error(s,o.context),s}finally{o.stop({suffix:` \u2022 ${(i=a==null?void 0:a.length)!=null?i:0} results found`})}}async provideTextSearchResults(e,n,r,i){return await Qt(this.providerService,n.folder),this.providerService.provideTextSearchResults(e,{...n,folder:ce.getProviderUri(n.folder)},{report:o=>r.report({...o,uri:ce.getVirtualUri(o.uri)})},i)}}u(Ia,"ChangeTrackingFileSystem"),Au([Vs()],Ia.prototype,"stat",1),Au([Vs()],Ia.prototype,"readDirectory",1),Au([Vs()],Ia.prototype,"readFile",1);const Ei=J.loadMessageBundle(),Ag=u(class{constructor(t){this.providerService=t,this.lock=new va("PendingRepositoryOpenActions"),this.disposable=f.Disposable.from(t.onDidChangeRepositories(e=>e.added.length&&this.onRepositoriesOpened(e.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(t){for(const e of t){const n=await this.getAndDelete(e);(n==null?void 0:n.applyChangeset)&&await this.applyPendingChangeset(e,n.applyChangeset),(n==null?void 0:n.filesToOpen)&&this.openPendingFiles(e.uri,n.filesToOpen),this.fetchOrSync(e).then(async()=>{const r=de.get("uncommittedChangesOnEntry");if(r==="none"||!await this.providerService.changeStoreHasChanges(e.uri)||(await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e.uri))).length===0&&r==="promptIfBehind")return;const{state:a}=await this.providerService.getMetadata(e.uri);if(a===void 0||a.behind<1)return;const s=await this.providerService.changeStoreGetChanges(e.uri),c=s.length===1?Ei("prompt uncommitted changes file","You have {0} file with uncommitted changes from a previous edit session.",s.length.toString()):Ei("prompt uncommitted changes files","You have {0} files with uncommitted changes from a previous edit session.",s.length.toString());let l="";a.behind===1?l=Ei("prompt incoming changes commit",`Your repository contents may be out of date until you sync.

You are {0} commit behind.`,a.behind.toString()):a.behind>1&&(l=Ei("prompt incoming changes commits",`Your repository contents may be out of date until you sync.

You are {0} commits behind.`,a.behind.toString()));const d=[c,l].join(`

`),h={title:Ei("sync uncommitted changes","Sync")},g={title:Ei("continue uncommitted changes","Continue Without Syncing"),isCloseAffordance:!0},p={title:Ei("don't show again","Don't Show Again")},y=await f.window.showInformationMessage(d,{modal:!0},h,g,p);switch(y==null?void 0:y.title){case h.title:await f.commands.executeCommand("remoteHub.sync");break;case p.title:await de.updateEffective("uncommittedChangesOnEntry","none");break;default:break}})}}async fetchOrSync(t){await this.providerService.fetchOrSync(t.uri)}async get(t){return this.lock.synchronizeRead(()=>this.getCore(t.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(t){U.debug(`RepositoryOpenActionsService.getAndDelete(${t.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const n=await this.getCore(t.uri);if(n!==void 0)return await this.storeCore(t.uri,void 0),n},"PendingRepositoryOpenActions.getAndDelete")}catch(e){U.error(e,`Failed to get pending actions for ${t.uri.toString()}`);return}}async openPendingFiles(t,e){if(e.length!==0){U.log(`RepositoryOpenActionsService.openPendingFiles(${t.toString()})`,e.join(","));for(let n of e){const r=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(n);let i,o;(r==null?void 0:r.groups)!==void 0&&(i=Number(r.groups.start),isNaN(i)&&(i=void 0),o=Number(r.groups.end),isNaN(o)&&(o=void 0),n=n.substring(0,r.index));const a=f.Uri.joinPath(t,n);let s;try{s=await f.workspace.fs.stat(a)}catch{}if((s==null?void 0:s.type)===f.FileType.Directory)f.commands.executeCommand("revealInExplorer",a);else{let c;i!==void 0&&(c={selection:new f.Range(Number(i)-1,0,o!=null?o:i,0)}),f.commands.executeCommand("vscode.open",a,c)}}}}setChangesetToApply(t,e){return U.log(`RepositoryOpenActionsService.setChangesetToApply(${t.toString()})`),this.lock.synchronizeWrite(async()=>{const n=await this.getCore(t);await this.storeCore(t,{...n,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(t,e){return U.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${t.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const n=await this.getCore(t);await this.storeCore(t,{...n,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(t,e){U.log(`RepositoryOpenActionsService.applyPendingChangeset(${t.uri.toString()})`);const n=de.get("experimental.useSimplifiedMerge");try{await this.providerService.changeStoreApplyChangeset(t.uri,e,{save:!0,useSimplifiedMerge:n})}catch(r){U.error(r,`Failed to apply pending changeset for ${t.uri.toString()}`)}}async getCore(t){return this.fromStorage(await this.providerService.getFromStorage(t,this.getStorageKey(t)))}storeCore(t,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.providerService.deleteFromStorage(t,this.getStorageKey(t)):this.providerService.storeInStorage(t,this.getStorageKey(t),this.toStorage(e))}getStorageKey(t){return`actions/${N(t)}`}fromStorage(t){if(!!t)try{const e=JSON.parse(t,(n,r)=>(n==="uri"||n.endsWith("Uri"))&&Ar(r)?f.Uri.from(r):r);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return U.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(t){const e={schemaVersion:Ag.storageSchemaVersion,...t};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let Pg=Ag;Pg.storageSchemaVersion=1;function Ir(){}u(Ir,"Diff"),Ir.prototype={diff:u(function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=r.callback;typeof r=="function"&&(i=r,r={}),this.options=r;var o=this;function a(v){return i?(setTimeout(function(){i(void 0,v)},0),!0):v}u(a,"done"),e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e)),n=this.removeEmpty(this.tokenize(n));var s=n.length,c=e.length,l=1,d=s+c,h=[{newPos:-1,components:[]}],g=this.extractCommon(h[0],n,e,0);if(h[0].newPos+1>=s&&g+1>=c)return a([{value:this.join(n),count:n.length}]);function p(){for(var v=-1*l;v<=l;v+=2){var m=void 0,C=h[v-1],w=h[v+1],_=(w?w.newPos:0)-v;C&&(h[v-1]=void 0);var E=C&&C.newPos+1<s,x=w&&0<=_&&_<c;if(!E&&!x){h[v]=void 0;continue}if(!E||x&&C.newPos<w.newPos?(m=ew(w),o.pushComponent(m.components,void 0,!0)):(m=C,m.newPos++,o.pushComponent(m.components,!0,void 0)),_=o.extractCommon(m,n,e,v),m.newPos+1>=s&&_+1>=c)return a(Zm(o,m.components,n,e,o.useLongestToken));h[v]=m}l++}if(u(p,"execEditLength"),i)u(function v(){setTimeout(function(){if(l>d)return i();p()||v()},0)},"exec")();else for(;l<=d;){var y=p();if(y)return y}},"diff"),pushComponent:u(function(e,n,r){var i=e[e.length-1];i&&i.added===n&&i.removed===r?e[e.length-1]={count:i.count+1,added:n,removed:r}:e.push({count:1,added:n,removed:r})},"pushComponent"),extractCommon:u(function(e,n,r,i){for(var o=n.length,a=r.length,s=e.newPos,c=s-i,l=0;s+1<o&&c+1<a&&this.equals(n[s+1],r[c+1]);)s++,c++,l++;return l&&e.components.push({count:l}),e.newPos=s,c},"extractCommon"),equals:u(function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},"equals"),removeEmpty:u(function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},"removeEmpty"),castInput:u(function(e){return e},"castInput"),tokenize:u(function(e){return e.split("")},"tokenize"),join:u(function(e){return e.join("")},"join")};function Zm(t,e,n,r,i){for(var o=0,a=e.length,s=0,c=0;o<a;o++){var l=e[o];if(l.removed){if(l.value=t.join(r.slice(c,c+l.count)),c+=l.count,o&&e[o-1].added){var h=e[o-1];e[o-1]=e[o],e[o]=h}}else{if(!l.added&&i){var d=n.slice(s,s+l.count);d=d.map(function(p,y){var v=r[c+y];return v.length>p.length?v:p}),l.value=t.join(d)}else l.value=t.join(n.slice(s,s+l.count));s+=l.count,l.added||(c+=l.count)}}var g=e[a-1];return a>1&&typeof g.value=="string"&&(g.added||g.removed)&&t.equals("",g.value)&&(e[a-2].value+=g.value,e.pop()),e}u(Zm,"buildValues");function ew(t){return{newPos:t.newPos,components:t.components.slice(0)}}u(ew,"clonePath");var tw=new Ir;function c0(t,e,n){return tw.diff(t,e,n)}u(c0,"diffChars");function Fg(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}u(Fg,"generateOptions");var Mg=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Ng=/\S/,ec=new Ir;ec.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Ng.test(t)&&!Ng.test(e)},ec.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<e.length-1;n++)!e[n+1]&&e[n+2]&&Mg.test(e[n])&&Mg.test(e[n+2])&&(e[n]+=e[n+2],e.splice(n+1,2),n--);return e};function l0(t,e,n){return n=Fg(n,{ignoreWhitespace:!0}),ec.diff(t,e,n)}u(l0,"diffWords");function u0(t,e,n){return ec.diff(t,e,n)}u(u0,"diffWordsWithSpace");var tc=new Ir;tc.tokenize=function(t){var e=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var i=n[r];r%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function nw(t,e,n){return tc.diff(t,e,n)}u(nw,"diffLines");function d0(t,e,n){var r=Fg(n,{ignoreWhitespace:!0});return tc.diff(t,e,r)}u(d0,"diffTrimmedLines");var Lg=new Ir;Lg.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};function h0(t,e,n){return Lg.diff(t,e,n)}u(h0,"diffSentences");var Ug=new Ir;Ug.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function f0(t,e,n){return Ug.diff(t,e,n)}u(f0,"diffCss");function nc(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nc=u(function(e){return typeof e},"_typeof"):nc=u(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),nc(t)}u(nc,"_typeof");function Er(t){return rw(t)||iw(t)||ow(t)||aw()}u(Er,"_toConsumableArray");function rw(t){if(Array.isArray(t))return Fu(t)}u(rw,"_arrayWithoutHoles");function iw(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}u(iw,"_iterableToArray");function ow(t,e){if(!!t){if(typeof t=="string")return Fu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fu(t,e)}}u(ow,"_unsupportedIterableToArray");function Fu(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}u(Fu,"_arrayLikeToArray");function aw(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}u(aw,"_nonIterableSpread");var sw=Object.prototype.toString,Ao=new Ir;Ao.useLongestToken=!0,Ao.tokenize=tc.tokenize,Ao.castInput=function(t){var e=this.options,n=e.undefinedReplacement,r=e.stringifyReplacer,i=r===void 0?function(o,a){return typeof a=="undefined"?n:a}:r;return typeof t=="string"?t:JSON.stringify(Mu(t,null,null,i),i,"  ")},Ao.equals=function(t,e){return Ir.prototype.equals.call(Ao,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function g0(t,e,n){return Ao.diff(t,e,n)}u(g0,"diffJson");function Mu(t,e,n,r,i){e=e||[],n=n||[],r&&(t=r(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return n[o];var a;if(sw.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),n.push(a),o=0;o<t.length;o+=1)a[o]=Mu(t[o],e,n,r,i);return e.pop(),n.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),nc(t)==="object"&&t!==null){e.push(t),a={},n.push(a);var s=[],c;for(c in t)t.hasOwnProperty(c)&&s.push(c);for(s.sort(),o=0;o<s.length;o+=1)c=s[o],a[c]=Mu(t[c],e,n,r,c);e.pop(),n.pop()}else a=t;return a}u(Mu,"canonicalize");var rc=new Ir;rc.tokenize=function(t){return t.slice()},rc.join=rc.removeEmpty=function(t){return t};function p0(t,e,n){return rc.diff(t,e,n)}u(p0,"diffArrays");function Ea(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.split(/\r\n|[\n\v\f\r\x85]/),r=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var l={};for(i.push(l);o<n.length;){var d=n[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(d))break;var h=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(d);h&&(l.index=h[1]),o++}for(s(l),s(l),l.hunks=[];o<n.length;){var g=n[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(g))break;if(/^@@/.test(g))l.hunks.push(c());else{if(g&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(g));o++}}}u(a,"parseIndex");function s(l){var d=/^(---|\+\+\+)\s+(.*)$/.exec(n[o]);if(d){var h=d[1]==="---"?"old":"new",g=d[2].split("	",2),p=g[0].replace(/\\\\/g,"\\");/^".*"$/.test(p)&&(p=p.substr(1,p.length-2)),l[h+"FileName"]=p,l[h+"Header"]=(g[1]||"").trim(),o++}}u(s,"parseFileHeader");function c(){var l=o,d=n[o++],h=d.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),g={oldStart:+h[1],oldLines:typeof h[2]=="undefined"?1:+h[2],newStart:+h[3],newLines:typeof h[4]=="undefined"?1:+h[4],lines:[],linedelimiters:[]};g.oldLines===0&&(g.oldStart+=1),g.newLines===0&&(g.newStart+=1);for(var p=0,y=0;o<n.length&&!(n[o].indexOf("--- ")===0&&o+2<n.length&&n[o+1].indexOf("+++ ")===0&&n[o+2].indexOf("@@")===0);o++){var v=n[o].length==0&&o!=n.length-1?" ":n[o][0];if(v==="+"||v==="-"||v===" "||v==="\\")g.lines.push(n[o]),g.linedelimiters.push(r[o]||`
`),v==="+"?p++:v==="-"?y++:v===" "&&(p++,y++);else break}if(!p&&g.newLines===1&&(g.newLines=0),!y&&g.oldLines===1&&(g.oldLines=0),e.strict){if(p!==g.newLines)throw new Error("Added line count did not match for hunk at line "+(l+1));if(y!==g.oldLines)throw new Error("Removed line count did not match for hunk at line "+(l+1))}return g}for(u(c,"parseHunk");o<n.length;)a();return i}u(Ea,"parsePatch");function cw(t,e,n){var r=!0,i=!1,o=!1,a=1;return u(function s(){if(r&&!o){if(i?a++:r=!1,t+a<=n)return a;o=!0}if(!i)return o||(r=!0),e<=t-a?-a++:(i=!0,s())},"iterator")}u(cw,"distanceIterator");function Og(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=Ea(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var r=t.split(/\r\n|[\n\v\f\r\x85]/),i=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,a=n.compareLine||function(O,j,z,te){return j===te},s=0,c=n.fuzzFactor||0,l=0,d=0,h,g;function p(O,j){for(var z=0;z<O.lines.length;z++){var te=O.lines[z],oe=te.length>0?te[0]:" ",fe=te.length>0?te.substr(1):te;if(oe===" "||oe==="-"){if(!a(j+1,r[j],oe,fe)&&(s++,s>c))return!1;j++}}return!0}u(p,"hunkFits");for(var y=0;y<o.length;y++){for(var v=o[y],m=r.length-v.oldLines,C=0,w=d+v.oldStart-1,_=cw(w,l,m);C!==void 0;C=_())if(p(v,w+C)){v.offset=d+=C;break}if(C===void 0)return!1;l=v.offset+v.oldStart+v.oldLines}for(var E=0,x=0;x<o.length;x++){var T=o[x],W=T.oldStart+T.offset+E-1;E+=T.newLines-T.oldLines;for(var F=0;F<T.lines.length;F++){var G=T.lines[F],Z=G.length>0?G[0]:" ",ee=G.length>0?G.substr(1):G,Q=T.linedelimiters[F];if(Z===" ")W++;else if(Z==="-")r.splice(W,1),i.splice(W,1);else if(Z==="+")r.splice(W,0,ee),i.splice(W,0,Q),W++;else if(Z==="\\"){var se=T.lines[F-1]?T.lines[F-1][0]:null;se==="+"?h=!0:se==="-"&&(g=!0)}}}if(h)for(;!r[r.length-1];)r.pop(),i.pop();else g&&(r.push(""),i.push(`
`));for(var R=0;R<r.length-1;R++)r[R]=r[R]+i[R];return r.join("")}u(Og,"applyPatch");function v0(t,e){typeof t=="string"&&(t=Ea(t));var n=0;function r(){var i=t[n++];if(!i)return e.complete();e.loadFile(i,function(o,a){if(o)return e.complete(o);var s=Og(a,i,e);e.patched(i,s,function(c){if(c)return e.complete(c);r()})})}u(r,"processIndex"),r()}u(v0,"applyPatches");function Hg(t,e,n,r,i,o,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var s=nw(n,r,a);s.push({value:"",lines:[]});function c(C){return C.map(function(w){return" "+w})}u(c,"contextLines");for(var l=[],d=0,h=0,g=[],p=1,y=1,v=u(function(w){var _=s[w],E=_.lines||_.value.replace(/\n$/,"").split(`
`);if(_.lines=E,_.added||_.removed){var x;if(!d){var T=s[w-1];d=p,h=y,T&&(g=a.context>0?c(T.lines.slice(-a.context)):[],d-=g.length,h-=g.length)}(x=g).push.apply(x,Er(E.map(function(R){return(_.added?"+":"-")+R}))),_.added?y+=E.length:p+=E.length}else{if(d)if(E.length<=a.context*2&&w<s.length-2){var W;(W=g).push.apply(W,Er(c(E)))}else{var F,G=Math.min(E.length,a.context);(F=g).push.apply(F,Er(c(E.slice(0,G))));var Z={oldStart:d,oldLines:p-d+G,newStart:h,newLines:y-h+G,lines:g};if(w>=s.length-2&&E.length<=a.context){var ee=/\n$/.test(n),Q=/\n$/.test(r),se=E.length==0&&g.length>Z.oldLines;!ee&&se&&n.length>0&&g.splice(Z.oldLines,0,"\\ No newline at end of file"),(!ee&&!se||!Q)&&g.push("\\ No newline at end of file")}l.push(Z),d=0,h=0,g=[]}p+=E.length,y+=E.length}},"_loop"),m=0;m<s.length;m++)v(m);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:l}}u(Hg,"structuredPatch");function lw(t){var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader=="undefined"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader=="undefined"?"":"	"+t.newHeader));for(var n=0;n<t.hunks.length;n++){var r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@"),e.push.apply(e,r.lines)}return e.join(`
`)+`
`}u(lw,"formatPatch");function uw(t,e,n,r,i,o,a){return lw(Hg(t,e,n,r,i,o,a))}u(uw,"createTwoFilesPatch");function dw(t,e,n,r,i,o){return uw(t,t,e,n,r,i,o)}u(dw,"createPatch");function hw(t,e){return t.length!==e.length?!1:Nu(t,e)}u(hw,"arrayEqual");function Nu(t,e){if(e.length>t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}u(Nu,"arrayStartsWith");function fw(t){var e=Uu(t.lines),n=e.oldLines,r=e.newLines;n!==void 0?t.oldLines=n:delete t.oldLines,r!==void 0?t.newLines=r:delete t.newLines}u(fw,"calcLineCount");function m0(t,e,n){t=Wg(t,n),e=Wg(e,n);var r={};(t.index||e.index)&&(r.index=t.index||e.index),(t.newFileName||e.newFileName)&&(Bg(t)?Bg(e)?(r.oldFileName=ic(r,t.oldFileName,e.oldFileName),r.newFileName=ic(r,t.newFileName,e.newFileName),r.oldHeader=ic(r,t.oldHeader,e.oldHeader),r.newHeader=ic(r,t.newHeader,e.newHeader)):(r.oldFileName=t.oldFileName,r.newFileName=t.newFileName,r.oldHeader=t.oldHeader,r.newHeader=t.newHeader):(r.oldFileName=e.oldFileName||t.oldFileName,r.newFileName=e.newFileName||t.newFileName,r.oldHeader=e.oldHeader||t.oldHeader,r.newHeader=e.newHeader||t.newHeader)),r.hunks=[];for(var i=0,o=0,a=0,s=0;i<t.hunks.length||o<e.hunks.length;){var c=t.hunks[i]||{oldStart:1/0},l=e.hunks[o]||{oldStart:1/0};if($g(c,l))r.hunks.push(Vg(c,a)),i++,s+=c.newLines-c.oldLines;else if($g(l,c))r.hunks.push(Vg(l,s)),o++,a+=l.newLines-l.oldLines;else{var d={oldStart:Math.min(c.oldStart,l.oldStart),oldLines:0,newStart:Math.min(c.newStart+a,l.oldStart+s),newLines:0,lines:[]};gw(d,c.oldStart,c.lines,l.oldStart,l.lines),o++,i++,r.hunks.push(d)}}return r}u(m0,"merge");function Wg(t,e){if(typeof t=="string"){if(/^@@/m.test(t)||/^Index:/m.test(t))return Ea(t)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return Hg(void 0,void 0,e,t)}return t}u(Wg,"loadPatch");function Bg(t){return t.newFileName&&t.newFileName!==t.oldFileName}u(Bg,"fileNameChanged");function ic(t,e,n){return e===n?e:(t.conflict=!0,{mine:e,theirs:n})}u(ic,"selectField");function $g(t,e){return t.oldStart<e.oldStart&&t.oldStart+t.oldLines<e.oldStart}u($g,"hunkBefore");function Vg(t,e){return{oldStart:t.oldStart,oldLines:t.oldLines,newStart:t.newStart+e,newLines:t.newLines,lines:t.lines}}u(Vg,"cloneHunk");function gw(t,e,n,r,i){var o={offset:e,lines:n,index:0},a={offset:r,lines:i,index:0};for(zg(t,o,a),zg(t,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var s=o.lines[o.index],c=a.lines[a.index];if((s[0]==="-"||s[0]==="+")&&(c[0]==="-"||c[0]==="+"))pw(t,o,a);else if(s[0]==="+"&&c[0]===" "){var l;(l=t.lines).push.apply(l,Er(ki(o)))}else if(c[0]==="+"&&s[0]===" "){var d;(d=t.lines).push.apply(d,Er(ki(a)))}else s[0]==="-"&&c[0]===" "?qg(t,o,a):c[0]==="-"&&s[0]===" "?qg(t,a,o,!0):s===c?(t.lines.push(s),o.index++,a.index++):Lu(t,ki(o),ki(a))}jg(t,o),jg(t,a),fw(t)}u(gw,"mergeLines");function pw(t,e,n){var r=ki(e),i=ki(n);if(Gg(r)&&Gg(i)){if(Nu(r,i)&&Kg(n,r,r.length-i.length)){var o;(o=t.lines).push.apply(o,Er(r));return}else if(Nu(i,r)&&Kg(e,i,i.length-r.length)){var a;(a=t.lines).push.apply(a,Er(i));return}}else if(hw(r,i)){var s;(s=t.lines).push.apply(s,Er(r));return}Lu(t,r,i)}u(pw,"mutualChange");function qg(t,e,n,r){var i=ki(e),o=vw(n,i);if(o.merged){var a;(a=t.lines).push.apply(a,Er(o.merged))}else Lu(t,r?o:i,r?i:o)}u(qg,"removal");function Lu(t,e,n){t.conflict=!0,t.lines.push({conflict:!0,mine:e,theirs:n})}u(Lu,"conflict");function zg(t,e,n){for(;e.offset<n.offset&&e.index<e.lines.length;){var r=e.lines[e.index++];t.lines.push(r),e.offset++}}u(zg,"insertLeading");function jg(t,e){for(;e.index<e.lines.length;){var n=e.lines[e.index++];t.lines.push(n)}}u(jg,"insertTrailing");function ki(t){for(var e=[],n=t.lines[t.index][0];t.index<t.lines.length;){var r=t.lines[t.index];if(n==="-"&&r[0]==="+"&&(n="+"),n===r[0])e.push(r),t.index++;else break}return e}u(ki,"collectChange");function vw(t,e){for(var n=[],r=[],i=0,o=!1,a=!1;i<e.length&&t.index<t.lines.length;){var s=t.lines[t.index],c=e[i];if(c[0]==="+")break;if(o=o||s[0]!==" ",r.push(c),i++,s[0]==="+")for(a=!0;s[0]==="+";)n.push(s),s=t.lines[++t.index];c.substr(1)===s.substr(1)?(n.push(s),t.index++):a=!0}if((e[i]||"")[0]==="+"&&o&&(a=!0),a)return n;for(;i<e.length;)r.push(e[i++]);return{merged:r,changes:n}}u(vw,"collectContext");function Gg(t){return t.reduce(function(e,n){return e&&n[0]==="-"},!0)}u(Gg,"allRemoves");function Kg(t,e,n){for(var r=0;r<n;r++){var i=e[e.length-n+r].substr(1);if(t.lines[t.index+r]!==" "+i)return!1}return t.index+=n,!0}u(Kg,"skipRemoveSuperset");function Uu(t){var e=0,n=0;return t.forEach(function(r){if(typeof r!="string"){var i=Uu(r.mine),o=Uu(r.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),n!==void 0&&(i.newLines===o.newLines?n+=i.newLines:n=void 0)}else n!==void 0&&(r[0]==="+"||r[0]===" ")&&n++,e!==void 0&&(r[0]==="-"||r[0]===" ")&&e++}),{oldLines:e,newLines:n}}u(Uu,"calcOldNewLineCount");function w0(t){for(var e=[],n,r,i=0;i<t.length;i++)n=t[i],n.added?r=1:n.removed?r=-1:r=0,e.push([r,n.value]);return e}u(w0,"convertChangesToDMP");function y0(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(mw(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}u(y0,"convertChangesToXML");function mw(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}u(mw,"escapeHTML");var Qg=/[^a-zA-Z0-9]/,Xg=/\s/,Jg=/[\r\n]/,ww=/\n\r?\n$/,yw=/^\r?\n\r?\n/,H;(function(t){t[t.DIFF_DELETE=-1]="DIFF_DELETE",t[t.DIFF_INSERT=1]="DIFF_INSERT",t[t.DIFF_EQUAL=0]="DIFF_EQUAL"})(H||(H={}));function Cw(t,e){return t<e?t:e}u(Cw,"min");function bw(t,e){return t>e?t:e}u(bw,"max");var Kt=Ce,ka=function(){function t(){this.diffs=[],this.start1=0,this.start2=0,this.length1=0,this.length2=0}return u(t,"PatchObject"),t.prototype.toString=function(){var e,n;this.length1===0?e=this.start1+",0":this.length1===1?e=this.start1+1:e=this.start1+1+","+this.length1,this.length2===0?n=this.start2+",0":this.length2===1?n=this.start2+1:n=this.start2+1+","+this.length2;for(var r=["@@ -"+e+" +"+n+` @@
`],i,o=0;o<this.diffs.length;o++){switch(this.diffs[o][0]){case H.DIFF_INSERT:i="+";break;case H.DIFF_DELETE:i="-";break;case H.DIFF_EQUAL:i=" ";break}r[o+1]=i+encodeURI(this.diffs[o][1])+`
`}return r.join("").replace(/%20/g," ")},t}(),Sw=function(){function t(){this.diffTimeout=1,this.diffEditCost=4,this.matchThreshold=.5,this.matchDistance=1e3,this.patchDeleteThreshold=.5,this.patchMargin=4,this.matchMaxBits=32}return u(t,"DiffMatchPatch"),t.prototype.diff_main=function(e,n,r,i){typeof i=="undefined"&&(this.diffTimeout<=0?i=Number.MAX_VALUE:i=Date.now()+this.diffTimeout*1e3);var o=i;if(e==null||n==null)throw new Error("Null input. (diff_main)");if(e===n)return e?[[H.DIFF_EQUAL,e]]:[];typeof r=="undefined"&&(r=!0);var a=r,s=this.diff_commonPrefix(e,n),c=e.substring(0,s);e=e.substring(s),n=n.substring(s),s=this.diff_commonSuffix(e,n);var l=e.substring(e.length-s);e=e.substring(0,e.length-s),n=n.substring(0,n.length-s);var d=this.diff_compute_(e,n,a,o);return c&&d.unshift([H.DIFF_EQUAL,c]),l&&d.push([H.DIFF_EQUAL,l]),this.diff_cleanupMerge(d),d},t.prototype.diff_commonPrefix=function(e,n){if(!e||!n||e.charAt(0)!==n.charAt(0))return 0;for(var r=0,i=Kt.min(e.length,n.length),o=i,a=0;r<o;)e.substring(a,o)===n.substring(a,o)?(r=o,a=r):i=o,o=Math.floor((i-r)/2+r);return o},t.prototype.diff_commonSuffix=function(e,n){if(!e||!n||e.charAt(e.length-1)!==n.charAt(n.length-1))return 0;for(var r=0,i=Kt.min(e.length,n.length),o=i,a=0;r<o;)e.substring(e.length-o,e.length-a)===n.substring(n.length-o,n.length-a)?(r=o,a=r):i=o,o=Math.floor((i-r)/2+r);return o},t.prototype.diff_cleanupSemantic=function(e){for(var n=!1,r=[],i=0,o=null,a=0,s=0,c=0,l=0,d=0;a<e.length;)e[a][0]===H.DIFF_EQUAL?(r[i++]=a,s=l,c=d,l=0,d=0,o=e[a][1]):(e[a][0]===H.DIFF_INSERT?l+=e[a][1].length:d+=e[a][1].length,o&&o.length<=Kt.max(s,c)&&o.length<=Kt.max(l,d)&&(e.splice(r[i-1],0,[H.DIFF_DELETE,o]),e[r[i-1]+1][0]=H.DIFF_INSERT,i--,i--,a=i>0?r[i-1]:-1,s=0,c=0,l=0,d=0,o=null,n=!0)),a++;for(n&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]===H.DIFF_DELETE&&e[a][0]===H.DIFF_INSERT){var h=e[a-1][1],g=e[a][1],p=this.diff_commonOverlap_(h,g),y=this.diff_commonOverlap_(g,h);p>=y?(p>=h.length/2||p>=g.length/2)&&(e.splice(a,0,[H.DIFF_EQUAL,g.substring(0,p)]),e[a-1][1]=h.substring(0,h.length-p),e[a+1][1]=g.substring(p),a++):(y>=h.length/2||y>=g.length/2)&&(e.splice(a,0,[H.DIFF_EQUAL,h.substring(0,y)]),e[a-1][0]=H.DIFF_INSERT,e[a-1][1]=g.substring(0,g.length-y),e[a+1][0]=H.DIFF_DELETE,e[a+1][1]=h.substring(y),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){for(var n=1;n<e.length-1;){if(e[n-1][0]===H.DIFF_EQUAL&&e[n+1][0]===H.DIFF_EQUAL){var r=e[n-1][1],i=e[n][1],o=e[n+1][1],a=this.diff_commonSuffix(r,i);if(a){var s=i.substring(i.length-a);r=r.substring(0,r.length-a),i=s+i.substring(0,i.length-a),o=s+o}for(var c=r,l=i,d=o,h=this.diff_cleanupSemanticScore_(r,i)+this.diff_cleanupSemanticScore_(i,o);i.charAt(0)===o.charAt(0);){r+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);var g=this.diff_cleanupSemanticScore_(r,i)+this.diff_cleanupSemanticScore_(i,o);g>=h&&(h=g,c=r,l=i,d=o)}e[n-1][1]!==c&&(c?e[n-1][1]=c:(e.splice(n-1,1),n--),e[n][1]=l,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}},t.prototype.diff_cleanupEfficiency=function(e){for(var n=!1,r=[],i=0,o=null,a=0,s=!1,c=!1,l=!1,d=!1;a<e.length;)e[a][0]===H.DIFF_EQUAL?(e[a][1].length<this.diffEditCost&&(l||d)?(r[i++]=a,s=l,c=d,o=e[a][1]):(i=0,o=null),l=d=!1):(e[a][0]===H.DIFF_DELETE?d=!0:l=!0,o&&(s&&c&&l&&d||o.length<this.diffEditCost/2&&Number(s)+Number(c)+Number(l)+Number(d)===3)&&(e.splice(r[i-1],0,[H.DIFF_DELETE,o]),e[r[i-1]+1][0]=H.DIFF_INSERT,i--,o=null,s&&c?(l=d=!0,i=0):(i--,a=i>0?r[i-1]:-1,l=d=!1),n=!0)),a++;n&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push([H.DIFF_EQUAL,""]);for(var n=0,r=0,i=0,o="",a="",s;n<e.length;)switch(e[n][0]){case H.DIFF_INSERT:i++,a+=e[n][1],n++;break;case H.DIFF_DELETE:r++,o+=e[n][1],n++;break;case H.DIFF_EQUAL:r+i>1?(r!==0&&i!==0&&(s=this.diff_commonPrefix(a,o),s!==0&&(n-r-i>0&&e[n-r-i-1][0]===H.DIFF_EQUAL?e[n-r-i-1][1]+=a.substring(0,s):(e.splice(0,0,[H.DIFF_EQUAL,a.substring(0,s)]),n++),a=a.substring(s),o=o.substring(s)),s=this.diff_commonSuffix(a,o),s!==0&&(e[n][1]=a.substring(a.length-s)+e[n][1],a=a.substring(0,a.length-s),o=o.substring(0,o.length-s))),n-=r+i,e.splice(n,r+i),o.length&&(e.splice(n,0,[H.DIFF_DELETE,o]),n++),a.length&&(e.splice(n,0,[H.DIFF_INSERT,a]),n++),n++):n!==0&&e[n-1][0]===H.DIFF_EQUAL?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=0,r=0,o="",a="";break}e[e.length-1][1]===""&&e.pop();var c=!1;for(n=1;n<e.length-1;)e[n-1][0]===H.DIFF_EQUAL&&e[n+1][0]===H.DIFF_EQUAL&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)===e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),c=!0):e[n][1].substring(0,e[n+1][1].length)===e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),c=!0)),n++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,n){var r=0,i=0,o=0,a=0,s;for(s=0;s<e.length&&(e[s][0]!==H.DIFF_INSERT&&(r+=e[s][1].length),e[s][0]!==H.DIFF_DELETE&&(i+=e[s][1].length),!(r>n));s++)o=r,a=i;return e.length!==s&&e[s][0]===H.DIFF_DELETE?a:a+(n-o)},t.prototype.diff_prettyHtml=function(e){for(var n=[],r=/&/g,i=/</g,o=/>/g,a=/\n/g,s=0;s<e.length;s++){var c=e[s][0],l=e[s][1],d=l.replace(r,"&amp;").replace(i,"&lt;").replace(o,"&gt;").replace(a,"&para;<br>");switch(c){case H.DIFF_INSERT:n[s]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case H.DIFF_DELETE:n[s]='<del style="background:#ffe6e6;">'+d+"</del>";break;case H.DIFF_EQUAL:n[s]="<span>"+d+"</span>";break}}return n.join("")},t.prototype.diff_text1=function(e){for(var n=[],r=0;r<e.length;r++)e[r][0]!==H.DIFF_INSERT&&(n[r]=e[r][1]);return n.join("")},t.prototype.diff_text2=function(e){for(var n=[],r=0;r<e.length;r++)e[r][0]!==H.DIFF_DELETE&&(n[r]=e[r][1]);return n.join("")},t.prototype.diff_levenshtein=function(e){for(var n=0,r=0,i=0,o=0;o<e.length;o++){var a=e[o][0],s=e[o][1];switch(a){case H.DIFF_INSERT:r+=s.length;break;case H.DIFF_DELETE:i+=s.length;break;case H.DIFF_EQUAL:n+=Kt.max(r,i),r=0,i=0;break}}return n+=Kt.max(r,i),n},t.prototype.diff_toDelta=function(e){for(var n=[],r=0;r<e.length;r++)switch(e[r][0]){case H.DIFF_INSERT:n[r]="+"+encodeURI(e[r][1]);break;case H.DIFF_DELETE:n[r]="-"+e[r][1].length;break;case H.DIFF_EQUAL:n[r]="="+e[r][1].length;break}return n.join("	").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,n){for(var r=[],i=0,o=0,a=n.split(/\t/g),s=0;s<a.length;s++){var c=a[s].substring(1);switch(a[s].charAt(0)){case"+":try{r[i++]=[H.DIFF_INSERT,decodeURI(c)]}catch(h){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var l=parseInt(c,10);if(isNaN(l)||l<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(o,o+=l);a[s].charAt(0)==="="?r[i++]=[H.DIFF_EQUAL,d]:r[i++]=[H.DIFF_DELETE,d];break;default:if(a[s])throw new Error("Invalid diff operation in diff_fromDelta: "+a[s])}}if(o!==e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+")");return r},t.prototype.diff_linesToChars=function(e,n){var r=[],i={};r[0]="";var o=this.diff_linesToCharsMunge_(e,r,i,4e4),a=this.diff_linesToCharsMunge_(n,r,i,65535);return{chars1:o,chars2:a,lineArray:r}},t.prototype.diff_charsToLines=function(e,n){for(var r=0;r<e.length;r++){for(var i=e[r][1],o=[],a=0;a<i.length;a++)o[a]=n[i.charCodeAt(a)];e[r][1]=o.join("")}},t.prototype.match_main=function(e,n,r){if(e==null||n==null||r==null)throw new Error("Null input. (match_main)");return r=Kt.max(0,Kt.min(r,e.length)),e===n?0:e.length?e.substring(r,r+n.length)===n?r:this.match_bitap_(e,n,r):-1},t.prototype.patch_make=function(e,n,r){var i,o;if(typeof e=="string"&&typeof n=="string"&&typeof r=="undefined")i=e,o=this.diff_main(i,n,!0),o.length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&typeof e=="object"&&typeof n=="undefined"&&typeof r=="undefined")o=e,i=this.diff_text1(o);else if(typeof e=="string"&&n&&typeof n=="object"&&typeof r=="undefined")i=e,o=n;else if(typeof e=="string"&&typeof n=="string"&&r&&typeof r=="object")i=e,o=r;else throw new Error("Unknown call format to patch_make");if(o.length===0)return[];for(var a=[],s=new ka,c=0,l=0,d=0,h=i,g=i,p=0;p<o.length;p++){var y=o[p][0],v=o[p][1];switch(!c&&y!==H.DIFF_EQUAL&&(s.start1=l,s.start2=d),y){case H.DIFF_INSERT:s.diffs[c++]=o[p],s.length2+=v.length,g=g.substring(0,d)+v+g.substring(d);break;case H.DIFF_DELETE:s.length1+=v.length,s.diffs[c++]=o[p],g=g.substring(0,d)+g.substring(d+v.length);break;case H.DIFF_EQUAL:v.length<=2*this.patchMargin&&c&&o.length!==p+1?(s.diffs[c++]=o[p],s.length1+=v.length,s.length2+=v.length):v.length>=2*this.patchMargin&&c&&(this.patch_addContext_(s,h),a.push(s),s=new ka,c=0,h=g,l=d);break}y!==H.DIFF_INSERT&&(l+=v.length),y!==H.DIFF_DELETE&&(d+=v.length)}return c&&(this.patch_addContext_(s,h),a.push(s)),a},t.prototype.patch_deepCopy=function(e){for(var n=[],r=0;r<e.length;r++){for(var i=e[r],o=new ka,a=0;a<i.diffs.length;a++)o.diffs[a]=[i.diffs[a][0],i.diffs[a][1]];o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,n[r]=o}return n},t.prototype.patch_apply=function(e,n){if(e.length===0)return[n,[]];e=this.patch_deepCopy(e);var r=this.patch_addPadding(e);n=r+n+r,this.patch_splitMax(e);for(var i=0,o=[],a=0;a<e.length;a++){var s=e[a].start2+i,c=this.diff_text1(e[a].diffs),l=void 0,d=-1;if(c.length>this.matchMaxBits?(l=this.match_main(n,c.substring(0,this.matchMaxBits),s),l!==-1&&(d=this.match_main(n,c.substring(c.length-this.matchMaxBits),s+c.length-this.matchMaxBits),(d===-1||l>=d)&&(l=-1))):l=this.match_main(n,c,s),l===-1)o[a]=!1,i-=e[a].length2-e[a].length1;else{o[a]=!0,i=l-s;var h=void 0;if(d===-1?h=n.substring(l,l+c.length):h=n.substring(l,d+this.matchMaxBits),c===h)n=n.substring(0,l)+this.diff_text2(e[a].diffs)+n.substring(l+c.length);else{var g=this.diff_main(c,h,!1);if(c.length>this.matchMaxBits&&this.diff_levenshtein(g)/c.length>this.patchDeleteThreshold)o[a]=!1;else{this.diff_cleanupSemanticLossless(g);for(var p=0,y=0,v=0;v<e[a].diffs.length;v++){var m=e[a].diffs[v];m[0]!==H.DIFF_EQUAL&&(y=this.diff_xIndex(g,p)),m[0]===H.DIFF_INSERT?n=n.substring(0,l+y)+m[1]+n.substring(l+y):m[0]===H.DIFF_DELETE&&(n=n.substring(0,l+y)+n.substring(l+this.diff_xIndex(g,p+m[1].length))),m[0]!==H.DIFF_DELETE&&(p+=m[1].length)}}}}}return n=n.substring(r.length,n.length-r.length),[n,o]},t.prototype.patch_addPadding=function(e){for(var n=this.patchMargin,r="",i=1;i<=n;i++)r+=String.fromCharCode(i);for(var i=0;i<e.length;i++)e[i].start1+=n,e[i].start2+=n;var o=e[0],a=o.diffs;if(a.length===0||a[0][0]!==H.DIFF_EQUAL)a.unshift([H.DIFF_EQUAL,r]),o.start1-=n,o.start2-=n,o.length1+=n,o.length2+=n;else if(n>a[0][1].length){var s=n-a[0][1].length;a[0][1]=r.substring(a[0][1].length)+a[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}if(o=e[e.length-1],a=o.diffs,a.length===0||a[a.length-1][0]!==H.DIFF_EQUAL)a.push([H.DIFF_EQUAL,r]),o.length1+=n,o.length2+=n;else if(n>a[a.length-1][1].length){var s=n-a[a.length-1][1].length;a[a.length-1][1]+=r.substring(0,s),o.length1+=s,o.length2+=s}return r},t.prototype.patch_splitMax=function(e){for(var n=this.matchMaxBits,r=0;r<e.length;r++)if(!(e[r].length1<=n)){var i=e[r];e.splice(r--,1);for(var o=i.start1,a=i.start2,s="";i.diffs.length!==0;){var c=new ka,l=!0;for(c.start1=o-s.length,c.start2=a-s.length,s!==""&&(c.length1=c.length2=s.length,c.diffs.push([H.DIFF_EQUAL,s]));i.diffs.length!==0&&c.length1<n-this.patchMargin;){var d=i.diffs[0][0],h=i.diffs[0][1];d===H.DIFF_INSERT?(c.length2+=h.length,a+=h.length,c.diffs.push(i.diffs.shift()),l=!1):d===H.DIFF_DELETE&&c.diffs.length===1&&c.diffs[0][0]===H.DIFF_EQUAL&&h.length>2*n?(c.length1+=h.length,o+=h.length,l=!1,c.diffs.push([d,h]),i.diffs.shift()):(h=h.substring(0,n-c.length1-this.patchMargin),c.length1+=h.length,o+=h.length,d===H.DIFF_EQUAL?(c.length2+=h.length,a+=h.length):l=!1,c.diffs.push([d,h]),h===i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(h.length))}s=this.diff_text2(c.diffs),s=s.substring(s.length-this.patchMargin);var g=this.diff_text1(i.diffs).substring(0,this.patchMargin);g!==""&&(c.length1+=g.length,c.length2+=g.length,c.diffs.length!==0&&c.diffs[c.diffs.length-1][0]===H.DIFF_EQUAL?c.diffs[c.diffs.length-1][1]+=g:c.diffs.push([H.DIFF_EQUAL,g])),l||e.splice(++r,0,c)}}},t.prototype.patch_toText=function(e){for(var n=[],r=0;r<e.length;r++)n[r]=e[r];return n.join("")},t.prototype.patch_fromText=function(e){var n=[];if(!e)return n;for(var r=e.split(`
`),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<r.length;){var a=r[i].match(o);if(!a)throw new Error("Invalid patch string: "+r[i]);var s=new ka;n.push(s),s.start1=parseInt(a[1],10),a[2]===""?(s.start1--,s.length1=1):a[2]==="0"?s.length1=0:(s.start1--,s.length1=parseInt(a[2],10)),s.start2=parseInt(a[3],10),a[4]===""?(s.start2--,s.length2=1):a[4]==="0"?s.length2=0:(s.start2--,s.length2=parseInt(a[4],10)),i++;for(var c=void 0,l=void 0,d=void 0;i<r.length;){c=r[i].charAt(0),d=r[i].substring(1);try{l=decodeURI(d)}catch(h){throw new Error("Illegal escape in patch_fromText: "+d)}if(c==="-")s.diffs.push([H.DIFF_DELETE,l]);else if(c==="+")s.diffs.push([H.DIFF_INSERT,l]);else if(c===" ")s.diffs.push([H.DIFF_EQUAL,l]);else{if(c==="@")break;if(c!=="")throw new Error('Invalid patch mode "'+c+'" in: '+l)}i++}}return n},t.prototype.diff_compute_=function(e,n,r,i){var o;if(!e)return[[H.DIFF_INSERT,n]];if(!n)return[[H.DIFF_DELETE,e]];var a=e.length>n.length?e:n,s=e.length>n.length?n:e,c=a.indexOf(s);if(c!==-1)return o=[[H.DIFF_INSERT,a.substring(0,c)],[H.DIFF_EQUAL,s],[H.DIFF_INSERT,a.substring(c+s.length)]],e.length>n.length&&(o[0][0]=H.DIFF_DELETE,o[2][0]=H.DIFF_DELETE),o;if(s.length===1)return[[H.DIFF_DELETE,e],[H.DIFF_INSERT,n]];var l=this.diff_halfMatch_(e,n);if(l){var d=l[0],h=l[1],g=l[2],p=l[3],y=l[4],v=this.diff_main(d,g,r,i),m=this.diff_main(h,p,r,i);return v.concat([[H.DIFF_EQUAL,y]],m)}return r&&e.length>100&&n.length>100?this.diff_lineMode_(e,n,i):this.diff_bisect_(e,n,i)},t.prototype.diff_lineMode_=function(e,n,r){var i=this.diff_linesToChars(e,n);e=i.chars1,n=i.chars2;var o=i.lineArray,a=this.diff_main(e,n,!1,r);this.diff_charsToLines(a,o),this.diff_cleanupSemantic(a),a.push([H.DIFF_EQUAL,""]);for(var s=0,c=0,l=0,d="",h="";s<a.length;){switch(a[s][0]){case H.DIFF_INSERT:l++,h+=a[s][1];break;case H.DIFF_DELETE:c++,d+=a[s][1];break;case H.DIFF_EQUAL:if(c>=1&&l>=1){a.splice(s-c-l,c+l),s=s-c-l;for(var g=this.diff_main(d,h,!1,r),p=g.length-1;p>=0;p--)a.splice(s,0,g[p]);s=s+g.length}l=0,c=0,d="",h="";break}s++}return a.pop(),a},t.prototype.diff_bisect_=function(e,n,r){for(var i=e.length,o=n.length,a=Math.ceil((i+o)/2),s=a,c=2*a,l=new Array(c),d=new Array(c),h=0;h<c;h++)l[h]=-1,d[h]=-1;l[s+1]=0,d[s+1]=0;for(var g=i-o,p=g%2!=0,y=0,v=0,m=0,C=0,w=0;w<a&&!(Date.now()>r);w++){for(var _=-w+y;_<=w-v;_+=2){var E=s+_,x=void 0;_===-w||_!==w&&l[E-1]<l[E+1]?x=l[E+1]:x=l[E-1]+1;for(var T=x-_;x<i&&T<o&&e.charAt(x)===n.charAt(T);)x++,T++;if(l[E]=x,x>i)v+=2;else if(T>o)y+=2;else if(p){var W=s+g-_;if(W>=0&&W<c&&d[W]!==-1){var F=i-d[W];if(x>=F)return this.diff_bisectSplit_(e,n,x,T,r)}}}for(var G=-w+m;G<=w-C;G+=2){var W=s+G,F=void 0;G===-w||G!==w&&d[W-1]<d[W+1]?F=d[W+1]:F=d[W-1]+1;for(var Z=F-G;F<i&&Z<o&&e.charAt(i-F-1)===n.charAt(o-Z-1);)F++,Z++;if(d[W]=F,F>i)C+=2;else if(Z>o)m+=2;else if(!p){var E=s+g-G;if(E>=0&&E<c&&l[E]!==-1){var x=l[E],T=s+x-E;if(F=i-F,x>=F)return this.diff_bisectSplit_(e,n,x,T,r)}}}}return[[H.DIFF_DELETE,e],[H.DIFF_INSERT,n]]},t.prototype.diff_bisectSplit_=function(e,n,r,i,o){var a=e.substring(0,r),s=n.substring(0,i),c=e.substring(r),l=n.substring(i),d=this.diff_main(a,s,!1,o),h=this.diff_main(c,l,!1,o);return d.concat(h)},t.prototype.diff_linesToCharsMunge_=function(e,n,r,i){for(var o="",a=0,s=-1,c=n.length;s<e.length-1;){s=e.indexOf(`
`,a),s===-1&&(s=e.length-1);var l=e.substring(a,s+1);(r.hasOwnProperty?r.hasOwnProperty(l):r[l]!==void 0)?o+=String.fromCharCode(r[l]):(c===i&&(l=e.substring(a),s=e.length),o+=String.fromCharCode(c),r[l]=c,n[c++]=l),a=s+1}return o},t.prototype.diff_commonOverlap_=function(e,n){var r=e.length,i=n.length;if(r===0||i===0)return 0;r>i?e=e.substring(r-i):r<i&&(n=n.substring(0,r));var o=Kt.min(r,i);if(e===n)return o;for(var a=0,s=1;;){var c=e.substring(o-s),l=n.indexOf(c);if(l===-1)return a;s+=l,(l===0||e.substring(o-s)===n.substring(0,s))&&(a=s,s++)}},t.prototype.diff_halfMatch_=function(e,n){if(this.diffTimeout<=0)return null;var r=e.length>n.length?e:n,i=e.length>n.length?n:e;if(r.length<4||i.length*2<r.length)return null;var o=this.diff_halfMatchI_(r,i,Math.ceil(r.length/4)),a=this.diff_halfMatchI_(r,i,Math.ceil(r.length/2)),s;if(!o&&!a)return null;a?o?s=o[4].length>a[4].length?o:a:s=a:s=o;var c,l,d,h,g=s[4];return e.length>n.length?(c=s[0],l=s[1],d=s[2],h=s[3]):(d=s[0],h=s[1],c=s[2],l=s[3]),[c,l,d,h,g]},t.prototype.diff_halfMatchI_=function(e,n,r){for(var i=e.substring(r,r+Math.floor(e.length/4)),o="",a,s,c,l,d=n.indexOf(i,0);d!==-1;){var h=this.diff_commonPrefix(e.substring(r),n.substring(d)),g=this.diff_commonSuffix(e.substring(0,r),n.substring(0,d));o.length<g+h&&(o=n.substring(d-g,d)+n.substring(d,d+h),a=e.substring(0,r-g),s=e.substring(r+h),c=n.substring(0,d-g),l=n.substring(d+h)),d=n.indexOf(i,d+1)}return o.length*2>=e.length?[a,s,c,l,o]:null},t.prototype.diff_cleanupSemanticScore_=function(e,n){if(!e||!n)return 6;var r=e.charAt(e.length-1),i=n.charAt(0),o=r.match(Qg),a=i.match(Qg),s=o&&r.match(Xg),c=a&&i.match(Xg),l=s&&r.match(Jg),d=c&&i.match(Jg),h=l&&e.match(ww),g=d&&n.match(yw);return h||g?5:l||d?4:o&&!s&&c?3:s||c?2:o||a?1:0},t.prototype.match_bitap_=function(e,n,r){if(n.length>this.matchMaxBits)throw new Error("Pattern too long for this browser");var i=this.match_alphabet_(n),o=this.matchThreshold,a=e.indexOf(n,r);a!==-1&&(o=Kt.min(this.match_bitapScore_(0,a,n,r),o),a=e.lastIndexOf(n,r+n.length),a!==-1&&(o=Kt.min(this.match_bitapScore_(0,a,n,r),o)));var s=1<<n.length-1;a=-1;for(var c,l,d=n.length+e.length,h,g=0;g<n.length;g++){for(c=0,l=d;c<l;)this.match_bitapScore_(g,r+l,n,r)<=o?c=l:d=l,l=Math.floor((d-c)/2+c);d=l;var p=Kt.max(1,r-l+1),y=Kt.min(r+l,e.length)+n.length,v=Array(y+2);v[y+1]=(1<<g)-1;for(var m=y;m>=p;m--){var C=i[e.charAt(m-1)];if(g===0?v[m]=(v[m+1]<<1|1)&C:v[m]=(v[m+1]<<1|1)&C|((h[m+1]|h[m])<<1|1)|h[m+1],v[m]&s){var w=this.match_bitapScore_(g,m-1,n,r);if(w<=o)if(o=w,a=m-1,a>r)p=Kt.max(1,2*r-a);else break}}if(this.match_bitapScore_(g+1,r,n,r)>o)break;h=v}return a},t.prototype.match_bitapScore_=function(e,n,r,i){var o=e/r.length,a=Math.abs(i-n);return this.matchDistance?o+a/this.matchDistance:a?1:o},t.prototype.match_alphabet_=function(e){for(var n={},r=0;r<e.length;r++)n[e.charAt(r)]=0;for(var r=0;r<e.length;r++)n[e.charAt(r)]|=1<<e.length-r-1;return n},t.prototype.patch_addContext_=function(e,n){if(n.length!==0){if(e.start2==null)throw Error("patch not initialized");for(var r=n.substring(e.start2,e.start2+e.length1),i=0;n.indexOf(r)!==n.lastIndexOf(r)&&r.length<this.matchMaxBits-this.patchMargin-this.patchMargin;)i+=this.patchMargin,r=n.substring(e.start2-i,e.start2+e.length1+i);i+=this.patchMargin;var o=n.substring(e.start2-i,e.start2);o&&e.diffs.unshift([H.DIFF_EQUAL,o]);var a=n.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push([H.DIFF_EQUAL,a]),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},t}();function Ou(t,e){let n={};for(let o=0;o<e.length;o++){const a=e[o];n[a]?n[a].push(o):n[a]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<t.length;o++){const a=t[o],s=n[a]||[];let c=0,l=i[0];for(let d=0;d<s.length;d++){const h=s[d];let g;for(g=c;g<i.length&&!(i[g].buffer2index<h&&(g===i.length-1||i[g+1].buffer2index>h));g++);if(g<i.length){const p={buffer1index:o,buffer2index:h,chain:i[g]};if(c===i.length?i.push(l):i[c]=l,c=g+1,l=p,c===i.length)break}}i[c]=l}return i[i.length-1]}u(Ou,"LCS");function _w(t,e){const n=Ou(t,e);let r=[],i=t.length,o=e.length,a={common:[]};function s(){a.common.length&&(a.common.reverse(),r.push(a),a={common:[]})}u(s,"processCommon");for(let c=n;c!==null;c=c.chain){let l={buffer1:[],buffer2:[]};for(;--i>c.buffer1index;)l.buffer1.push(t[i]);for(;--o>c.buffer2index;)l.buffer2.push(e[o]);(l.buffer1.length||l.buffer2.length)&&(s(),l.buffer1.reverse(),l.buffer2.reverse(),r.push(l)),i>=0&&a.common.push(t[i])}return s(),r.reverse(),r}u(_w,"diffComm");function Yg(t,e){const n=Ou(t,e);let r=[],i=t.length,o=e.length;for(let a=n;a!==null;a=a.chain){const s=i-a.buffer1index-1,c=o-a.buffer2index-1;i=a.buffer1index,o=a.buffer2index,(s||c)&&r.push({buffer1:[i+1,s],buffer1Content:t.slice(i+1,i+1+s),buffer2:[o+1,c],buffer2Content:e.slice(o+1,o+1+c)})}return r.reverse(),r}u(Yg,"diffIndices");function C0(t,e){const n=Ou(t,e);let r=[],i=t.length,o=e.length;function a(s,c,l){let d=[];for(let h=0;h<l;h++)d.push(s[c+h]);return{offset:c,length:l,chunk:d}}u(a,"chunkDescription");for(let s=n;s!==null;s=s.chain){const c=i-s.buffer1index-1,l=o-s.buffer2index-1;i=s.buffer1index,o=s.buffer2index,(c||l)&&r.push({buffer1:a(t,s.buffer1index+1,c),buffer2:a(e,s.buffer2index+1,l)})}return r.reverse(),r}u(C0,"diffPatch");function xw(t,e,n){let r=[];function i(c,l){r.push({ab:l,oStart:c.buffer1[0],oLength:c.buffer1[1],abStart:c.buffer2[0],abLength:c.buffer2[1]})}u(i,"addHunk"),Yg(e,t).forEach(c=>i(c,"a")),Yg(e,n).forEach(c=>i(c,"b")),r.sort((c,l)=>c.oStart-l.oStart);let o=[],a=0;function s(c){c>a&&(o.push({stable:!0,buffer:"o",bufferStart:a,bufferLength:c-a,bufferContent:e.slice(a,c)}),a=c)}for(u(s,"advanceTo");r.length;){let c=r.shift(),l=c.oStart,d=c.oStart+c.oLength,h=[c];for(s(l);r.length;){const g=r[0],p=g.oStart;if(p>d)break;d=Math.max(d,p+g.oLength),h.push(r.shift())}if(h.length===1){if(c.abLength>0){const g=c.ab==="a"?t:n;o.push({stable:!0,buffer:c.ab,bufferStart:c.abStart,bufferLength:c.abLength,bufferContent:g.slice(c.abStart,c.abStart+c.abLength)})}}else{let g={a:[t.length,-1,e.length,-1],b:[n.length,-1,e.length,-1]};for(;h.length;){c=h.shift();const w=c.oStart,_=w+c.oLength,E=c.abStart,x=E+c.abLength;let T=g[c.ab];T[0]=Math.min(E,T[0]),T[1]=Math.max(x,T[1]),T[2]=Math.min(w,T[2]),T[3]=Math.max(_,T[3])}const p=g.a[0]+(l-g.a[2]),y=g.a[1]+(d-g.a[3]),v=g.b[0]+(l-g.b[2]),m=g.b[1]+(d-g.b[3]);let C={stable:!1,aStart:p,aLength:y-p,aContent:t.slice(p,y),oStart:l,oLength:d-l,oContent:e.slice(l,d),bStart:v,bLength:m-v,bContent:n.slice(v,m)};o.push(C)}a=d}return s(e.length),o}u(xw,"diff3MergeRegions");function Hu(t,e,n,r){r=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},r);const o=typeof t=="string",a=typeof e=="string",s=typeof n=="string";o&&(t=t.split(r.stringSeparator)),a&&(e=e.split(r.stringSeparator)),s&&(n=n.split(r.stringSeparator));let c=[];const l=xw(t,e,n);let d=[];function h(){d.length&&c.push({ok:d}),d=[]}u(h,"flushOk");function g(p,y){if(p.length!==y.length)return!1;for(let v=0;v<p.length;v++)if(p[v]!==y[v])return!1;return!0}return u(g,"isFalseConflict"),l.forEach(p=>{p.stable?d.push(...p.bufferContent):r.excludeFalseConflicts&&g(p.aContent,p.bContent)?d.push(...p.aContent):(h(),c.push({conflict:{a:p.aContent,aIndex:p.aStart,o:p.oContent,oIndex:p.oStart,b:p.bContent,bIndex:p.bStart}}))}),h(),c}u(Hu,"diff3Merge");function b0(t,e,n,r){r=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},r);const o=Hu(t,e,n,r);let a=!1,s=[];return o.forEach(c=>{c.ok?s=s.concat(c.ok):c.conflict&&(a=!0,s.push(`<<<<<<<${r.label.a?` ${r.label.a}`:""}`),s=s.concat(c.conflict.a),s.push(`|||||||${r.label.o?` ${r.label.o}`:""}`),s=s.concat(c.conflict.o),s.push("======="),s=s.concat(c.conflict.b),s.push(`>>>>>>>${r.label.b?` ${r.label.b}`:""}`))}),{conflict:a,result:s}}u(b0,"mergeDiff3");function Iw(t,e,n,r){r=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},r);const o=Hu(t,e,n,r);let a=!1,s=[];for(let c=0;c<o.length;c++){const l=o[c];l.ok?s=s.concat(l.ok):(a=!0,s=s.concat([`
<<<<<<<<<
`],l.conflict.a,[`
=========
`],l.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:a,result:s}}u(Iw,"node_diff3_merge");function S0(t,e,n,r){r=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},r);const o=Hu(t,e,n,r);let a=!1,s=[];for(let c=0;c<o.length;c++){const l=o[c];if(l.ok)s=s.concat(l.ok);else{const d=_w(l.conflict.a,l.conflict.b);for(let h=0;h<d.length;h++){let g=d[h];g.common?s=s.concat(g.common):(a=!0,s=s.concat([`
<<<<<<<<<
`],g.buffer1,[`
=========
`],g.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:a,result:s}}u(S0,"mergeDigIn");function _0(t,e){let n=[],r=0;function i(o){for(;r<o;)n.push(t[r]),r++}u(i,"advanceTo");for(let o=0;o<e.length;o++){let a=e[o];i(a.buffer1.offset);for(let s=0;s<a.buffer2.chunk.length;s++)n.push(a.buffer2.chunk[s]);r+=a.buffer1.length}return i(t.length),n}u(_0,"patch");function x0(t){return t.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}u(x0,"stripPatch");function I0(t){return t.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}u(I0,"invertPatch");const Wu=new Sw;Wu.diffTimeout=0;function Ew(t,e,n){return de.get("experimental.useDiffMatchPatch")===!0?Wu.patch_toText(Wu.patch_make(e,n)):dw(t,e,n)}u(Ew,"diffs_createPatch");function Zg(t,e,n){return Og(t,e,n)}u(Zg,"diffs_applyPatch");function kw(t,e){const n=[];for(const r of Ea(t,e))n.push({...r,oldFileName:r.newFileName,oldHeader:r.newHeader,newFileName:r.oldFileName,newHeader:r.oldHeader,hunks:r.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),n.push(r);return n}u(kw,"reversePatch");function ep(t,e,n,r,i){let o=`
`;const a=t.match(/(?:\r?\n)/g);if(a!==null&&a.length!==0){const d=a.filter(h=>h===`\r
`).length;o=d>a.length-d?`\r
`:`
`}const s=Iw(t,e,n,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),c=s.result;let l=s.conflict;if(r){let d=!1;if(s.conflict){let h;const g=[];let p=0;for(const m of c)m===`
<<<<<<<<<
`?h={start:p,separator:p,end:p}:m===`
=========
`?h.separator=p:m===`
>>>>>>>>>
`&&(h.end=p,g.push(h)),p++;let y=0,v=0;for(const m of g)c.splice(m.start-y,1),y++,v=m.end-m.separator+1,c.splice(m.separator-y,v),y+=v;g.length&&(d=!0)}}else for(let d=0;d<c.length;d+=1)c[d]===`
<<<<<<<<<
`?c[d]="<<<<<<< HEAD":c[d]===`
=========
`?c[d]="=======":c[d]===`
>>>>>>>>>
`&&(c[d]=`>>>>>>> ${i}`);return{conflicts:l,mergedContent:c.join(o)}}u(ep,"diffs_merge");var Rw=Object.defineProperty,Dw=Object.getOwnPropertyDescriptor,Tw=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Dw(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Rw(e,n,i),i},"changeStore_decorateClass");const lt=J.loadMessageBundle(),Aw=f.FileSystemError.FileNotFound().code,tp=`===================================================================
`,er=new TextDecoder,Pw=new TextEncoder;function Fw(t){return t&&"type"in t&&"uri"in t&&"uri"in t&&"fileType"in t&&"revision"in t&&"timestamp"in t}u(Fw,"isOperation");function Ra(t,e,n){return{type:t.type,rootUri:e,uri:n!=null?n:t.uri}}u(Ra,"toEvent");const Da=u(class{constructor(t,e,n,r,i,o){this.providerService=t,this.storageService=e,this.fileStorageService=n,this.telemetryService=r,this.workspaceId=i,this._onDidChange=new f.EventEmitter,this.cache=new Map,this.lock=new Bf,this.scopedStores=new Map,o===void 0&&(this.disposable=f.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}async exportDebugInfo(t){var e;async function n(r){const i=await f.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${r.toString(!0)}

${this.toStorage(await this.getWorkingOperations(r))}`});return void f.window.showTextDocument(i)}if(u(n,"exportCore"),t===void 0)for(const r of(e=f.workspace.workspaceFolders)!=null?e:[])await n.call(this,r.uri);else return n.call(this,t)}async getWorkspacesWithChanges(){var t;const e=new Pe("ChangeStore.getWorkspacesWithChanges()");try{const n=[];for(const r of(t=f.workspace.workspaceFolders)!=null?t:[])r.uri.scheme===ce.scheme&&await this.hasChanges(r.uri)&&n.push(r.uri);return n.length>0?n:void 0}finally{e.stop()}}async acceptAll(t,e){const n=`ChangeStore.acceptAll(${t.toString()}, ${e==null?void 0:e.staged})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(t),async()=>{const i=await this.getWorkingOperations(t),o=[];let a=[];const s=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(c=>c.staged));for(const c of i){if(s&&!c.staged){a.push(c);continue}c.fileType===f.FileType.File&&await this.discardWorkingContent(t,c.uri);let l;if(c.type===D.Created&&c.fileType===f.FileType.Directory&&(i.some(d=>Ti(d.uri,c.uri))||(l={type:D.Deleted,rootUri:t,uri:c.uri})),r.push(l!=null?l:Ra(c,t)),c.type===D.Created){let d=c.uri;for(;;){const{parent:h}=this.findParent(d,i,g=>g.type===D.Created);if(h){o.push(h),d=h.uri;continue}break}}}a.length>0&&o.length>0&&(a=a.filter(c=>o.includes(c)?(r.push(Ra(c,t)),!1):!0)),await this.saveWorkingOperations(t,a)},n),r.length!==0&&this._onDidChange.fire(r)}async discard(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=`ChangeStore.discard(${t.toString()})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(e),async()=>this.discardCore(e,t,r),n),r.length!==0&&this._onDidChange.fire(r)}async discardCore(t,e,n){U.debug(`ChangeStore.discardCore(${e.toString()})`);let r=await this.getWorkingOperations(t);if(r.length===0)return;const i=dt(e),o=r.findIndex(c=>dt(c.uri)===i);if(o===-1)return;const[a]=r.splice(o,1);let s;switch(a.type){case D.Created:s=D.Deleted;break;case D.Deleted:s=D.Created;break;default:s=a.type;break}if(n.push({type:s,rootUri:t,uri:e}),a.type===D.Created){let c=a.uri;for(;;){const{parent:l,parentIndex:d}=this.findNewParentWithOnlyChild(c,r);if(l){r.splice(d,1),n.push({type:D.Deleted,rootUri:t,uri:l.uri}),c=l.uri;continue}break}}else if(a.type===D.Deleted){let c=a.uri;const l=this.findDeletedParents(c,r);let d=[...r];l.forEach(({parent:h,parentIndex:g})=>{d[g]=void 0,n.push({type:D.Created,rootUri:t,uri:h.uri})}),r=d.filter(h=>h!==void 0)}await this.saveWorkingOperations(t,r),a.fileType===f.FileType.File&&await this.discardWorkingContent(t,e)}async discardAll(t,e){const n=this.getUriScope(t);if(n)return this.getScopedChangeStore(n).discardAll(t,e);const r=`ChangeStore.discardAll(${t.toString()}, ${e==null?void 0:e.staged})`;U.log(r);const i=[];await this.lock.synchronizeWrite(N(t),async()=>{const o=await this.getWorkingOperations(t),a=[];let s=[];const c=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(l=>l.staged));for(const l of o){if(c&&!l.staged){s.push(l);continue}l.fileType===f.FileType.File&&await this.discardWorkingContent(t,l.uri);let d;switch(l.type){case D.Created:d=D.Deleted;break;case D.Deleted:d=D.Created;break;default:d=l.type;break}if(i.push({type:d,rootUri:t,uri:l.uri}),l.type===D.Created){let h=l.uri;for(;;){const{parent:g}=this.findNewParentWithOnlyChild(h,o);if(g){a.push(g),h=g.uri;continue}break}}}s.length>0&&a.length>0&&(s=s.filter(l=>a.includes(l)?(i.push({type:D.Deleted,rootUri:t,uri:l.uri}),!1):!0)),await this.saveWorkingOperations(t,s)},r),i.length!==0&&this._onDidChange.fire(i)}async stage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=`ChangeStore.stage(${t.toString()})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if(i!==void 0){if(i.conflicts){if(!i.conflicts.status.includes(D.Deleted)){const s=lt("yes","Yes");if(await f.window.showWarningMessage(lt("stage with merge conflicts","Are you sure you want to stage {0} with merge conflicts?",tt(t)),{modal:!0},s)!==s)return}const[,a]=i.conflicts.status;switch(a){case D.Changed:switch(i.type){case D.Created:return;case D.Changed:await this.spliceOperation(t,o,{...i,conflicts:void 0,staged:!0,timestamp:Date.now()},r);return;case D.Deleted:const s=lt("keep theirs","Keep Their Version"),c=lt("delete","Delete File"),l=await f.window.showInformationMessage(lt("deleted by us",`File '{0}' was deleted by us and modified by them.

What would you like to do?`,tt(t)),{modal:!0},s,c);if(l===s){await this.discardCore(e,t,r);return}else if(l===c){await this.spliceOperation(t,o,{...i,type:D.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,staged:!0,timestamp:Date.now()},r);return}else return}case D.Created:switch(i.type){case D.Changed:case D.Deleted:return;case D.Created:await this.spliceOperation(t,o,{...i,type:D.Changed,conflicts:void 0,size:i.size,hash:i.hash,originalHash:i.originalHash,staged:!0,timestamp:Date.now()},r);return}case D.Deleted:switch(i.type){case D.Created:case D.Changed:{const s=lt("keep ours","Keep Our Version"),c=lt("delete","Delete File"),l=await f.window.showInformationMessage(lt("deleted by them",`File '{0}' was deleted by them and modified by us.

What would you like to do?`,tt(t)),{modal:!0},s,c);if(l===s){await this.spliceOperation(t,o,{...i,type:D.Created,originalHash:void 0,conflicts:void 0,staged:!0,timestamp:Date.now()},r);return}else if(l===c){await this.discardCore(e,t,r);return}else return}case D.Deleted:await this.discardCore(e,t,r);return}}}await this.spliceOperation(t,o,{...i,staged:!0,conflicts:void 0,timestamp:Date.now()},r)}},n),r.length!==0&&this._onDidChange.fire(r)}async stageAll(t){const e=`ChangeStore.stageAll(${t.toString()})`;U.log(e);const n=[];await this.lock.synchronizeWrite(N(t),async()=>{const r=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!0,timestamp:Date.now()}));r.length!==0&&(await this.saveWorkingOperations(t,r),n.push(...r.map(i=>Ra(i,t))))},e),n.length!==0&&this._onDidChange.fire(n)}async unstage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=`ChangeStore.unstage(${t.toString()})`;U.log(n);const r=[];await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!1,timestamp:Date.now()},r)},n),r.length!==0&&this._onDidChange.fire(r)}async unstageAll(t){const e=`ChangeStore.unstageAll(${t.toString()})`;U.log(e);const n=[];await this.lock.synchronizeWrite(N(t),async()=>{const r=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!1,timestamp:Date.now()}));r.length!==0&&(await this.saveWorkingOperations(t,r),n.push(...r.map(i=>Ra(i,t))))},e),n.length!==0&&this._onDidChange.fire(n)}async hasChanges(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).hasChanges(t);const n=N(t),r=this.cache.get(n);return r!==void 0?r.length!==0:this.lock.synchronizeRead(n,async()=>(await this.getWorkingOperations(t)).length!==0,`ChangeStore.hasChanges(${t.toString()})`)}maybeHasChanges(t,e){const n=this.getUriScope(t);if(n)return this.getScopedChangeStore(n).maybeHasChanges(t,e);const r=N(t),i=this.cache.get(r);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=dt(e);return i.some(a=>dt(a.uri)===o)}async hasMergeConflicts(t){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${t.toString()})`)}async hasStagedChanges(t){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${t.toString()})`)}async hasWorkingChanges(t){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${t.toString()})`)}async getChange(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).getChange(t);const n=this.providerService.getVirtualRootUri(t);if(n!==void 0)return this.lock.synchronizeRead(N(n),async()=>{const{operation:r}=await this.getWorkingOperation(t,n);return r},`ChangeStore.getChange(${t.toString()})`)}async getChanges(t,e){const n=this.getUriScope(t);return n?this.getScopedChangeStore(n).getChanges(t,e):this.lock.synchronizeRead(N(t),async()=>{let r=await this.getWorkingOperations(t);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;r=r.filter(a=>{var s;return(!i||a.conflicts===void 0)&&((s=o==null?void 0:o(a))!=null?s:!0)})}return r},`ChangeStore.getChanges(${t.toString()})`)}async getGroupedChanges(t,e){const n=this.getUriScope(t);return n?this.getScopedChangeStore(n).getGroupedChanges(t,e):this.lock.synchronizeRead(N(t),async()=>{var r,i;const o=await this.getWorkingOperations(t),a={conflicts:[],staged:[],working:[]};for(const s of o)!((i=(r=e==null?void 0:e.predicate)==null?void 0:r.call(e,s))!=null?i:!0)||(s.conflicts?a.conflicts.push(s):s.staged?a.staged.push(s):a.working.push(s));return a},`ChangeStore.getChangesByType(${t.toString()})`)}async getContent(t){const e=this.providerService.getVirtualRootUri(t);if(e===void 0)throw new Error(`Unable to find content for ${t.toString()}; Repository not found`);const n=N(e),r=this.cache.get(n);if((r==null?void 0:r.length)===0)throw new Error(`Unable to find content for ${t.toString()}`);return this.lock.synchronizeRead(n,async()=>{const i=er.decode(await this.getWorkingContent(e,t));if(i!==void 0)return i;throw new Error(`Unable to find content for ${t.toString()}`)},`ChangeStore.getContent(${t.toString()}}`)}async getMergeConflicts(t,e){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).filter(r=>{var i,o;return r.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,r))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${t.toString()})`)}async getStagedChanges(t,e){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).filter(r=>{var i,o;return r.staged&&r.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,r))!=null?o:!0)}),`ChangeStore.getStagedChanges(${t.toString()})`)}async getWorkingChanges(t,e){return this.lock.synchronizeRead(N(t),async()=>(await this.getWorkingOperations(t)).filter(r=>{var i,o;return!r.staged&&r.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,r))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${t.toString()})`)}async applyChangeset(t,e,n,r){var i;let o;Fw(n)?o=n:r=r!=null?r:n,U.log(`ChangeStore.applyChangeset${t.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,r==null?void 0:r.save);const a=this.getScopedChangeStore(e.workspaceId),s=(i=e.patch)!=null?i:await a.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(t,s,{...r,getIncomingContent:async c=>{const l=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,c),e.workspaceId);return er.decode(await f.workspace.fs.readFile(l))},merge:async(c,l,d)=>{try{const h=ce.getProviderUri(c),g=er.decode(await f.workspace.fs.readFile(h)),p=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,l),e.workspaceId),y=er.decode(await f.workspace.fs.readFile(p)),v=await this.providerService.getMetadata(p);return{...ep(d,g,y,Boolean(r==null?void 0:r.useSimplifiedMerge),v.HEAD.sha),baseUri:h,incomingUri:p}}catch(h){throw new Error(`Unable to apply patch to ${l}: ${String(h)}`)}}})}async applyPatch(t,e,n){if(U.log(`ChangeStore.applyPatch(${t.toString()})`,n==null?void 0:n.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(t,e,n)}async applyPatchCore(t,e,n={}){const r=`ChangeStore.applyPatchCore(${t.toString()})`;U.debug(r,n==null?void 0:n.save);const i=new f.WorkspaceEdit,o=[],a=new Map;async function s(g){var p;const y=N(g),v=f.workspace.textDocuments.find(m=>N(m.uri)===y);return(p=v==null?void 0:v.getText())!=null?p:er.decode(await f.workspace.fs.readFile(g))}u(s,"getContent");async function c(g){try{const p=await f.workspace.fs.stat(g);return Boolean(p)}catch{return!1}}u(c,"exists");async function l(g,p,y){let v=Zg("",y,{fuzzFactor:0});if(v===!1){if(!n.getIncomingContent)throw new Error(`Unable to apply patch to ${p}`);v=await n.getIncomingContent(p)}i.createFile(g,{overwrite:!0}),i.replace(g,new f.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),v)}u(l,"applyCreate");async function d(g,p,y,v){const m=await s(g);let C=Zg(m,y,{fuzzFactor:1});if(C===!1){if(n.merge===void 0)throw new Error(`Unable to apply patch to ${p}; Resulted in conflicts`);const w={title:lt("apply patch failed prompt confirm","Merge")},_={title:lt("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await f.window.showWarningMessage(lt("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,p),{modal:!0},w,_)!==w)return;const x=await n.merge(g,p,m);C=x.mergedContent,x.conflicts&&a.set(N(g),{type:v,baseUri:x.baseUri,incomingUri:x.incomingUri})}i.replace(g,new f.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),C)}u(d,"applyModification");const h=(n==null?void 0:n.reverse)?kw(e,{}):Ea(e,{});for(const g of h)if(g.oldFileName==="/dev/null"){if(!g.newFileName)continue;const p=g.newFileName.startsWith("b/")?g.newFileName.substr(2):g.newFileName,y=this.providerService.createRelativeVirtualUri(t,p);o.push(N(y)),!await c(y)?await l(y,p,g):await d(y,p,g,D.Created)}else if(g.newFileName==="/dev/null"){if(!g.oldFileName)continue;const p=g.oldFileName.startsWith("a/")?g.oldFileName.substr(2):g.oldFileName,y=this.providerService.createRelativeVirtualUri(t,p);await c(y)&&i.deleteFile(y)}else if(g.oldFileName===g.newFileName){if(!g.newFileName)continue;const p=this.providerService.createRelativeVirtualUri(t,g.newFileName);o.push(N(p)),!await c(p)?await l(p,g.newFileName,g):await d(p,g.newFileName,g,D.Changed)}else throw new Error(`Unable to apply patch to ${g.oldFileName}; Renames aren't currently supported`);if(await f.workspace.applyEdit(i),n.save&&o.length)for(const g of o){const p=f.workspace.textDocuments.find(y=>N(y.uri)===g);await(p==null?void 0:p.save())}a.size&&setTimeout(async()=>{const g=[];await this.lock.synchronizeWrite(N(t),async()=>{const p=await this.getWorkingOperations(t);if(p.length===0)return;let y=-1;for(const v of p){y++;const m=a.get(N(v.uri));m!==void 0&&await this.spliceOperation(v.uri,y,{...v,conflicts:{baseUri:m.baseUri,incomingUri:m.incomingUri,status:[v.type,m.type]},timestamp:Date.now()},g)}},r),g.length!==0&&this._onDidChange.fire(g)},0)}async createChangeset(t){U.log(`ChangeStore.createChangeset${t.toString()})`);const e=await this.createPatch(t);return e?{workspaceId:this.workspaceId,uri:t,patch:e}:void 0}async createPatch(t,e,n){if(U.log(`ChangeStore.createPatch${t.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(t);if((n==null?void 0:n.staged)&&(o=o.filter(s=>s.staged)),o.length===0)return"";const a=[];for(const s of o){const c=await this.createPatchCore(t,s);a.push(c)}return a.join("")}const{operation:r}=await this.getWorkingOperation(e,t);if(r===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(n==null?void 0:n.staged)&&r.staged?"":await this.createPatchCore(t,r)}async createPatchCore(t,e){const n=this.providerService.getRelativeFilePath(t,e.uri),r=`diff --git a/${n} b/${n}`;if(e.type===D.Created){let c=await this.getContent(e.uri),l;!c.endsWith(`
`)&&!c.endsWith(`\r
`)?l=`
\\ No newline at end of file`:l="";let d=0;return c=c.replace(/\r?\n/g,h=>(d++,`${h}+`)),`${r}
new file mode 100644
--- /dev/null
+++ b/${n}
@@ -0,0 +1,${d} @@
+${c}${l}`}if(e.type===D.Deleted){let c=er.decode(await f.workspace.fs.readFile(ce.getProviderUri(e.uri))),l=0;return c=c.replace(/\r?\n/g,d=>(l++,`${d}-`)),`${r}
deleted file mode 100644
--- a/${n}
+++ /dev/null
@@ -1,${l} +0,0 @@
-${c}`}const i=await this.getContent(e.uri),o=er.decode(await f.workspace.fs.readFile(ce.getProviderUri(e.uri))),a=Ew(n,o,i),s=a.indexOf(tp);return`${r}
${a.substr(s+tp.length)}`}async keep(t,e){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const r=`ChangeStore.keep(${t.toString()})`;U.log(r,e);const i=[];await this.lock.synchronizeWrite(N(n),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(t,n);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,c]=o.conflicts.status;switch(c){case D.Changed:switch(o.type){case D.Changed:case D.Created:case D.Deleted:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case D.Created:switch(o.type){case D.Changed:case D.Deleted:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case D.Created:await this.spliceOperation(t,a,{...o,type:D.Changed,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case D.Deleted:switch(o.type){case D.Deleted:await this.discardCore(n,t,i);break;case D.Changed:await this.spliceOperation(t,a,{...o,type:D.Created,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case D.Created:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case D.Changed:switch(o.type){case D.Deleted:await this.spliceOperation(t,a,{...o,type:D.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case D.Created:break;case D.Changed:break}break;case D.Created:switch(o.type){case D.Changed:case D.Deleted:return;case D.Created:break}break;case D.Deleted:switch(o.type){case D.Deleted:return this.discardCore(n,t,i);case D.Changed:await this.spliceOperation(t,a,{...o,type:D.Created,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case D.Created:return}}const s=e!==void 0?await f.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(t,a,{...o,type:D.Changed,originalHash:s!==void 0?await ti(s):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},r),i.length!==0&&this._onDidChange.fire(i)}async merge(t,e,n,r){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=`ChangeStore.merge(${t.toString()})`;U.log(o,e,n);const a=[];await this.lock.synchronizeWrite(N(i),async()=>{const{operation:s,index:c}=await this.getWorkingOperation(t,i);if(s===void 0)return;switch(e.type){case D.Changed:switch(s.type){case D.Deleted:await this.spliceOperation(t,c,{...s,type:D.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:n.providerUri,incomingUri:e.providerUri,status:[s.type,e.type]},timestamp:Date.now()},a);return;case D.Created:break;case D.Changed:break}break;case D.Created:switch(s.type){case D.Deleted:case D.Changed:return;case D.Created:break}break;case D.Deleted:switch(s.type){case D.Deleted:return this.discardCore(i,t,a);case D.Changed:await this.spliceOperation(t,c,{...s,type:D.Created,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[s.type,e.type]},timestamp:Date.now()},a);return;case D.Created:return}}const l=await this.providerService.getMetadata(e.providerUri),d=await this.getWorkingContent(i,t),h=s.type===D.Created?new Uint8Array(0):await f.workspace.fs.readFile(n.providerUri),g=await f.workspace.fs.readFile(e.providerUri),p=ep(er.decode(d),er.decode(h),er.decode(g),r,l.HEAD.sha);await this.writeFileCore(i,t,a,Pw.encode(p.mergedContent),g!=null?g:new Uint8Array(0),p.conflicts?{baseUri:n.providerUri,incomingUri:e.providerUri,status:[s.type,e.type]}:void 0)},o),a.length!==0&&this._onDidChange.fire(a)}async resolveDiffCommand(t,e,n,r){let i;const o=this.providerService.getVirtualRootUri(t);return o!==void 0&&({operation:i}=await this.getWorkingOperation(t,o)),(i==null?void 0:i.type)===D.Deleted?this.resolveOpenCommand(e):((i==null?void 0:i.type)===D.Created&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,t,n,r]})}resolveOpenCommand(t,e){return{command:"vscode.open",title:"Open File",arguments:[t,e]}}getScopedUri(t,e){const n=typeof e=="string"?e:e.workspaceId;return n===this.workspaceId?t:t.with({fragment:n})}getUriScope(t){return t.fragment||void 0}getScopedChangeStore(t){const e=typeof t=="string"?t:t.workspaceId;U.log(`ChangeStore.getScopedChangeStore(${e})`);let n=this.scopedStores.get(e);return n===void 0&&(n=e===this.workspaceId?new Da.ScopedChangeStore(this,e,this.workspaceId):new Da.ScopedChangeStore(new Da(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,n)),n}async stat(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).stat(t);const n=this.providerService.getVirtualRootUri(t);if(n===void 0)return;const r=N(n),i=this.cache.get(r);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(r,async()=>{var o;const{operation:a}=await this.getWorkingOperation(t,n);if(a!==void 0){if(a.type===D.Deleted)throw f.FileSystemError.FileNotFound(`The ${a.fileType===f.FileType.Directory?"folder":"file"} has been deleted.`);return{type:a.fileType,size:(o=a.size)!=null?o:0,ctime:0,mtime:a.timestamp}}},`ChangeStore.stat(${t.toString()}`)}async readFile(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).readFile(t);const n=new Pe(`ChangeStore.readFile(${t.toString()})`);try{const r=this.providerService.getVirtualRootUri(t);if(r===void 0)return;const i=N(r),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const a=this.cache.get(i);if((a==null?void 0:a.length)===0){n.log({message:": Not found; no operations"});return}return this.getWorkingContent(r,t)},n.context)}finally{n.stop()}}async createDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=new Pe(`ChangeStore.createDirectory(${t.toString()})`);try{const r=[];if(await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e),a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,i===void 0?{type:D.Created,uri:t,fileType:f.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},r)},n.context),r.length===0)return;this._onDidChange.fire(r)}finally{n.stop()}}async deleteDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=new Pe(`ChangeStore.deleteDirectory(${t.toString()})`);try{const r=[];if(await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===D.Created)return this.discardCore(e,t,r);const a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,{type:D.Deleted,uri:t,fileType:f.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},r)},n.context),r.length===0)return;this._onDidChange.fire(r)}finally{n.stop()}}async updateDirectoryEntries(t,e){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return e;const r=new Pe(`ChangeStore.updateDirectoryEntries(${t.toString()})`,{},e.length);try{const i=N(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:a}=Dr(n,t),s=await this.getWorkingOperations(n);for(const c of s)switch(c.type){case D.Changed:break;case D.Created:{if(Ti(c.uri,a)){const l=this.providerService.getRelativeFilePath(t,c.uri);e.push([l,c.fileType])}break}case D.Deleted:{if(Ti(c.uri,a)){const l=this.providerService.getRelativeFilePath(t,c.uri),d=e.findIndex(([h])=>h===l);d!==-1&&e.splice(d,1)}break}}return e},r.context)}finally{r.stop()}}async writeFile(t,e,n,r){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=new Pe(`ChangeStore.writeFile(${t.toString()})`,{},e.length,r);try{const a=[];if(await this.lock.synchronizeWrite(N(i),async()=>this.writeFileCore(i,t,a,e,n,r),o.context),a.length===0)return;this._onDidChange.fire(a)}finally{o.stop()}}async writeFileCore(t,e,n,r,i,o){const a=new Pe(`ChangeStore.writeFileCore(${e.toString()})`,{},r.length,o);try{const[{operation:s,index:c},l,d]=await Promise.all([this.getWorkingOperation(e,t),ti(r),ti(i)]);if(l===d&&(!s||(s==null?void 0:s.type)===D.Changed))return this.discardCore(t,e,n);if(l===(s==null?void 0:s.hash)&&d===(s==null?void 0:s.originalHash))return;const[{HEAD:h}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(t,e,r)]);await this.spliceOperation(e,c,s===void 0?{type:D.Changed,uri:e,fileType:f.FileType.File,revision:h.sha,timestamp:Date.now(),size:r.byteLength,hash:l,originalHash:d,conflicts:o,staged:!1}:{...s,revision:h.sha,timestamp:Date.now(),size:r.byteLength,hash:l,originalHash:d,conflicts:o,staged:!1},n)}finally{a.stop()}}async createFile(t,e){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const r=new Pe(`ChangeStore.createFile(${t.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(N(n),async()=>{const[{operation:o,index:a},s,c]=await Promise.all([this.getWorkingOperation(t,n),ti(e),this.providerService.getMetadata(t),this.saveWorkingContent(n,t,e)]);await this.spliceOperation(t,a,o===void 0?{type:D.Created,uri:t,fileType:f.FileType.File,revision:c.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s,originalHash:s}:{...o,type:D.Created,revision:c.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s},i)},r.context),i.length===0)return;this._onDidChange.fire(i)}finally{r.stop()}}async deleteFile(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const n=new Pe(`ChangeStore.deleteFile(${t.toString()})`);try{const r=[];if(await this.lock.synchronizeWrite(N(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===D.Created)return this.discardCore(e,t,r);const[a]=await Promise.all([this.providerService.getMetadata(t),this.discardWorkingContent(e,t)]);await this.spliceOperation(t,o,{type:D.Deleted,uri:t,fileType:f.FileType.File,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},r)},n.context),r.length===0)return;this._onDidChange.fire(r)}finally{n.stop()}}findParent(t,e,n){const r=xt(t),{operation:i,index:o}=this.findWorkingOperation(r,e);return i!==void 0&&n(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(t,e){const n=dt(t);return this.findParent(t,e,(r,i)=>r.type===D.Created&&!i.some(o=>Ti(o.uri,r.uri)&&dt(o.uri)!==n))}findDeletedParents(t,e){const n=[];for(let r=0;r<e.length;r+=1){const i=e[r];i.type===D.Deleted&&Tr(t,i.uri)&&n.push({parent:i,parentIndex:r})}return n}async getWorkingOperation(t,e){return this.findWorkingOperation(t,await this.getWorkingOperations(e))}findWorkingOperation(t,e){if(e.length===0)return{operation:void 0,index:-1};const n=dt(t);let r=-1;const i=e.find((o,a)=>dt(o.uri)!==n?!1:(r=a,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:r}}async getWorkingOperations(t){const e=N(t);let n=this.cache.get(e);return n===void 0&&(n=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,n)),n}async saveWorkingOperations(t,e){U.debug(`ChangeStore.saveWorkingOperations(${t.toString()})`,e.length);const n=N(t);this.cache.set(n,e);try{await this.storageService.store(this.getOperationsStorageKey(n),this.toStorage(e))}catch(r){throw this.cache.delete(n),U.error(r,`Failed to save repository changes for ${n}`),r}}getOperationsStorageKey(t){return`operations/${t}`}async getWorkingContent(t,e){try{return await this.fileStorageService.get(this.getFileStorageKey(t,e))}catch(n){throw U.error(n),this.telemetryService.sendException(n),n}}async discardWorkingContent(t,e){U.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(t,e))}catch(n){if(n instanceof f.FileSystemError&&n.code===Aw)return;throw U.error(n),this.telemetryService.sendException(n),n}}async saveWorkingContent(t,e,n){U.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,n.length);try{return await this.fileStorageService.store(this.getFileStorageKey(t,e),n)}catch(r){throw U.error(r),this.telemetryService.sendException(r),r}}getFileStorageKey(t,e){return`changestore/${yt(e)}`}async spliceOperation(t,e,n,r){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,n):o.push(n),await this.saveWorkingOperations(i,o),r.push(Ra(n,i,t))}fromStorage(t){if(!t)return[];try{const e=JSON.parse(t,(n,r)=>(n==="uri"||n.endsWith("Uri"))&&Ar(r)?typeof r=="string"?f.Uri.parse(r):f.Uri.from(r):r);return Array.isArray(e)?e:e.operations}catch(e){throw U.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(t){const e={schemaVersion:Da.operationsStorageSchemaVersion,operations:t};return JSON.stringify(e)}},"_ChangeStore");let Bu=Da;Bu.operationsStorageSchemaVersion=1,Bu.ScopedChangeStore=class{constructor(t,e,n){this.changeStore=t,this.scope=e,this.workspaceId=n}createPatch(t,e,n){return this.changeStore.createPatch(this.stripUriScope(t),this.stripUriScope(e),n)}discardAll(t,e){return this.changeStore.discardAll(this.stripUriScope(t),e)}getChange(t){return this.changeStore.getChange(this.stripUriScope(t))}getChanges(t,e){return this.changeStore.getChanges(this.stripUriScope(t),e)}async getGroupedChanges(t,e){return this.changeStore.getGroupedChanges(this.stripUriScope(t),e)}hasChanges(t){return this.changeStore.hasChanges(this.stripUriScope(t))}maybeHasChanges(t,e){return this.changeStore.maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}async stat(t){const n=this.changeStore.getUriScope(t)!==this.workspaceId,r=await this.changeStore.stat(this.stripUriScope(t));return r!==void 0&&n&&(r.permissions=f.FilePermission.Readonly),r}readFile(t){return this.changeStore.readFile(this.stripUriScope(t))}resolveDiffCommand(t,e,n,r){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(t,this.scope),this.changeStore.getScopedUri(e,this.scope),n,r)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}},Tw([br()],Bu.prototype,"getWorkingOperations",1);function Mw(t){switch(t){case D.Changed:return lt("change type changed","Modified");case D.Created:return lt("change type created","Added");case D.Deleted:return lt("change type deleted","Deleted")}}u(Mw,"getStatusText");function Nw(t){const[e,n]=t;switch(e){case D.Changed:switch(n){case D.Changed:case D.Created:return lt("conflict status changed both","Modified by Both");case D.Deleted:return lt("conflict status deleted them","Deleted by Incoming")}case D.Created:switch(n){case D.Changed:case D.Created:return lt("conflict status created both","Added by Both");case D.Deleted:return lt("conflict status deleted them","Deleted by Incoming")}case D.Deleted:switch(n){case D.Changed:case D.Created:return lt("conflict status deleted us","Deleted by Current");case D.Deleted:return lt("conflict status deleted both","Deleted by Both")}}}u(Nw,"getConflictStatusText");const vn=J.loadMessageBundle();class np{constructor(e){this.providerService=e,this._onDidChangeFileDecorations=new f.EventEmitter,this._decorations=new Map,this.disposable=f.Disposable.from(f.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),e.onDidChangeChangeStore(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const n=e.map(({uri:r})=>(this._decorations.delete(N(r)),r));setTimeout(()=>this._onDidChangeFileDecorations.fire(n),0)}async provideFileDecoration(e,n){if(e.scheme!==Wt.scheme)return;await Qt(this.providerService,e);const r=N(e);let i=this._decorations.get(r);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let a;o.length>0&&(a=o.find(c=>N(c.uri)===r));const s=await this.providerService.changeStoreGetChange(e);if(s===void 0){if(a!==void 0)switch(a.type){case D.Created:i={badge:"\u2193A",color:new f.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:vn("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case D.Deleted:i={badge:"\u2193D",color:new f.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:vn("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case D.Changed:i={badge:"\u2193M",color:new f.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:vn("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new f.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:vn("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(r,i!=null?i:null),i}if(s.conflicts)i={badge:"!",color:new f.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:vn("decoration tooltip conflicts","Merge Conflicts ({0})",Nw(s.conflicts.status))};else if(a!==void 0)switch(a.type){case D.Created:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:vn("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case D.Deleted:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:vn("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case D.Changed:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:vn("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new f.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:vn("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(s.type){case D.Created:i={badge:"A",color:new f.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:vn("decoration tooltip added","Added")};break;case D.Changed:i={badge:"M",color:new f.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:vn("decoration tooltip modified","Modified")};break;case D.Deleted:i={badge:"D",color:new f.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:vn("decoration tooltip deleted","Deleted")};break}return this._decorations.set(r,i!=null?i:null),i}}u(np,"ScmDecorationProvider");class $u{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,n=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((r,i)=>{this.resolver=r,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const r=this.task;return this.task=void 0,r()}})),this.timeout=setTimeout(()=>{var r;this.timeout=void 0,(r=this.resolver)==null||r.call(this,void 0)},n),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}u($u,"TaskDebouncer");const Lw=J.loadMessageBundle();class kr{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await f.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}u(kr,"CommandQuickPickItem");var oc;(function(t){async function e(n,r,i,o,a,s){let c;Array.isArray(a)?c=a:s===void 0&&(c=[],s=a);const l=f.window.createQuickPick(),d=new $u(500),h=[d],{defaultBranch:g,HEAD:p}=await n.getMetadata(r);async function y(_){var E;const[x,T,W]=await Promise.all([n.getBranches(r,{query:_,limit:100}),n.getTags(r,{query:_,limit:100}),n.getSnapshots(r)]),F=new Set,G=new Set;for(const se of W)F.add(se.hash),G.add(se.branch.name);const Z=((s==null?void 0:s.filterBranches)?x.branches.filter(s==null?void 0:s.filterBranches):x.branches).filter(se=>se.name!==g.name),ee=Lw("indexedCommit","Open indexed commit"),Q=[{iconPath:new f.ThemeIcon("layers-active"),tooltip:ee}];return[...c,...((E=p.branch)==null?void 0:E.name)!==g.name?[{label:`$(git-branch) ${g.name} (default)`,description:`\u2022$(git-commit) ${Fe(g.sha)}${G.has(g.name)||F.has(g.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:Me.Branch,name:void 0,sha:g.sha,buttons:G.has(g.name)||F.has(g.sha)?Q:void 0}]:[],...Z.map(se=>({label:`$(git-branch) ${se.name}`,description:`\u2022$(git-commit) ${Fe(se.commit)}${G.has(se.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:Me.Branch,name:se.name,sha:se.commit,buttons:G.has(se.name)?Q:void 0})),...T.tags.map(se=>({label:`$(tag) ${se.name}`,description:`\u2022$(git-commit) ${Fe(se.commit)}${F.has(se.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:Me.Tag,name:se.name,sha:se.commit,buttons:F.has(se.commit)?Q:void 0}))]}u(y,"getItems");const v=y(void 0);let m,C=!1;async function w(_){m=void 0;const E=l.activeItems;l.items=_!=null?_:await v,C&&E.length!==0&&(l.activeItems=l.items.filter(x=>E.some(T=>T.label===x.label))),l.busy=!1}u(w,"setItems");try{return await new Promise(E=>{var x;h.push(l.onDidHide(()=>E(void 0)),l.onDidChangeValue(T=>{if(C=!1,T=T.trim(),(s==null?void 0:s.allowResetToSha)&&p.branch&&rt(T)){w([{label:`Reset $(git-branch) ${p.branch.name} to $(git-commit) ${T}`,name:p.branch.name,sha:T,type:Me.Branch}]);return}l.busy=!0;const W=d.debounce(T?()=>y(T):()=>v);m===void 0&&(m=W.then(async F=>w(F)))}),l.onDidAccept(()=>{if(l.activeItems.length!==0){const[T]=l.activeItems;E(T)}}),l.onDidTriggerItemButton(T=>{const W=T.item;W instanceof kr||(W.useIndex=!0),E(W)})),l.title=o,l.placeholder=i,l.matchOnDescription=!0,l.ignoreFocusOut=(x=s==null?void 0:s.ignoreFocusOut)!=null?x:!0,l.busy=!0,l.show(),m=d.debounce(async()=>v,0).then(T=>w(T))})}finally{l.dispose(),h.forEach(_=>void _.dispose())}}u(e,"show"),t.show=e})(oc||(oc={}));const P=J.loadMessageBundle(),Uw=new TextDecoder;class rp{constructor(e,n,r){this.providerService=e,this.openActionsService=n,this.telemetryService=r,this._onDidCloseRepository=new f.EventEmitter,this._onDidOpenRepository=new f.EventEmitter,this._onDidChangeState=new f.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=f.Disposable.from(de.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:o})=>{const a=this.getScmProvider(ce.getVirtualUri(o.uri));a!==void 0&&await this.updateStatusBarCommands(a,void 0)}),this.providerService.onDidSyncRepository(async({repository:o,syncing:a})=>{const s=this.getScmProvider(ce.getVirtualUri(o.uri));s!==void 0&&await this.updateStatusBarCommands(s,{syncing:a})}),this.providerService.onDidRefresh(o=>{for(const a of o)this.update(a)}),this.providerService.onDidChangeChangeStore(o=>this.update(o[0].rootUri)),...this.registerCommands());const i=this.providerService.repositories;this.onRepositoriesChanged({added:i,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=de.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){de.changed(e,"staging")&&(this._staging=void 0,de.changed(e,"staging.enabled")&&this.refresh()),de.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const n of e.added){const r=await this.update(n.uri,{reason:"added"});(r==null?void 0:r.repository)&&this._onDidOpenRepository.fire(r.repository)}if(e.removed.length)for(const n of e.removed){const r=this._scmProviders.findIndex(i=>N(i.sourceControl.rootUri)===N(n.uri));if(r!==-1){const i=this._scmProviders[r];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(r,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state))}registerCommands(){return[f.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(e)}),f.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),f.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(e,{empty:!1})}),f.commands.registerCommand("remoteHub.commitEmpty",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commitEmpty"),void this.commitChanges(e,{empty:!0})}),f.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(ip(e)){const a=e.resourceStates.filter(Ta);if(a.length!==0){if(await qu(a))for(const s of a)await this.providerService.getChangeStore(s.resourceUri).discard(s.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}let n=!1;e!==void 0&&"confirmDiscard"in e&&(n=!0,e=void 0);const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const i=await this.providerService.getChangeStore(r.rootUri).getChanges(r.rootUri);n||await qu(i)?await this.providerService.getChangeStore(r.rootUri).discardAll(r.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),f.commands.registerCommand("remoteHub.discardChanges",async(...e)=>{for(const n of e)!Ta(n)||(this.telemetryService.sendEvent("command.discardChanges"),await qu([n])?await this.providerService.getChangeStore(n.resourceUri).discard(n.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),f.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const n=this.getSourceControlFrom(e);(n==null?void 0:n.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.providerService.getChangeStore(n.rootUri).stageAll(n.rootUri))}),f.commands.registerCommand("remoteHub.stageChanges",async(...e)=>{for(const n of e)!Ta(n)||(this.telemetryService.sendEvent("command.stageChanges"),await this.providerService.getChangeStore(n.resourceUri).stage(n.resourceUri))}),f.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const n=this.getSourceControlFrom(e);if((n==null?void 0:n.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.providerService.getChangeStore(n.rootUri).unstageAll(n.rootUri)}),f.commands.registerCommand("remoteHub.unstageChanges",async(...e)=>{for(const n of e)!Ta(n)||(this.telemetryService.sendEvent("command.unstageChanges"),await this.providerService.getChangeStore(n.resourceUri).unstage(n.resourceUri))}),f.commands.registerCommand("remoteHub.keepChanges",async(...e)=>{for(const n of e)!Ta(n)||(this.telemetryService.sendEvent("command.keepChanges"),await this.providerService.getChangeStore(n.resourceUri).keep(n.resourceUri))}),f.commands.registerCommand("remoteHub.openChanges",e=>{var n;const{command:r}=e;if(!!r)return this.telemetryService.sendEvent("command.openChanges"),void f.commands.executeCommand(r.command,...(n=r.arguments)!=null?n:[])}),f.commands.registerCommand("remoteHub.openFile",async(...e)=>{var n;for(const r of e)if(Vu(r)){const i=r,o=this.providerService.getChangeStore(i.resourceUri).resolveOpenCommand(i.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:f.ViewColumn.Active});this.telemetryService.sendEvent("command.openFile"),await f.commands.executeCommand(o.command,...(n=o.arguments)!=null?n:[])}else if(r instanceof f.Uri){this.telemetryService.sendEvent("command.openFile");const i=r;await f.window.showTextDocument(i)}}),f.commands.registerCommand("remoteHub.createBranch",async e=>{await Of("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),f.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Aa(this._scmProviders,P("choose repo for create branch placeholder","Choose which repository to create a new branch on"),P("choose repo for create branch title","Create Branch"));if(r===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(r);if(i.accessLevel<$t.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),f.window.showErrorMessage(P("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,a=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const p=await oc.show(this.providerService,r,P("choose branch for create placeholder","Choose which branch to create the new branch from"),P("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!p){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=p.sha,a=Boolean(p.useIndex)}let s;try{s=await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>ac(this.providerService,r,o,P("create branch","Please provide a new branch name"),P("create branch placeholder","New branch name"),P("create branch title","Create Branch \u2022 {0}",i.name)))}catch(p){U.error(p),f.window.showErrorMessage(P("unable to create branch","Unable to create the new branch."));return}if(!s){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const c=await this.providerService.switchTo(r,{type:Me.Branch,id:s});if(!c)return;const l=await this.providerService.getChangeStore(r).createChangeset(r);l&&await this.openActionsService.setChangesetToApply(c.uri,l);const d=P("switch to branch prompt open","Switch to Branch"),h=P("switch to branch prompt open in new window","Open in New Window"),g=await f.window.showInformationMessage(P("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,s),{modal:!0},d,h);!g||(c.location=g===h?Ke.NewWindow:Ke.CurrentWindow,a&&await de.setMode(c.uri,Fr.getIndexDefault(Re.Branch)),await Mn(this.providerService,c,{skipChangesPrompt:!0}))}),f.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let n;const r=f.window.activeTextEditor;if((r==null?void 0:r.document.languageId)!=="diff"){const i=await f.window.showOpenDialog({openLabel:P("open patch","Open Patch"),title:P("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;n=Uw.decode(await f.workspace.fs.readFile(i[0]))}else n=r.document.getText();try{await this.providerService.getChangeStore(e.rootUri).applyPatch(e.rootUri,n)}catch{f.window.showErrorMessage(P("invalid patch file","Invalid patch file"))}}),f.commands.registerCommand("remoteHub.exportPatch",async(...e)=>{const n=Array.isArray(e)?e:[e];for(const r of n){const i=this.getSourceControlFrom(r);if((i==null?void 0:i.rootUri)===void 0)return;let o;Vu(r)&&(o=r.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const a=await this.providerService.getChangeStore(i.rootUri).createPatch(i.rootUri,o),s=await f.workspace.openTextDocument({language:"diff",content:a});await f.window.showTextDocument(s)}}),f.commands.registerCommand("remoteHub.switchToBranch",async e=>{var n,r;const i=(n=e==null?void 0:e.uri)!=null?n:await Aa(this._scmProviders,P("choose repo for switch branch placeholder","Choose which repository to switch branches on"),P("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],a=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(a.accessLevel>=$t.Write&&o.push(new kr(Nn({command:"remoteHub.createBranch",title:P("create branch command.v2","{0} Create New Branch...","$(add)"),arguments:[{uri:i}]})),new kr(Nn({command:"remoteHub.createBranchFrom",title:P("create branch from command.v2","{0} Create New Branch from...","$(add)"),arguments:[{uri:i}]}))),a.HEAD.type){case ye.Branch:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:P("open branch on remote command.v2","{0} Open Branch on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.branch.name}]})));break;case ye.RemoteBranch:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:P("open remote branch on remote command.v2","{0} Open Remote Branch on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.HEAD.branch.remote.repo,branch:a.HEAD.branch.name}]})));break;case ye.Tag:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:P("open tag on remote command.v2","{0} Open Tag on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,tag:a.HEAD.detached.name}]})));break;case ye.Commit:o.push(new kr(Nn({command:"remoteHub.openOnRemote",title:P("open commit on remote command.v2","{0} Open Commit on {1}...","$(globe)",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,sha:a.HEAD.sha}]})));break}const s=(r=a.HEAD.branch)==null?void 0:r.name,c=Boolean(s&&!await this.providerService.getChangeStore(i).hasChanges(i)),l=await oc.show(this.providerService,i,P("choose switch branch placeholder","Choose which branch to switch to"),P("choose switch branch title","Switch to Branch or Tag \u2022 {0}",a.name),o,{allowResetToSha:c,filterBranches:s?d=>d.name!==s:void 0,ignoreFocusOut:!1});if(!l){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return l instanceof kr?void l.execute():c&&l.type===Me.Branch&&l.name===s&&l.sha?f.window.withProgress({location:f.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,{to:l.sha})}catch(d){U.error(d),f.window.showErrorMessage(P("reset failed","Unable to reset the repository to commit '{0}'.",Fe(l.sha)))}}):void f.window.withProgress({location:f.ProgressLocation.SourceControl},async()=>{const d=await this.providerService.switchTo(i,l.name?{type:l.type,id:l.name}:void 0);if(d!==void 0){if(l.useIndex){const h=await this.providerService.getModeRefType(d.uri);await de.setMode(d.uri,Fr.getIndexDefault(h))}return Mn(this.providerService,d)}})}),f.commands.registerCommand("remoteHub.fetch",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Aa(this._scmProviders,P("choose repo for fetch placeholder","Choose which repository to fetch"),P("choose repo for fetch title","Fetch Repository"));if(r!==void 0){this.telemetryService.sendEvent("command.fetch");try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.providerService.fetch(r,{force:!0}))}catch(i){f.window.showErrorMessage(P("fetch failed","Unable to fetch repository"))}}}),f.commands.registerCommand("remoteHub.fetchAll",async e=>{const n=this.providerService.repositories;if(n.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await f.window.withProgress({location:f.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of n)try{await this.providerService.fetch(o.uri)}catch(a){i.push(a)}return i})).length&&!(e==null?void 0:e.automated)&&f.window.showErrorMessage(n.length?P("fetch all failed","Unable to fetch repositories"):P("fetch failed","Unable to fetch repository"))}),f.commands.registerCommand("remoteHub.pull",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Aa(this._scmProviders,P("choose repo for pull placeholder","Choose which repository to pull"),P("choose repo for pull title","Pull Repository"));if(r!==void 0){this.telemetryService.sendEvent("command.pull");try{await this.sync(r,{pull:!0})}catch{}}}),f.commands.registerCommand("remoteHub.sync",async e=>{var n;const r=(n=e==null?void 0:e.uri)!=null?n:await Aa(this._scmProviders,P("choose repo for sync placeholder","Choose which repository to sync"),P("choose repo for sync title","Synchronize Repository"));if(r!==void 0){this.telemetryService.sendEvent("command.sync");try{await this.sync(r)}catch{}}}),f.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.sendEvent("command.disableCommitDirectlyWarning"),de.updateEffective("commitDirectlyWarning",Pr.Off)})]}async sync(e,{pull:n,...r}={pull:!1}){this.telemetryService.sendEvent("sync");try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.providerService.sync(e,r))}catch(i){if(nt.asVirtualProviderErrorCode(i)===Qe.SyncConflictsError){const o={title:P("sync confirm","Continue")},a={title:P("sync cancel","Cancel"),isCloseAffordance:!0};await f.window.showWarningMessage(n?P("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):P("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0},o,a)===o?await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.providerService.sync(e,{conflictResolution:ei.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else if(nt.asVirtualProviderErrorCode(i)===Qe.UnresolvedConflictsError)await f.window.showErrorMessage(n?P("pull with unresolved merge conflicts","You must resolve any pending conflicts before pulling."):P("sync with unresolved merge conflicts","You must resolve any pending conflicts before syncing."),{modal:!0});else throw U.error(i),this.telemetryService.sendException(i),f.window.showErrorMessage(P("sync failed","Unable to sync the repository.")),i}}async commitChanges(e,n){try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.commitChangesCore(e,n))}catch(r){if(nt.asVirtualProviderErrorCode(r)===Qe.NothingToCommitError){f.window.showInformationMessage(P("no changes to commit","There are no changes to commit."));return}U.error(r),f.window.showErrorMessage(P("commit unable","Unable to commit.")),this.telemetryService.sendException(r)}}async commitChangesCore(e,n){const r=e.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const i=new Pe(`VirtualSourceControl.commitChanges(${r.toString()})`);let o;try{const a=await this.providerService.getMetadata(r);let s,c;const l=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const h=e.inputBox.value;if(await this.providerService.getChangeStore(r).hasMergeConflicts(r)){e.inputBox.showValidationMessage(P("commit resolve conflicts","You must resolve any pending conflicts before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"}),o=": Aborted; Unresolved conflicts";return}const g=await this.providerService.getCommitOperations(r,{staged:l});if(g.length===0&&!n.empty){e.inputBox.showValidationMessage(this.staging.enabled?P("commit no staged changes","There are no staged changes to commit."):P("commit no changes","There are no changes to commit."),f.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),o=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!h){e.inputBox.showValidationMessage(P("specify commit message","You must specify a commit message before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"}),o=": Aborted; No message";return}let p,y;if(a.HEAD.type===ye.RemoteBranch?(y=a.HEAD.branch.remote.accessLevel<$t.Write,p=y&&a.accessLevel<$t.Write):(p=a.accessLevel<$t.Write,y=p),c===void 0&&p&&(c=await this.providerService.getFork(r),c===void 0)){const v={title:P("fork confirm","Fork Repository")},m={title:P("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showInformationMessage(P("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0},v,m)!==v){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"}),o=": Aborted; Abandoned fork prompt";return}if(c=await f.window.withProgress({location:f.ProgressLocation.Notification,title:P("fork progress","Forking {0}...",a.name)},()=>this.providerService.fork(r)),c===void 0){f.window.showErrorMessage(P("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"}),o=": Aborted; Fork failed";return}}if(c||y){if(c===void 0){const m={title:P("remote branch create branch prompt confirm","Commit to New Branch")},C={title:P("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showErrorMessage(P("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0},m,C)!==m){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned remote branch prompt"}),o=": Aborted; Abandoned commit to new branch prompt";return}}let v=0;try{const m=await this.providerService.getBranches(c?this.providerService.createVirtualUri(r,c):r,{query:"patch-"});for(const C of m.branches){const w=/^patch-(?<num>\d+)$/.exec(C.name);if(w==null?void 0:w.groups){const _=Number(w.groups.num);_>v&&(v=_)}}}catch{}if(s=await ac(this.providerService,r,a.HEAD.sha,P("create new branch prompt","Create a new branch to commit your changes to"),P("create new branch placeholder","New branch name"),P("create new branch title","Commit \u2022 Create Branch \u2022 {0}",c?c.name:a.name),c,`patch-${v+1}`),!s){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned create branch prompt"}),o=": Aborted; Abandoned create branch prompt";return}}try{await this.providerService.createAndPushCommit(r,h,g,s,n,c)}catch(v){const m=nt.asVirtualProviderErrorCode(v);if(m===Qe.DetachedHEADError){const C={title:P("detached head prompt confirm","Commit to New Branch")},w={title:P("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showErrorMessage(P("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},C,w)!==C){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"}),o=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(s=await ac(this.providerService,r,a.HEAD.sha,P("create new branch prompt","Create a new branch to commit your changes to"),P("create new branch placeholder","New branch name"),P("create new branch title","Commit \u2022 Create Branch \u2022 {0}",c?c.name:a.name),c),!s){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head create branch prompt"}),o=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if(m===Qe.MergeConflictError){const C={title:P("push conflicts prompt pull","Pull")},w={title:P("push conflicts prompt sync","Sync (Pull & Push)")},_={title:P("cancel","Cancel"),isCloseAffordance:!0},E=await f.window.showErrorMessage(P("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},C,w,_);if(E!==C&&E!==w){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"}),o=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(r,{pull:E===C,conflictResolution:ei.Merge}),E===C){o=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw U.error(v),o=`: Aborted; ${String(v)}`,v}break}if(e.inputBox.value="",c?await this.providerService.getChangeStore(r).discardAll(r,{staged:l}):await this.providerService.getChangeStore(r).acceptAll(r,{staged:l}),Gu(Di.HasCommitted,!0),!c&&!s)return;async function d(){if(c){const y={title:P("commit to fork confirm","Switch to Fork")},v={title:P("cancel","Cancel"),isCloseAffordance:!0},m=await f.window.showInformationMessage(P("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",a.name),{modal:!0},y,v);if(this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(m===y)}),m===y){let C;s!==void 0?C={type:Me.Branch,id:s}:a.HEAD.branch!==void 0&&(C={type:Me.Branch,id:a.HEAD.branch.name}),Mn(this.providerService,{name:c.name,uri:this.providerService.createVirtualUri(r,{repo:c.repo,ref:C}),location:Ke.CurrentWindow})}return}const h={title:P("commit to new branch confirm","Switch to Branch")},g={title:P("cancel","Cancel"),isCloseAffordance:!0},p=await f.window.showInformationMessage(P("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",s),{modal:!0},h,g);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(p===h)}),p===h&&Mn(this.providerService,{name:a.name,uri:this.providerService.createVirtualUri(r,{repo:a.repo,ref:s?{type:Me.Branch,id:s}:void 0}),location:Ke.CurrentWindow})}u(d,"showSwitchToPrompt"),d.call(this)}finally{i.stop(o?{message:o}:void 0)}}async createPullRequest(e,n){try{await f.window.withProgress({location:f.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,n))}catch(r){const i=nt.asVirtualProviderErrorCode(r);if(i===Qe.NothingToCommitError){f.window.showInformationMessage(P("no changes to commit","There are no changes to commit."));return}if(i===Qe.CommitFailedError){f.window.showErrorMessage(P("commit unable","Unable to commit."));return}U.error(r),f.window.showErrorMessage(P("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(r)}}async createPullRequestCore(e,n){var r;const i=e.rootUri,o=(r=n==null?void 0:n.draft)!=null?r:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(o),staging:String(this.staging.enabled)});const a=new Pe(`VirtualSourceControl.createPullRequest(${i.toString()})`);let s;try{let c=u(function(){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"}),s=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),l;const d=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(n==null?void 0:n.sha)){if(await this.providerService.getChangeStore(i).hasMergeConflicts(i)){e.inputBox.showValidationMessage(P("commit resolve conflicts","You must resolve any pending conflicts before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted conflicts"}),s=": Aborted; Unresolved conflicts";return}if(l=await this.providerService.getCommitOperations(i,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),l.length===0){e.inputBox.showValidationMessage(this.staging.enabled?P("commit no staged changes","There are no staged changes to commit."):P("commit no changes","There are no changes to commit."),f.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),s=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const h=e.inputBox.value;if(!h){e.inputBox.showValidationMessage(P("specify commit message","You must specify a commit message before committing."),f.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"}),s=": Aborted; No message";return}const g=await this.providerService.getMetadata(i);let p,y;g.HEAD.type===ye.RemoteBranch?(y=g.HEAD.branch.remote.accessLevel<$t.Write,p=y&&g.accessLevel<$t.Write):(p=g.accessLevel<$t.Write,y=p);let v=n==null?void 0:n.fork;if(v===void 0&&p&&(v=await this.providerService.getFork(i),v===void 0)){const x={title:P("fork confirm","Fork Repository")},T={title:P("cancel","Cancel"),isCloseAffordance:!0};if(await f.window.showInformationMessage(P("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0},x,T)!==x){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"}),s=": Aborted; Abandoned fork prompt";return}if(v=await f.window.withProgress({location:f.ProgressLocation.Notification,title:P("fork progress","Forking {0}...",g.name)},()=>this.providerService.fork(i)),v===void 0){f.window.showErrorMessage(P("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"}),s=": Aborted; Fork failed";return}}const m=await f.window.showInputBox({ignoreFocusOut:!0,placeHolder:P("create pr placeholder","Pull request title"),prompt:P("create pr prompt","Enter a title for the new pull request"),title:P("create pr title","New Pull Request"),value:h});if(!m){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"}),s=": Aborted; Abandoned title prompt";return}async function C(x){let T=0;try{const W=await this.providerService.getBranches(v?this.providerService.createVirtualUri(i,v):i,{query:"patch-"});for(const F of W.branches){const G=/^patch-(?<num>\d+)$/.exec(F.name);if(G==null?void 0:G.groups){const Z=Number(G.groups.num);Z>T&&(T=Z)}}}catch{}return ac(this.providerService,i,x,P("create pr branch prompt","Create a new branch for this pull request"),P("create pr branch placeholder","New branch name"),P("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",v?v.name:g.name),v,`patch-${T+1}`)}u(C,"createBranch");const w=await C.call(this,g.HEAD.sha);if(!w){c.call(this);return}(l==null?void 0:l.length)&&await this.providerService.createAndPushCommit(i,h,l,w,void 0,v);const _=await this.providerService.createPullRequest(i,w,m,{draft:o},v);e.inputBox.value="",(l==null?void 0:l.length)&&(v?await this.providerService.getChangeStore(i).discardAll(i,{staged:d}):await this.providerService.getChangeStore(i).acceptAll(i,{staged:d}));async function E(){const x={title:P("created pr notification confirm","Switch to Pull Request")},T={title:P("cancel","Cancel"),isCloseAffordance:!0},W=await f.window.showInformationMessage(P("created pr notification","Created pull request #{0} in {1}. Do you want to switch to the new pull request?",_.id,g.name),{modal:!0},x,T);this.telemetryService.sendEvent("createPullRequest.switchToPullRequest",{confirm:String(W===x)}),W===x&&Mn(this.providerService,{name:g.name,uri:this.providerService.createVirtualUri(i,{repo:g.repo,ref:{type:Me.PullRequest,id:_.id}}),location:Ke.CurrentWindow})}u(E,"showSwitchToPrompt"),E.call(this)}finally{a.stop(s?{message:s}:void 0)}}async update(e,n){const r=f.workspace.getWorkspaceFolder(e);if(r===void 0)return;const i=await this.createOrUpdateScmProvider(e,r.name,n),o=await this.providerService.getChangeStore(e).getGroupedChanges(e,{predicate:l=>l.fileType===f.FileType.File}),a=await Promise.all(o.conflicts.map(async l=>({type:l.type,resourceUri:l.uri,command:await this.providerService.getChangeStore(l.uri).resolveDiffCommand(l.uri,l.conflicts.incomingUri,P("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",tt(l.uri)))}))),s=await Promise.all(o.staged.map(async l=>({type:l.type,resourceUri:l.uri,command:await this.providerService.getChangeStore(l.uri).resolveDiffCommand(l.uri,ce.getProviderUri(l.uri),P("diff title index","{0} (Index)",tt(l.uri)))}))),c=await Promise.all(o.working.map(async l=>({type:l.type,resourceUri:l.uri,decorations:{strikeThrough:l.type===D.Deleted},command:await this.providerService.getChangeStore(l.uri).resolveDiffCommand(l.uri,ce.getProviderUri(l.uri),P("diff title working","{0} (Working Tree)",tt(l.uri)))})));return this.ensureMergeConflictsGroup(i).resourceStates=a,this.ensureStagedChangesGroup(i).resourceStates=this.staging.enabled?s:[],this.ensureWorkingChangesGroup(i).resourceStates=this.staging.enabled?c:[...s,...c],i}async createOrUpdateScmProvider(e,n,r){const i=await this.providerService.getMetadata(e,{forceNew:(r==null?void 0:r.reason)==="added"});let o;const a=i.HEAD.branch?i.HEAD.name:void 0;let s=this.getScmProvider(e);if(s===void 0){n=i.name,o=f.scm.createSourceControl(`remoteHub:${i.provider.id}`,n,e),o.quickDiffProvider={provideOriginalResource:l=>ce.getProviderUri(l)};const c=this.providerService.createIGitRepository(e,o,i);s={id:i.provider.id,name:i.provider.name,sourceControl:o,groups:[],repository:c},this.ensureMergeConflictsGroup(s),this.ensureStagedChangesGroup(s),this.ensureWorkingChangesGroup(s),this._scmProviders.push(s)}else o=s.sourceControl;return i.accessLevel>=$t.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:P("scm input accept command title commit","Commit"),arguments:[o]},a?o.inputBox.placeholder=P("scm input placeholder commit","Message (Ctrl+Enter to commit and push to '{0}' on {1})",a,i.provider.name):o.inputBox.placeholder=P("scm input placeholder commit","Message (Ctrl+Enter to commit and push to {0})",i.provider.name),de.get("commitDirectlyWarning")===Pr.Off?o.inputBox.validateInput=void 0:o.inputBox.validateInput=c=>{if(de.get("commitDirectlyWarning")===Pr.Auto&&vp(Di.HasCommitted))return;const l=new f.MarkdownString(a?P("scm input validation commit branch directly","Your changes will be committed and immediately pushed to the '{0}' branch on {1}.",a,i.provider.name):P("scm input validation commit directly","Your changes will be committed and immediately pushed to {0}.",i.provider.name));return l.isTrusted=!0,l.appendMarkdown(`&nbsp; [${P("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${P("scm input validation action tip","Hide")}')`),{message:l,type:f.SourceControlInputBoxValidationType.Information}}):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:P("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=P("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}')",n)),await this.updateStatusBarCommands(s,{syncing:!1},i),s}async updateStatusBarCommands(e,n,r){var i,o,a;const s=e.sourceControl.rootUri;r=r!=null?r:await this.providerService.getMetadata(s);const{HEAD:c}=r,l=await this.providerService.getIndexMetadata(s),d=(l==null?void 0:l.type)===De.Active,h=(l==null?void 0:l.type)===De.Active,g=De.hasIndex(l==null?void 0:l.type),p=await this.providerService.getChangeStore(s).hasChanges(s),y=$s(c.type),v=[];if(v.push(Nn({command:"remoteHub.switchToBranch",title:`${y} ${c.name}${p?"*":""}`,tooltip:`${Fe(c.sha)}`,arguments:[{uri:s,commands:!0}]})),c.detached||((n==null?void 0:n.syncing)?v.push(Nn({command:"",title:"$(sync~spin)",tooltip:P("sync command syncing","Syncing Changes..."),arguments:[]})):v.push(Nn({command:"remoteHub.sync",title:`$(sync)${((o=(i=r.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(a=r.state)==null?void 0:a.behind}\u2193`:""}`,tooltip:d||h?P("sync index","Sync to latest indexed commit"):P("sync command","Sync (Pull & Push)"),arguments:[{uri:s}]}))),r.pullRequest&&v.push(Nn({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${r.pullRequest.id}`,tooltip:P("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,r.pullRequest.id,r.provider.name,r.pullRequest.title),arguments:[{provider:r.provider,repo:r.repo,pullRequest:{id:r.pullRequest.id}}]})),g){const m=this.providerService.getIndexProvider(s);m&&v.push(...await m.getStatusBarContributions(s))}e.sourceControl.statusBarCommands=v}ensureMergeConflictsGroup(e){const n="conflicts";let r=e.groups.find(i=>i.id===n);return r===void 0&&(r=e.sourceControl.createResourceGroup(n,P("scm group conflicts","Merge Conflicts")),r.hideWhenEmpty=!0,e.groups.push(r)),r}ensureStagedChangesGroup(e){const n="staged";let r=e.groups.find(i=>i.id===n);return r===void 0&&(r=e.sourceControl.createResourceGroup(n,P("scm group staged","Staged Changes")),r.hideWhenEmpty=!0,e.groups.push(r)),r}ensureWorkingChangesGroup(e){const n="changes";let r=e.groups.find(i=>i.id===n);return r===void 0&&(r=e.sourceControl.createResourceGroup(n,P("scm group changes","Changes")),e.groups.push(r)),r}getScmProvider(e){const n=N(e);return this._scmProviders.find(r=>N(r.sourceControl.rootUri)===n)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let n;if(Ow(e))n=e;else if(ip(e)){const r=e,i=this._scmProviders.find(o=>o.groups.includes(r));n=i==null?void 0:i.sourceControl}else if(Vu(e)){const r=e,i=this._scmProviders.find(o=>o.groups.some(a=>a.resourceStates.includes(r)));n=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;n=this._scmProviders[0].sourceControl}return n}}u(rp,"VirtualSourceControl");function Ow(t){return"rootUri"in t&&"inputBox"in t}u(Ow,"isSourceControl");function ip(t){return t!==void 0&&"id"in t&&"label"in t&&"resourceStates"in t&&Array.isArray(t.resourceStates)}u(ip,"isSourceControlResourceGroup");function Vu(t){return t!==void 0&&"resourceUri"in t&&t.resourceUri instanceof f.Uri}u(Vu,"isSourceControlResourceState");function Ta(t){return"type"in t}u(Ta,"isTrackedChange");async function qu(t){var e,n,r;if(t.length===0)return!0;let i,o=P("discard","Discard Changes");if(t.length===1){const s=t[0];s.type===D.Created?(i=P("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,tt((e=s.resourceUri)!=null?e:s.uri)),o=P("delete file","Delete file")):s.type===D.Deleted?(o=P("restore file","Restore file"),i=P("confirm restore","Are you sure you want to restore {0}?",tt((n=s.resourceUri)!=null?n:s.uri))):i=P("confirm discard","Are you sure you want to discard changes in {0}?",tt((r=s.resourceUri)!=null?r:s.uri))}else t.every(s=>s.type===D.Created)?i=P("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,t.length):t.every(s=>s.type===D.Deleted)?(o=P("restore files","Restore files"),i=P("confirm restore multiple","Are you sure you want to restore {0} files?",t.length)):i=P("confirm discard multiple","Are you sure you want to discard changes in {0} files?",t.length);return await f.window.showWarningMessage(i,{modal:!0},o)===o}u(qu,"confirmDiscard");async function Aa(t,e,n){if(t.length===0)return;if(t.length===1)return t[0].sourceControl.rootUri;const r=await f.window.showQuickPick(t.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:n});if(!!r)return r.uri}u(Aa,"getOrPickRootUri");async function ac(t,e,n,r,i,o,a,s){const c=new Set;let l;const d=f.window.createInputBox();d.ignoreFocusOut=!0;try{return await new Promise((h,g)=>{l=f.Disposable.from(d.onDidHide(()=>h(void 0)),d.onDidChangeValue(p=>{if(p=p.trim(),!p){d.validationMessage=P("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(c.has(p)){d.validationMessage=P("scm create branch prompt validation already exists","Branch '{0}' already exists",p);return}if(!On(p)){d.validationMessage=P("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",p);return}d.validationMessage=void 0}),d.onDidAccept(async()=>{const p=d.value;try{d.enabled=!1,d.busy=!0;const y=await t.createBranch(e,p,n,a);h(y)}catch(y){if(nt.asVirtualProviderErrorCode(y)===Qe.InvalidBranchNameError){d.enabled=!0,d.busy=!1,d.validationMessage=y.message,c.add(p);return}g(y)}})),d.prompt=r,d.placeholder=i,d.title=o,s&&(d.value=s),d.show()})}finally{d.dispose(),l==null||l.dispose()}}u(ac,"createBranchWithPrompt");const ut=J.loadMessageBundle();class tr extends f.TimelineItem{static is(e){return e instanceof tr}constructor(e,n,r,i,{dateType:o,showAuthor:a,dateFormatter:s}){var c;const l=r.message.indexOf(`
`),d=l!==-1?`${r.message.substring(0,l)} \u2026`:r.message,h=o==="authored"?r.authorDate:r.commitDate;super(d,(c=h==null?void 0:h.getTime())!=null?c:0);this.id=r.hash,this.contextValue=`${ce.scheme}:${n}:file:commit`,this.command=i,a&&(this.description=r.authorName),this.tooltip=ut("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,r.authorName,r.authorEmail,Fe(r.hash),s.format(h),r.message),this.iconPath=new f.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=n,this.hash=r.hash,this.parents=r.parents,this.message=r.message}}u(tr,"CommitTimelineItem");class Ri extends f.TimelineItem{static is(e){return e instanceof Ri}constructor(e,n,r,i,o,{dateFormatter:a}){const s=ut("timeline staged changes","Staged Changes");super(s,r.timestamp);this.id="index",this.contextValue=`${ce.scheme}:${n}:file:${this.id}`,this.command=o,this.iconPath=new f.ThemeIcon("git-commit"),this.tooltip=ut("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,ut("timeline you","You"),ut("timeline index","Index"),a.format(new Date(r.timestamp)),Mw(r.type)),this.rootUri=e,this.providerId=n,this.hash="~",this.parents=i,this.message=s}}u(Ri,"ChangeOperationTimelineItem");class op{constructor(e){this.providerService=e,this._onDidChange=new f.EventEmitter,this.id="github-file-history",this.label=ut("timeline.source","GitHub File History"),this.debouncer=new $u(500),this.disposable=f.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),e.onDidChangeChangeStore(this.onUrisChanged,this),de.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const n=N(this.rootUri);!e.some(r=>N(r)===n)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const n=N(this.rootUri);(e.added.some(r=>N(r.uri)===n)||e.removed.some(r=>N(r.uri)===n))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||N(this.rootUri)!==N(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const n=N(this.rootUri);e.some(r=>N(r.rootUri)===n)&&this.fireChanged()}async provideTimeline(e,n,r){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const y of this.providerService.repositories)if(y.uri.path===this.rootUri.path){this.rootUri=y.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),a=await this.providerService.getMetadata(this.rootUri);if(!a||r.isCancellationRequested)return{items:[]};const s=await this.providerService.getCommits(this.rootUri,{ref:a.HEAD.sha,path:o||void 0,cursor:n.cursor,limit:typeof n.limit=="number"?n.limit:void 0});if(s===void 0||s.commits.length===0||r.isCancellationRequested)return{items:[]};const c=((i=s.paging)==null?void 0:i.more)?{cursor:s.paging.cursor}:void 0,l=new Intl.DateTimeFormat(f.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),d=de.getAny("git.timeline.date",void 0,"committed"),h=de.getAny("git.timeline.showAuthor",void 0,!0),g=await Promise.all(s.commits.map(async y=>new tr(this.rootUri,a.provider.id,y,await this.resolveDiffCommand(y,a,e,o),{dateType:d,showAuthor:h,dateFormatter:l}))),p=n.cursor===void 0?await this.providerService.changeStoreGetChange(e):void 0;if(p&&Boolean(p.staged&&de.get("staging.enabled"))){const v=new Ri(this.rootUri,a.provider.id,p,[s.commits[0].hash],await this.providerService.changeStoreResolveDiffCommand(p.uri,ce.getProviderUri(p.uri),ut("diff title index","{0} (Index)",tt(p.uri))),{dateFormatter:l});g.splice(0,0,v)}return{items:g,paging:c}}catch(o){return U.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=f.workspace.registerTimelineProvider([Wt.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[f.commands.registerCommand("remoteHub.timeline.copyCommitId",(n,r,i)=>{!tr.is(n)||f.env.clipboard.writeText(n.hash)}),f.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(n,r,i)=>{!tr.is(n)||f.env.clipboard.writeText(n.message)}),f.commands.registerCommand("remoteHub.timeline.openDiff",async(n,r,i)=>{var o;!tr.is(n)&&!Ri.is(n)||n.command!==void 0&&await f.commands.executeCommand(n.command.command,...(o=n.command.arguments)!=null?o:[])}),f.commands.registerCommand("remoteHub.timeline.openOnGitHub",async n=>{await this.openOnRemote(n)}),f.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async n=>{await this.openOnRemote(n)}),f.commands.registerCommand("remoteHub.timeline.selectForCompare",async(n,r,i)=>{!r||!tr.is(n)&&!Ri.is(n)||(e={uri:r,left:n},await f.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),f.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(n,r,i)=>{if(!r||!e||!tr.is(n)&&!Ri.is(n)||N(r)!==N(e.uri))return;const{left:o}=e,a=this.providerService.getRelativeFilePath(n.rootUri,r),s=await this.providerService.getMetadata(n.rootUri),c=tt(r),l=o.parents[0];let d;l===void 0?d=ut("timeline diff title ref","{0} ({1})",c,Fe(n.hash)):o.hash===""?d=ut("timeline diff title working","{0} (Working Tree)",c):o.hash==="~"?d=ut("timeline diff title index","{0} (Index)",c):d=ut("timeline diff title ref","{0} ({1})",c,Fe(o.hash));let h=o.hash===""||o.hash==="~"?r:this.providerService.createProviderUri(r,{repo:s.repo,ref:{type:Me.Commit,id:l!=null?l:"0000000000000000000000000000000000000000"}},a);l===void 0&&(h=h.with({query:"~"}));const g=n.parents[0];let p;g===void 0?p=ut("timeline diff title ref","{0} ({1})",c,Fe(n.hash)):g==="~"&&n.hash===""?p=ut("timeline diff title working","{0} (Working Tree)",c):n.hash==="~"?p=ut("timeline diff title index","{0} (Index)",c):p=ut("timeline diff title ref","{0} ({1})",c,Fe(n.hash));const y=ut("timeline diff title","{0} \u27F7 {1}",d,p),v=n.hash===""||n.hash==="~"?r:this.providerService.createProviderUri(r,{repo:s.repo,ref:{type:Me.Commit,id:n.hash}},a);await f.commands.executeCommand("vscode.diff",h,v,y)})]}async resolveDiffCommand(e,n,r,i,o){const a=tt(r);let s=e.parents[0],c=this.providerService.createProviderUri(r,{repo:n.repo,ref:{type:Me.Commit,id:s!=null?s:"0000000000000000000000000000000000000000"}},i);try{await this.providerService.stat(c)}catch(h){s=void 0}let l;s===void 0?l=ut("timeline diff title ref","{0} ({1})",a,Fe(e.hash)):e.hash===""?l=ut("timeline diff title working","{0} (Working Tree)",a):e.hash==="~"?l=ut("timeline diff title index","{0} (Index)",a):l=ut("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",a,Fe(s),Fe(e.hash)),s===void 0&&(c=c.with({query:"~"}));const d=e.hash===""||e.hash==="~"?r:this.providerService.createProviderUri(r,{repo:n.repo,ref:{type:Me.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[c,d,l,o]}}async openOnRemote(e){if(!tr.is(e))return;const n=await this.providerService.getMetadata(e.rootUri);await Of("remoteHub.openOnRemote",{provider:n.provider,repo:n.repo,sha:e.hash})}}u(op,"VirtualTimelineProvider");class ap{constructor(e,n){this.providerService=e,this.telemetryService=n,this.disposable=f.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var n;const r=new Pe(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);try{switch(e.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let i,o;for(const s of e.query.split("&")){const[c,l]=s.split("=");switch(c){case"url":i=decodeURIComponent(l);break;case"location":o=l===Ke.CurrentWindow?Ke.CurrentWindow:Ke.NewWindow;break}}if(!i){r.log({message:": Unable to find url parameter"}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:Ke.NewWindow;const a=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!a){r.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}r.log({message:`: Opening ${i} in ${o}`}),Mn(this.providerService,a);break}case"/open-files":{let i;for(const a of e.query.split("&")){const[s,c]=a.split("=");if(s==="url"){i=decodeURIComponent(c);break}}if(!i){r.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){r.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(r.log({message:`: Opening files/folders for ${i}`}),await((n=lc())==null?void 0:n.openPendingFiles(o.uri,o.filesToOpen))):r.log({message:`: No files/folders found to open for ${i}`});break}default:{r.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{r.stop()}}}u(ap,"RemoteUriHandler");var Hw=Object.defineProperty,Ww=Object.getOwnPropertyDescriptor,Bw=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Ww(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Hw(e,n,i),i},"view_decorateClass"),Po;(function(t){t.Change="remoteHub:viewItem:change",t.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",t.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",t.Message="remoteHub:viewItem:message"})(Po||(Po={}));const sp=u(class{constructor(t,e){this.view=t,this.parent=e,this.splatted=!1}static is(t){return t instanceof sp}get id(){}toString(){return`${U.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var t,e;return((t=this.parent)==null?void 0:t.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(t=!1,e=!1,n){return this.splatted&&this.parent!==void 0&&this.parent!==n?this.parent.triggerChange(t,e):this.view.refreshNode(this,t,e)}},"_ViewNode");let Fo=sp;Bw([br((t=!1,e=!1,n)=>JSON.stringify([t,e,n==null?void 0:n.toString()]))],Fo.prototype,"triggerChange",1);class cp{constructor(e,n,r,i){this.id=e,this.name=n,this.providerService=r,this.telemetryService=i,this._onDidChangeTreeData=new f.EventEmitter,this.disposables=[];const o=!1;if(U.isDebugging&&o){const a=this.getTreeItem;this.getTreeItem=async function(s){var c;const l=await a.apply(this,[s]),d=s.getParent();return l.tooltip===void 0&&(l.tooltip=new f.MarkdownString(l.label!==void 0&&typeof l.label!="string"?l.label.label:(c=l.label)!=null?c:"")),typeof l.tooltip=="string"?l.tooltip=`${l.tooltip}

---
context: ${l.contextValue}
node: ${s.toString()}${d!==void 0?`
parent: ${d.toString()}`:""}`:l.tooltip.appendMarkdown(`

---

context: \`${l.contextValue}\`\\
node: \`${s.toString()}\`${d!==void 0?`\\
parent: \`${d.toString()}\``:""}`),l}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!de.changed(e,`views.${this.configKey}`)}dispose(){f.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=f.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(de.onDidChange(n=>{!this.filterConfigurationChanged(n)||(this._config=void 0,this.onConfigurationChanged(n))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}async getChildren(e){return e!==void 0?e.getChildren():(await Qt(this.providerService,void 0),this.ensureRoot().getChildren())}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:[...this.tree.selection]}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var n,r;await((r=(n=this.root)==null?void 0:n.refresh)==null?void 0:r.call(n,e)),this.triggerNodeChange()}async refreshNode(e,n=!1,r=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,n));!r&&o===!0||this.triggerNodeChange(e)}async reveal(e,n){if(this.tree!==void 0)try{await this.tree.reveal(e,n)}catch(r){U.error(r)}}async show(){try{await f.commands.executeCommand(`${this.id}.focus`)}catch(e){U.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=de.get("views")[this.configKey]),this._config}}u(cp,"View");class lp extends Fo{constructor(e,n,r,i,o,a,s){super(e,n);this._message=r,this._description=i,this._tooltip=o,this._iconPath=a,this._contextValue=s}getChildren(){return[]}getTreeItem(){var e;const n=new f.TreeItem(this._message,f.TreeItemCollapsibleState.None);return n.contextValue=(e=this._contextValue)!=null?e:Po.Message,n.description=this._description,n.tooltip=this._tooltip,n.iconPath=this._iconPath,n}}u(lp,"MessageNode");var $w=Object.defineProperty,Vw=Object.getOwnPropertyDescriptor,zu=u((t,e,n,r)=>{for(var i=r>1?void 0:r?Vw(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&$w(e,n,i),i},"workspaceRepositoriesView_decorateClass");const vt=J.loadMessageBundle(),up=u(class extends Fo{constructor(t,e,n,r,i,o,a){super(t,e);this.changeStore=n,this.canonical=r,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=a}static getId(t,e,n){return`${Pa.getId(t,e)}:${this.key}(${n.uri.toString()})`}get id(){return up.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const t=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new f.TreeItem(t,f.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${Po.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.providerService.getChangeStore(this.operation.uri).getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(t,!0),e}async getDiffCommand(t,e=!1){if(e||this._command===void 0){const n=Boolean(this.operation.staged&&de.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const r=ce.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,r,n?vt("diff title index","{0} (Index)",tt(this.operation.uri),this.workspaceRepository.ref.name):vt("diff title working","{0} (Working Tree)",tt(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:r}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:r,ref:{type:Me.Commit,id:this.operation.revision}},t);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,n?vt("diff title changeset index","{0} (Index of {1})",tt(this.operation.uri),this.workspaceRepository.ref.name):vt("diff title changeset working","{0} (Working Tree of {1})",tt(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var t;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await f.commands.executeCommand(e.command,...(t=e.arguments)!=null?t:[])}async openFile(){const t=this.view.providerService.getChangeStore(this.operation.uri).getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await f.window.showTextDocument(t)}async applyChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.providerService.getChangeStore(t.uri).applyChangeset(t.uri,this.workspaceRepository,this.operation)}catch(e){f.window.showErrorMessage(String(e))}}},"_FileChangeNode");let dp=up;dp.key=":changes";const hp=u(class extends Fo{constructor(t,e,n,r,i){super(t,e);this.canonical=n,this.workspaceRepository=r,this.root=i}static getId(t,e){return`${sc.getId(t)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return hp.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||f.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const t=this.view.providerService.getChangeStore(this.workspaceRepository.uri).getScopedChangeStore(this.workspaceRepository),e=await t.getChanges(this.workspaceRepository.uri);this._children=e.map(n=>new dp(this.view,this,t,this.canonical,this.workspaceRepository,n,this.canApplyChanges()))}return this._children}getTreeItem(){const t=this.workspaceRepository.workspaceId===this.view.workspaceId,e=Hm(this.workspaceRepository),n=Wt.isCanonicalUri(this.workspaceRepository.uri)?vt("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,r=new f.TreeItem(this.root?this.canonical.name:n,e?f.TreeItemCollapsibleState.Collapsed:f.TreeItemCollapsibleState.None);return r.id=this.id,r.contextValue=`${Po.WorkspaceRepository}${t?"+active":""}${this.canApplyChanges()?"+apply":""}`,r.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${_o(this.workspaceRepository.timestamp,{ago:!0})}`,r.iconPath=t?new f.ThemeIcon("check"):this.root?pp(this.canonical.provider.id):Am(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),r.tooltip=new f.MarkdownString(void 0,!0).appendMarkdown(vt("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?vt("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",qw(this.workspaceRepository.ref.type),$s(this.workspaceRepository.ref.type),n,t?` \u2014 _${vt("repositories view repository tooltip active","Active")}_ `:"",_o(this.workspaceRepository.timestamp,{ago:!0}),gu(this.workspaceRepository.changes,{preamble:`${vt("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(r.resourceUri=f.Uri.parse("remotehub-view://wsrepo/changes")),r}refresh(t=!1){t&&(this._children=void 0)}async applyAllChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.providerService.getChangeStore(t.uri).applyChangeset(t.uri,this.workspaceRepository)}catch(e){f.window.showErrorMessage(String(e))}}remove(){return this.view.providerService.workspaceRepositoriesRemoveRepository(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let Pa=hp;Pa.key=":wsrepo",zu([br()],Pa.prototype,"refresh",1);const fp=u(class extends Fo{constructor(t,e,n,r){super(t,e);this.canonical=n,this.workspaceRepositories=r}static getId(t){return`remoteHub${this.key}(${t.toString()})`}get id(){return fp.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const t=this.workspaceRepositories;if(t.length===0)return this.view.message=void 0,[new lp(this.view,this,vt("repositories view message empty","No remote repositories could be found."))];this.view.message=void 0,this.children=t.map(e=>new Pa(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const t=this.workspaceRepositories.some(n=>n.workspaceId===this.view.workspaceId),e=new f.TreeItem(this.canonical.name,t?f.TreeItemCollapsibleState.Expanded:f.TreeItemCollapsibleState.Collapsed);return e.contextValue=Po.WorkspaceRepositories,e.iconPath=pp(this.canonical.provider.id),e}refresh(t=!1){t&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let sc=fp;sc.key=":wsrepos",zu([br()],sc.prototype,"refresh",1);class ju extends Fo{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.providerService.workspaceRepositoriesGetRepositoriesByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const n=[];for(const[r,i]of e){const o=f.Uri.parse(r);try{const{name:a,provider:s}=this.view.providerService.getVirtualUriMetadata(o),c={uri:o,name:a,provider:s,hasActive:i.some(l=>l.workspaceId===this.view.workspaceId)};i.length===1?n.push(new Pa(this.view,this,c,i[0],!0)):n.push(new sc(this.view,this,c,i))}catch(a){if(a instanceof Ht)continue;U.error(a)}}this.children=n}return this.children}getTreeItem(){return new f.TreeItem("Repositories",f.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}u(ju,"WorkspaceRepositoriesViewNode"),zu([br()],ju.prototype,"refresh",1);class gp extends cp{constructor(e,n,r){super("remoteHub.views.workspaceRepositories",vt("remote view title","Remote Repositories"),e,r);this.workspaceId=n,this.configKey="workspaceRepositories",this.disposables.push(this.providerService.onDidChangeWorkspaceRepositories(this.onRepositoriesChanged,this),f.window.registerFileDecorationProvider({provideFileDecoration:(i,o)=>{if(!(i.scheme!=="remotehub-view"||i.authority!=="wsrepo"||!i.path.includes("/changes")))return{badge:"\u25CF",color:new f.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:vt("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new ju(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[f.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.providerService.workspaceRepositoriesRefresh(),void this.refresh(!0)),this),f.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),Mn(this.providerService,{name:e.name,uri:e.uri,location:Ke.CurrentWindow})),this),f.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),Mn(this.providerService,{name:e.name,uri:e.uri,location:Ke.NewWindow})),this),f.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),f.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.remove"),e.remove()),this),f.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),f.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),e.openFile()),this),f.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const n=N(this.providerService.getVirtualCanonicalRootUri(e.uri)),r=this.providerService.repositories.filter(o=>N(o.canonicalUri)===n);return await zw(r,vt("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}u(gp,"WorkspaceRepositoriesView");function qw(t,e){switch(t){case ye.Branch:return e?vt("type pr branch","Pull Request #{0}",e.id):vt("type branch","Branch");case ye.RemoteBranch:return e?vt("type pr remote branch","Pull Request #{0}",e.id):vt("type remote branch","Remote Branch");case ye.Tag:return vt("type tag","Tag");case ye.Commit:return vt("type commit","Commit")}}u(qw,"headTypeToString");function pp(t){switch(t){case"github":return new f.ThemeIcon("github");case"azurerepos":return new f.ThemeIcon("azure-devops");default:return new f.ThemeIcon("vm")}}u(pp,"providerToIconPath");async function zw(t,e){if(t.length!==0){if(t.length>1){const n=await f.window.showQuickPick(t.map(r=>({label:r.name,description:r.provider.name,repository:r})),{placeHolder:e});return n?n.repository:void 0}return t[0]}}u(zw,"getRepository");let cc;function lc(){return cc}u(lc,"getOpenActionsService");var Di;(function(t){t.HasCommitted="has:committed",t.Version="version"})(Di||(Di={}));let uc;function vp(t){return uc.globalState.get(t)}u(vp,"getState");async function Gu(t,e){return uc.globalState.update(t,e)}u(Gu,"updateState");let mp=!1;function jw(){return mp}u(jw,"isPreRelease");async function Gw(t){uc=t,Uo.configure("remoteHub",t),U.configure(t,"Remote Repositories",de.get("logLevel")),Pe.start("Time to root directory",{log:!1});const e=Li.configure(t),n=new ha(t),r=t.extension.packageJSON.version;await Gu(Di.Version,r),await t.workspaceState.update(Di.Version,r);const[,i]=uc.extension.packageJSON.version.split(".");mp=Number.parseInt(i)%2==1;try{const o=new Wt(n);cc=new Pg(o);const a=new rp(o,cc,n),s=new Tg(o);return t.subscriptions.push(de.onDidChange(c=>{!de.changed(c,"logLevel")||(U.logLevel=de.get("logLevel"))}),o.onDidChangeRepositories(async c=>{for(const l of c.added)try{const d=await l.getMetadata(),{HEAD:h,defaultBranch:g,name:p,provider:y,pullRequest:v}=d,m=h.name.replace(/\//g,"\u2009\u2215\u2009");let C=" ";if(v!==void 0)C=` (PR ${v.id}) `;else if(h.type===ye.Tag)C=` (${m}) `;else if(h.type===ye.Commit)C=` (${m}) `;else if(h.type===ye.Branch||h.type===ye.RemoteBranch){const _=h.branch.name.replace(/\//g,"\u2009\u2215\u2009");h.branch.name!==g.name&&(C=` (${_})`)}const w={uri:l.uri,type:"folder",label:`${p}${C}[${y.name}]`};f.commands.executeCommand("_workbench.addToRecentlyOpened",w)}catch(d){U.error(d,"Failed to add repository to recently opened")}}),new np(o),new Ia(o),new ap(o,n),...Rm(o,t.extension.id,n),...Xw(o,n),...await Kw(o,a,t,n),new op(o),new gp(o,e,n),a,cc,o,n),n.sendEvent("activate"),Promise.resolve(s)}catch(o){throw U.error(o),o}}u(Gw,"activate");async function Kw(t,e,n,r){const i=[];if(wp()){const o=new Rg(t,r);t.registerVirtualIndexProvider("github",o),t.registerVirtualIndexProvider("azurerepos",o),i.push(o)}return i.push(Qw(t,e)),i}u(Kw,"registerProviders");function Qw(t,e){async function n(){var i;try{let o=(i=f.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?i:f.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");o||(U.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(h=>{const g=f.extensions.onDidChange(()=>{var p;o=(p=f.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?p:f.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),o&&(g.dispose(),h())})})),U.log("[ GHPR] Registering..."),_n(ar.HasPullRequestExtension,!0);const a=await o.activate();if(!a)throw new Error("Unable to get registration api");const s=a.registerGitProvider(e),c=t.onDidChangeRepositories(h=>l(h));async function l(h){const g=h.added.filter(p=>p.provider.id==="github");if(g.length!==0){U.log("[ GHPR] Checking for opened PRs...");for(const p of g){const y=await t.getBestRemoteUri(p.uri,on.PullRequest);if(!!y){c.dispose(),U.log("[ GHPR] Opened PR found; preloading"),f.commands.executeCommand("github.api.preloadPullRequest",y.toString());return}}U.log("[ GHPR] No opened PRs found")}}u(l,"onRepositoriesChanged"),U.log("[ GHPR] Registration complete");const d=t.repositories;return d.length&&l({added:d,removed:[]}),f.Disposable.from(s,c)}catch(o){return U.error(o,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}u(n,"registerWithGHPR");const r=n();return f.Disposable.from({dispose:async()=>{var i;return void((i=await r)==null?void 0:i.dispose())}})}u(Qw,"registerGitHub");function Xw(t,e){if(!wp())return[];e.publicLog2("codex.enableRichNav",{});const n=new Df(t);return[n,n.register(new Ru(e)),...Ru.createStatus()]}u(Xw,"registerNavigationServiceProviders");function wp(){return f.env.uiKind===f.UIKind.Desktop||de.get("richNavigation.enabled")===!0}u(wp,"isRichNavEnabled");const Ku=new Map,Qu=new Map;async function Qt(t,e){var n,r,i;if(e!==void 0&&typeof e!="string"&&(e=Wt.getProviderId(e)),e&&Qu.has(e)){const o=Qu.get(e);if(!o)return;await Ku.get(o);return}for(const o of f.extensions.all){const a=o.id,{contributes:s}=o.packageJSON;if(!s||!["github.remotehub","ms-vscode.azure-repos"].includes(a.toLowerCase()))continue;const c=Ku.get(a),l=(r=(n=s.virtualWorkspaces)==null?void 0:n.providers)!=null?r:[],d=l.find(g=>g===e)!==void 0,h=l.length&&e===void 0;if(!c&&(h||d)){const g=(i=f.extensions.getExtension(a))==null?void 0:i.activate().then(p=>p.registerVirtualProviderService(t));if(g===void 0)return;Ku.set(a,g);for(const p of l)Qu.set(p,a);if(await g,e!==void 0&&d)return}else c&&await c}}u(Qt,"ensureProvidersRegistered")})(),module.exports=fc})();
